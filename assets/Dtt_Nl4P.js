import{g as M}from"./CNE622Ru.js";import{u as U}from"./C1xlBPRp.js";import{r as c,n as X,g as N,c as f,a as t,t as l,p as R,u as s,o as v}from"./BXs_MeCU.js";const T={id:"diagram",class:"flex flex-col items-center w-screen h-screen"},j={id:"panelcontainer",class:"flex flex-row max-w-[1000px] w-full bg-white"},H={key:0,class:"h-full w-full"},P=["data"],V={key:1,class:"text-gray-500"},G={key:0,class:"mt-6 p-4 bg-white rounded shadow"},O={class:"h-auto w-full overflow-auto"},W=["innerHTML"],I={key:1,class:"text-gray-500"},q={class:"w-full flex flex-row justify-center mt-5"},Y={__name:"diagram",setup(A){const i=U(),S=c(i.fileName),u=c(i.gridData),g=c(i.diagramData),h=c(i.svg),k=c(i.blockCount),y=c(i.towerCount);let p=c(.5),w=c(.5),_=!1,b=0;X(()=>{u.value.length&&L(u.value)}),N(u,e=>{L(e)},{deep:!0});function x(e){u.value=e,i.updateGridData(e)}function B(e){_=!0,b=e.clientX,document.addEventListener("mousemove",D),document.addEventListener("mouseup",C)}function D(e){if(_){const o=e.clientX-b,n=document.getElementById("panelcontainer").offsetWidth,a=p.value+w.value,d=p.value+o/n,r=a-d;d>=.1&&r>=.1&&(p.value=d,w.value=r,b=e.clientX)}}function C(){_=!1,document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",C)}function F(){if(!g.value){alert("No SVG content to download.");return}const e=M(g.value,{},{forceSize:!1}),o=new Blob([e],{type:"image/svg+xml"}),n=document.createElement("a"),a=URL.createObjectURL(o);n.href=a,n.download=`${S.value}.svg`,n.click(),URL.revokeObjectURL(a)}function L(e){let o=0,n=0,a=null,d=null;const r={};e.slice(1).forEach(m=>{var z,$,E;(z=m[0])!=null&&z.trim()&&(a=m[0],r[a]={},o++),($=m[1])!=null&&$.trim()&&(d=m[1],r[a][d]=[],n++),(E=m[2])!=null&&E.trim()&&r[a][d].push(m[2])}),g.value=r,h.value=M(r,{},{forceSize:!0}),k.value=o,y.value=n,i.updateDiagramData(g.value,h.value,o,n)}return(e,o)=>(v(),f("div",T,[t("h2",null,l(e.$t("diagram.yourMentalModelDiagram")),1),t("div",j,[t("div",{style:R({flex:s(p)}),class:"overflow-auto p-4"},[t("h3",null,l(e.$t("common.fileContent")),1),s(u).length?(v(),f("div",H,[t("canvas-datagrid",{data:s(u),editable:!0,onDataChanged:x},null,40,P)])):(v(),f("p",V,l(e.$t("common.noContent")),1))],4),t("div",{id:"resizeHandle",class:"w-2 cursor-col-resize",onMousedown:B},null,32),t("div",{style:R({flex:s(w)}),class:"overflow-auto p-4"},[t("h3",null,l(e.$t("common.svgView")),1),s(h)?(v(),f("div",G,[t("div",O,[t("div",{innerHTML:s(h)},null,8,W)])])):(v(),f("p",I,l(e.$t("common.svgUnavailable")),1))],4)]),t("p",null,"Blocks: "+l(s(k))+", Towers: "+l(s(y)),1),t("div",q,[t("button",{class:"btn-primary",onClick:F},l(e.$t("common.download")),1),t("button",{class:"btn-primary",onClick:o[0]||(o[0]=n=>x(s(u)))},l(e.$t("common.reload")),1)])]))}};export{Y as default};
