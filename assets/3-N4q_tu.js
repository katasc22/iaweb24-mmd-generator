import{g as R}from"./CNE622Ru.js";import{u as F}from"./BVN0t0DJ.js";import{r as d,n as U,g as X,c as f,a as t,t as l,p as S,u as s,o as v}from"./Ca9FcgIc.js";const T={id:"diagram",class:"flex flex-col items-center w-screen h-screen"},j={id:"panelcontainer",class:"flex flex-row max-w-[1000px] w-full bg-white"},H={key:0,class:"h-full w-full"},P=["data"],V={key:1,class:"text-gray-500"},G={key:0,class:"mt-6 p-4 bg-white rounded shadow"},N={class:"h-auto w-full overflow-auto"},O=["innerHTML"],W={key:1,class:"text-gray-500"},I={class:"w-full flex flex-row justify-center mt-5"},Q={__name:"diagram",setup(q){const r=F(),c=d(r.gridData),g=d(r.diagramData),h=d(r.svg),k=d(r.blockCount),y=d(r.towerCount);let p=d(.5),w=d(.5),_=!1,b=0;U(()=>{c.value.length&&L(c.value)}),X(c,e=>{L(e)},{deep:!0});function x(e){c.value=e,r.updateGridData(e)}function $(e){_=!0,b=e.clientX,document.addEventListener("mousemove",D),document.addEventListener("mouseup",C)}function D(e){if(_){const o=e.clientX-b,n=document.getElementById("panelcontainer").offsetWidth,a=p.value+w.value,u=p.value+o/n,i=a-u;u>=.1&&i>=.1&&(p.value=u,w.value=i,b=e.clientX)}}function C(){_=!1,document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",C)}function B(){if(!g.value){alert("No SVG content to download.");return}const e=R(g.value,{},{forceSize:!1}),o=new Blob([e],{type:"image/svg+xml"}),n=document.createElement("a"),a=URL.createObjectURL(o);n.href=a,n.download="mental-model-diagram.svg",n.click(),URL.revokeObjectURL(a)}function L(e){let o=0,n=0,a=null,u=null;const i={};e.slice(1).forEach(m=>{var z,E,M;(z=m[0])!=null&&z.trim()&&(a=m[0],i[a]={},o++),(E=m[1])!=null&&E.trim()&&(u=m[1],i[a][u]=[],n++),(M=m[2])!=null&&M.trim()&&i[a][u].push(m[2])}),g.value=i,h.value=R(i,{},{forceSize:!0}),k.value=o,y.value=n,r.updateDiagramData(g.value,h.value,o,n)}return(e,o)=>(v(),f("div",T,[t("h2",null,l(e.$t("diagram.yourMentalModelDiagram")),1),t("div",j,[t("div",{style:S({flex:s(p)}),class:"overflow-auto p-4"},[t("h3",null,l(e.$t("common.fileContent")),1),s(c).length?(v(),f("div",H,[t("canvas-datagrid",{data:s(c),editable:!0,onDataChanged:x},null,40,P)])):(v(),f("p",V,l(e.$t("common.noContent")),1))],4),t("div",{id:"resizeHandle",class:"w-2 cursor-col-resize",onMousedown:$},null,32),t("div",{style:S({flex:s(w)}),class:"overflow-auto p-4"},[t("h3",null,l(e.$t("common.svgView")),1),s(h)?(v(),f("div",G,[t("div",N,[t("div",{innerHTML:s(h)},null,8,O)])])):(v(),f("p",W,l(e.$t("common.svgUnavailable")),1))],4)]),t("p",null,"Blocks: "+l(s(k))+", Towers: "+l(s(y)),1),t("div",I,[t("button",{class:"btn-primary",onClick:B},l(e.$t("common.download")),1),t("button",{class:"btn-primary",onClick:o[0]||(o[0]=n=>x(s(c)))},l(e.$t("common.reload")),1)])]))}};export{Q as default};
