function _typeof(t){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(t)}function _defineProperty(t,a,l){return a in t?Object.defineProperty(t,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[a]=l,t}function ownKeys(t,a){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),l.push.apply(l,r)}return l}function _objectSpread2(t){for(var a=1;a<arguments.length;a++){var l=arguments[a]!=null?arguments[a]:{};a%2?ownKeys(Object(l),!0).forEach(function(r){_defineProperty(t,r,l[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):ownKeys(Object(l)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(l,r))})}return t}function _newArrowCheck(t,a){if(t!==a)throw new TypeError("Cannot instantiate an arrow function")}function _slicedToArray(t,a){return _arrayWithHoles(t)||_iterableToArrayLimit(t,a)||_unsupportedIterableToArray(t,a)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function _iterableToArrayLimit(t,a){if(typeof Symbol<"u"&&Symbol.iterator in Object(t)){var l=[],r=!0,e=!1,o=void 0;try{for(var n,i=t[Symbol.iterator]();!(r=(n=i.next()).done)&&(l.push(n.value),!a||l.length!==a);r=!0);}catch(s){e=!0,o=s}finally{try{r||i.return==null||i.return()}finally{if(e)throw o}}return l}}function _unsupportedIterableToArray(t,a){if(t){if(typeof t=="string")return _arrayLikeToArray(t,a);var l=Object.prototype.toString.call(t).slice(8,-1);return l==="Object"&&t.constructor&&(l=t.constructor.name),l==="Map"||l==="Set"?Array.from(t):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?_arrayLikeToArray(t,a):void 0}}function _arrayLikeToArray(t,a){(a==null||a>t.length)&&(a=t.length);for(var l=0,r=new Array(a);l<a;l++)r[l]=t[l];return r}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _createForOfIteratorHelper(t,a){var l;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(l=_unsupportedIterableToArray(t))||a){l&&(t=l);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(s){throw s},f:e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,n=!0,i=!1;return{s:function(){l=t[Symbol.iterator]()},n:function(){var s=l.next();return n=s.done,s},e:function(s){i=!0,o=s},f:function(){try{n||l.return==null||l.return()}finally{if(i)throw o}}}}function defaults(t){t.defaults={attributes:[["allowColumnReordering",!0],["allowColumnResize",!0],["allowColumnResizeFromCell",!1],["allowFreezingRows",!1],["allowFreezingColumns",!1],["allowMovingSelection",!0],["allowRowHeaderResize",!0],["allowRowReordering",!1],["allowRowResize",!0],["allowRowResizeFromCell",!1],["allowSorting",!0],["allowGroupingRows",!0],["allowGroupingColumns",!0],["animationDurationShowContextMenu",50],["animationDurationHideContextMenu",50],["autoGenerateSchema",!1],["autoResizeColumns",!1],["autoResizeRows",!1],["autoScrollOnMousemove",!1],["autoScrollMargin",5],["allowShrinkingSelection",!1],["blanksText","(Blanks)"],["borderDragBehavior","none"],["borderResizeZone",10],["clearCellsWhenShrinkingSelection",!1],["clearSettingsOptionText","Clear saved settings"],["columnHeaderClickBehavior","sort"],["columnSelectorHiddenText","&nbsp;&nbsp;&nbsp;"],["columnSelectorText","Add/Remove columns"],["columnSelectorVisibleText","âœ“"],["contextHoverScrollAmount",2],["contextHoverScrollRateMs",5],["copyHeadersOnSelectAll",!0],["copyText","Copy"],["debug",!1],["editable",!0],["ellipsisText","..."],["filterOptionText","Filter %s"],["filterTextPrefix","(filtered) "],["filterFrozenRows",!0],["globalRowResize",!1],["hideColumnText","Hide %s"],["showUnhideColumnsIndicator",!1],["showUnhideRowsIndicator",!1],["showHideRow","Hide row %s"],["showHideRows","Hide rows %s"],["hoverMode","cell"],["keepFocusOnMouseOut",!1],["maxAutoCompleteItems",200],["multiLine",!1],["name",""],["pageUpDownOverlap",1],["pasteText","Paste"],["persistantSelectionMode",!1],["removeFilterOptionText","Remove filter on %s"],["reorderDeadZone",3],["resizeAfterDragged",!1],["resizeScrollZone",20],["rowGrabZoneSize",5],["columnGrabZoneSize",30],["saveAppearance",!0],["scrollAnimationPPSThreshold",.75],["scrollPointerLock",!1],["scrollRepeatRate",75],["selectionFollowsActiveCell",!1],["selectionHandleBehavior","none"],["selectionMode","cell"],["selectionScrollIncrement",20],["selectionScrollZone",20],["showClearSettingsOption",!0],["showColumnHeaders",!0],["showColumnSelector",!0],["showCopy",!1],["showFilter",!0],["showFilterInCell",!1],["showNewRow",!1],["showOrderByOption",!0],["showOrderByOptionTextAsc","Order by %s ascending"],["showOrderByOptionTextDesc","Order by %s descending"],["showGroupColumns","Group columns %s"],["showGroupRows","Group rows %s"],["showRemoveGroupColumns","Remove group %s"],["showRemoveGroupRows","Remove group %s"],["showRemoveAllGroupColumns","Remove all column groups"],["showRemoveAllGroupRows","Remove all row groups"],["showExpandAllGroupColumns","Expand all column groups"],["showExpandAllGroupRows","Expand all row groups"],["showCollapseAllGroupColumns","Collapse all column groups"],["showCollapseAllGroupRows","Collapse all row groups"],["columnGroupIndicatorPosition","right"],["rowGroupIndicatorPosition","bottom"],["showPaste",!1],["showPerformance",!1],["showRowHeaders",!0],["showRowNumbers",!0],["showRowNumberGaps",!0],["singleSelectionMode",!1],["snapToRow",!1],["sortFrozenRows",!0],["touchContextMenuTimeMs",800],["touchDeadZone",3],["touchEasingMethod","easeOutQuad"],["touchReleaseAcceleration",1e3],["touchReleaseAnimationDurationMs",2e3],["touchScrollZone",20],["touchSelectHandleZone",20],["touchZoomSensitivity",.005],["touchZoomMin",.5],["touchZoomMax",1.75],["maxPixelRatio",2],["tree",!1],["treeHorizontalScroll",!1],["rowTree",[]],["rowTreeColIndex",0],["columnTree",[]],["columnTreeRowStartIndex",0],["columnTreeRowEndIndex",0]],styles:[["activeCellBackgroundColor","rgba(255, 255, 255, 1)"],["activeCellBorderColor","rgba(110, 168, 255, 1)"],["activeCellBorderWidth",1],["activeCellColor","rgba(0, 0, 0, 1)"],["activeCellFont","16px sans-serif"],["activeCellHoverBackgroundColor","rgba(255, 255, 255, 1)"],["activeCellHorizontalAlignment","left"],["activeCellHoverColor","rgba(0, 0, 0, 1)"],["activeCellOverlayBorderColor","rgba(66, 133, 244, 1)"],["activeCellOverlayBorderWidth",1],["activeCellPaddingBottom",5],["activeCellPaddingLeft",5],["activeCellPaddingRight",5],["activeCellPaddingTop",5],["activeCellSelectedBackgroundColor","rgba(236, 243, 255, 1)"],["activeCellSelectedColor","rgba(0, 0, 0, 1)"],["activeCellVerticalAlignment","center"],["activeColumnHeaderCellBackgroundColor","rgba(225, 225, 225, 1)"],["activeColumnHeaderCellColor","rgba(0, 0, 0, 1)"],["activeRowHeaderCellBackgroundColor","rgba(225, 225, 225, 1)"],["activeRowHeaderCellColor","rgba(0, 0, 0, 1)"],["autocompleteBottomMargin",60],["autosizeHeaderCellPadding",8],["autosizePadding",5],["buttonActiveBackgroundColor","rgba(255, 255, 255, 1)"],["buttonActiveBorderColor","rgba(110, 168, 255, 1)"],["buttonArrowColor","rgba(50, 50, 50, 1)"],["buttonArrowDownHTML","&#x25BC;"],["buttonZIndex",1e4],["buttonBackgroundColor","rgba(255, 255, 255, 1)"],["buttonBorderColor","rgba(172, 172, 172, 1)"],["buttonHoverBackgroundColor","rgba(240, 240, 240, 1)"],["buttonMenuWindowMargin",30],["buttonPadding","3px"],["cellAutoResizePadding",13],["cellBackgroundColor","rgba(255, 255, 255, 1)"],["cellBorderColor","rgba(195, 199, 202, 1)"],["cellBorderWidth",1],["cellColor","rgba(0, 0, 0, 1)"],["cellFont","16px sans-serif"],["cellGridHeight",250],["cellHeight",24],["cellHeightWithChildGrid",150],["cellHorizontalAlignment","left"],["cellHoverBackgroundColor","rgba(255, 255, 255, 1)"],["cellHoverColor","rgba(0, 0, 0, 1)"],["cellPaddingBottom",5],["cellPaddingLeft",5],["cellPaddingRight",5],["cellPaddingTop",5],["cellSelectedBackgroundColor","rgba(236, 243, 255, 1)"],["cellSelectedColor","rgba(0, 0, 0, 1)"],["cellTreeIconBorderColor","rgba(162, 174, 207, 1)"],["cellTreeIconFillColor","rgba(240, 240, 240, 1)"],["cellTreeIconHoverFillColor","rgba(198, 217, 233, 1)"],["cellTreeIconLineColor","rgba(43, 53, 81, 1)"],["cellTreeIconLineWidth",1.5],["cellTreeIconMarginLeft",0],["cellTreeIconMarginRight",5],["cellTreeIconMarginTop",6],["cellTreeIconWidth",13],["cellVerticalAlignment","center"],["cellWidth",250],["cellWidthWithChildGrid",250],["cellWhiteSpace","nowrap"],["cellLineHeight",1],["cellLineSpacing",3],["childContextMenuArrowColor","rgba(43, 48, 43, 1)"],["childContextMenuArrowHTML","&#x25BA;"],["childContextMenuMarginLeft",-11],["childContextMenuMarginTop",-6],["columnGroupRowHeight",25],["columnHeaderCellBackgroundColor","rgba(240, 240, 240, 1)"],["columnHeaderCellBorderColor","rgba(172, 172, 172, 1)"],["columnHeaderCellBorderWidth",1],["columnHeaderCellCapBackgroundColor","rgba(240, 240, 240, 1)"],["columnHeaderCellCapBorderColor","rgba(172, 172, 172, 1)"],["columnHeaderCellCapBorderWidth",1],["columnHeaderCellColor","rgba(50, 50, 50, 1)"],["columnHeaderCellFont","16px sans-serif"],["columnHeaderCellHeight",25],["columnHeaderCellHorizontalAlignment","left"],["columnHeaderCellHoverBackgroundColor","rgba(235, 235, 235, 1)"],["columnHeaderCellHoverColor","rgba(0, 0, 0, 1)"],["columnHeaderCellPaddingBottom",5],["columnHeaderCellPaddingLeft",5],["columnHeaderCellPaddingRight",5],["columnHeaderCellPaddingTop",5],["columnHeaderCellVerticalAlignment","center"],["columnHeaderOrderByArrowBorderColor","rgba(195, 199, 202, 1)"],["columnHeaderOrderByArrowBorderWidth",1],["columnHeaderOrderByArrowColor","rgba(155, 155, 155, 1)"],["columnHeaderOrderByArrowHeight",8],["columnHeaderOrderByArrowMarginLeft",0],["columnHeaderOrderByArrowMarginRight",5],["columnHeaderOrderByArrowMarginTop",6],["columnHeaderOrderByArrowWidth",13],["contextFilterButtonBorder","solid 1px rgba(158, 163, 169, 1)"],["contextFilterButtonBorderRadius","3px"],["contextFilterButtonHTML","&#x25BC;"],["contextFilterInputBackground","rgba(255,255,255,1)"],["contextFilterInputBorder","solid 1px rgba(158, 163, 169, 1)"],["contextFilterInputBorderRadius","0"],["contextFilterInputColor","rgba(0,0,0,1)"],["contextFilterInputFontFamily","sans-serif"],["contextFilterInputFontSize","14px"],["contextFilterInvalidRegExpBackground","rgba(180, 6, 1, 1)"],["contextFilterInvalidRegExpColor","rgba(255, 255, 255, 1)"],["contextMenuArrowColor","rgba(43, 48, 43, 1)"],["contextMenuArrowDownHTML","&#x25BC;"],["contextMenuArrowUpHTML","&#x25B2;"],["contextMenuBackground","rgba(240, 240, 240, 1)"],["contextMenuBorder","solid 1px rgba(158, 163, 169, 1)"],["contextMenuBorderRadius","3px"],["contextMenuChildArrowFontSize","12px"],["contextMenuColor","rgba(43, 48, 43, 1)"],["contextMenuCursor","default"],["contextMenuFilterButtonFontFamily","sans-serif"],["contextMenuFilterButtonFontSize","10px"],["contextMenuFilterInvalidExpresion","rgba(237, 155, 156, 1)"],["contextMenuFontFamily","sans-serif"],["contextMenuFontSize","16px"],["contextMenuHoverBackground","rgba(182, 205, 250, 1)"],["contextMenuHoverColor","rgba(43, 48, 153, 1)"],["contextMenuItemBorderRadius","3px"],["contextMenuItemMargin","2px"],["contextMenuLabelDisplay","inline-block"],["contextMenuLabelMargin","0 3px 0 0"],["contextMenuLabelMaxWidth","700px"],["contextMenuLabelMinWidth","75px"],["contextMenuMarginLeft",3],["contextMenuMarginTop",-3],["contextMenuOpacity","0.98"],["contextMenuPadding","2px"],["contextMenuWindowMargin",30],["contextMenuZIndex",1e4],["cornerCellBackgroundColor","rgba(240, 240, 240, 1)"],["cornerCellBorderColor","rgba(202, 202, 202, 1)"],["debugBackgroundColor","rgba(0, 0, 0, .0)"],["debugColor","rgba(255, 15, 24, 1)"],["debugEntitiesColor","rgba(76, 231, 239, 1.00)"],["debugFont","11px sans-serif"],["debugPerfChartBackground","rgba(29, 25, 26, 1.00)"],["debugPerfChartTextColor","rgba(255, 255, 255, 0.8)"],["debugPerformanceColor","rgba(252, 255, 37, 1.00)"],["debugScrollHeightColor","rgba(248, 33, 103, 1.00)"],["debugScrollWidthColor","rgba(66, 255, 27, 1.00)"],["debugTouchPPSXColor","rgba(246, 102, 24, 1.00)"],["debugTouchPPSYColor","rgba(186, 0, 255, 1.00)"],["display","inline-block"],["editCellBackgroundColor","white"],["editCellBorder","solid 1px rgba(110, 168, 255, 1)"],["editCellBoxShadow","0 2px 5px rgba(0,0,0,0.4)"],["editCellColor","black"],["editCellFontFamily","sans-serif"],["editCellFontSize","16px"],["editCellPaddingLeft",4],["editCellZIndex",1e4],["filterButtonActiveBackgroundColor","rgba(225, 225, 225, 1)"],["filterButtonArrowBorderColor","rgba(195, 199, 202, 1)"],["filterButtonArrowBorderWidth",1],["filterButtonArrowClickRadius",5],["filterButtonArrowColor","rgba(50, 50, 50, 1)"],["filterButtonArrowHeight",5],["filterButtonArrowWidth",8],["filterButtonBackgroundColor","rgba(240, 240, 240, 1)"],["filterButtonBorderColor","rgba(172, 172, 172, 1)"],["filterButtonBorderRadius",3],["filterButtonHeight",20],["filterButtonHoverBackgroundColor","rgba(235, 235, 235, 1)"],["filterButtonMenuOffsetTop",10],["filterButtonWidth",20],["frozenMarkerHoverColor","rgba(165, 198, 254, 1)"],["frozenMarkerHoverBorderColor","rgba(165, 198, 254, 1)"],["frozenMarkerActiveColor","rgba(165, 198, 254, 0.2)"],["frozenMarkerActiveBorderColor","rgba(165, 198, 254, 0.5)"],["frozenMarkerActiveHeaderColor","rgba(165, 198, 254, 1)"],["frozenMarkerColor","rgba(221, 221, 221, 1)"],["frozenMarkerBorderColor","rgba(221, 221, 221, 1)"],["frozenMarkerBorderWidth",1],["frozenMarkerHeaderColor","rgba(188, 188, 188, 1)"],["frozenMarkerWidth",4],["groupingAreaBackgroundColor","rgba(240, 240, 240, 1)"],["gridBackgroundColor","rgba(240, 240, 240, 1)"],["gridBorderCollapse","collapse"],["gridBorderColor","rgba(202, 202, 202, 1)"],["gridBorderWidth",1],["groupIndicatorColor","rgba(155, 155, 155, 1)"],["groupIndicatorBackgroundColor","rgba(255, 255, 255, 1)"],["height","auto"],["maxHeight","inherit"],["maxWidth","inherit"],["minColumnWidth",45],["minHeight","inherit"],["minRowHeight",24],["minWidth","inherit"],["mobileContextMenuMargin",10],["mobileEditInputHeight",30],["mobileEditFontFamily","sans-serif"],["mobileEditFontSize","16px"],["moveOverlayBorderWidth",1],["moveOverlayBorderColor","rgba(66, 133, 244, 1)"],["moveOverlayBorderSegments","12, 7"],["name","default"],["overflowY","auto"],["overflowX","auto"],["reorderMarkerBackgroundColor","rgba(0, 0, 0, 0.1)"],["reorderMarkerBorderColor","rgba(0, 0, 0, 0.2)"],["reorderMarkerBorderWidth",1.25],["reorderMarkerIndexBorderColor","rgba(66, 133, 244, 1)"],["reorderMarkerIndexBorderWidth",2.75],["resizeMarkerColor","rgba(0, 0, 0, 0.2)"],["resizeMarkerSize",2],["rowGroupColumnWidth",25],["rowHeaderCellBackgroundColor","rgba(240, 240, 240, 1)"],["rowHeaderCellBorderColor","rgba(200, 200, 200, 1)"],["rowHeaderCellBorderWidth",1],["rowHeaderCellColor","rgba(50, 50, 50, 1)"],["rowHeaderCellFont","16px sans-serif"],["rowHeaderCellHeight",25],["rowHeaderCellHorizontalAlignment","left"],["rowHeaderCellHoverBackgroundColor","rgba(235, 235, 235, 1)"],["rowHeaderCellHoverColor","rgba(0, 0, 0, 1)"],["rowHeaderCellPaddingBottom",5],["rowHeaderCellPaddingLeft",5],["rowHeaderCellPaddingRight",5],["rowHeaderCellPaddingTop",5],["rowHeaderCellRowNumberGapHeight",5],["rowHeaderCellRowNumberGapColor","rgba(50, 50, 50, 1)"],["rowHeaderCellSelectedBackgroundColor","rgba(217, 217, 217, 1)"],["rowHeaderCellSelectedColor","rgba(50, 50, 50, 1)"],["rowHeaderCellVerticalAlignment","center"],["rowHeaderCellWidth",57],["scrollBarActiveColor","rgba(125, 125, 125, 1)"],["scrollBarBackgroundColor","rgba(240, 240, 240, 1)"],["scrollBarBorderColor","rgba(202, 202, 202, 1)"],["scrollBarBorderWidth",.5],["scrollBarBoxBorderRadius",4.125],["scrollBarBoxColor","rgba(192, 192, 192, 1)"],["scrollBarBoxMargin",2],["scrollBarBoxMinSize",15],["scrollBarBoxWidth",8],["scrollBarCornerBackgroundColor","rgba(240, 240, 240, 1)"],["scrollBarCornerBorderColor","rgba(202, 202, 202, 1)"],["scrollBarWidth",11],["selectionHandleBorderColor","rgba(255, 255, 255, 1)"],["selectionHandleBorderWidth",1.5],["selectionHandleColor","rgba(66, 133, 244, 1)"],["selectionHandleSize",8],["selectionHandleType","square"],["fillOverlayBorderColor","rgba(127, 127, 127, 1)"],["fillOverlayBorderWidth",2],["selectionOverlayBorderColor","rgba(66, 133, 244, 1)"],["selectionOverlayBorderWidth",1],["treeArrowBorderColor","rgba(195, 199, 202, 1)"],["treeArrowBorderWidth",1],["treeArrowClickRadius",5],["treeArrowColor","rgba(155, 155, 155, 1)"],["treeArrowHeight",8],["treeArrowMarginLeft",0],["treeArrowMarginRight",5],["treeArrowMarginTop",6],["treeArrowWidth",13],["treeGridHeight",250],["unhideIndicatorColor","rgba(0, 0, 0, 1)"],["unhideIndicatorBackgroundColor","rgba(255, 255, 255, 1)"],["unhideIndicatorBorderColor","rgba(174, 193, 232, 1)"],["unhideIndicatorSize",16],["width","auto"]]}}function component(){var t,a={};return a.dehyphenateProperty=function(l){l=l.replace("--cdg-","");var r,e="";return Array.prototype.forEach.call(l,function(o){if(r)return r=!1,void(e+=o.toUpperCase());o!=="-"?e+=o:r=!0}),e},a.hyphenateProperty=function(l,r){var e="";return Array.prototype.forEach.call(l,function(o){o!==o.toUpperCase()?e+=o:e+="-"+o.toLowerCase()}),(r?"--cdg-":"")+e},a.applyComponentStyle=function(l,r){if(r.isComponent){var e=window.getComputedStyle(r.tagName==="CANVAS-DATAGRID"?r:r.canvas,null),o={};r.computedStyle=e,defaults(o),o.defaults.styles.forEach(function(n){var i;(i=e.getPropertyValue(a.hyphenateProperty(n[0],!0)))===""&&(i=e.getPropertyValue(a.hyphenateProperty(n[0],!1))),i!==""&&typeof i=="string"&&r.setStyleProperty(n[0],t[_typeof(n[1])](i.replace(/^\s+/,"").replace(/\s+$/,""),n[1]),!0)}),!l&&r.dispatchEvent&&(requestAnimationFrame(function(){r.resize(!0)}),r.dispatchEvent("stylechanged",r.style))}},t={data:function(l){try{return JSON.parse(l)}catch{throw new Error("Cannot read JSON data in canvas-datagrid data.")}},schema:function(l){try{return JSON.parse(l)}catch{throw new Error("Cannot read JSON data in canvas-datagrid schema attribute.")}},number:function(l,r){var e=parseInt(l,10);return isNaN(e)?r:e},boolean:function(l){return/true/i.test(l)},string:function(l){return l}},a.getObservableAttributes=function(){var l={},r=["data","schema","style","className","name"];return defaults(l),l.defaults.attributes.forEach(function(e){r.push(e[0].toLowerCase())}),r},a.disconnectedCallback=function(){this.connected=!1},a.connectedCallback=function(){var l=this;l.parentDOMNode.innerHTML="",l.parentDOMNode.appendChild(l.canvas),l.connected=!0,a.observe(l),a.applyComponentStyle(!0,l),l.resize(!0)},a.adoptedCallback=function(){this.resize()},a.attributeChangedCallback=function(l,r,e){var o,n,i=this;if(l!=="style"){if(l==="data")return i.dataType==="application/x-canvas-datagrid"&&(i.dataType="application/json+x-canvas-datagrid"),void(i.data=e);if(l!=="schema")if(l!=="name"){if(l!=="class"&&l!=="className"){var s,d,c;if(s="attributes",d=l,defaults(c={}),n=c.defaults[s].filter(function(p){return p[0].toLowerCase()===d.toLowerCase()||a.hyphenateProperty(p[0])===d.toLowerCase()||a.hyphenateProperty(p[0],!0)===d.toLowerCase()})[0],n)return o=t[_typeof(n[1])],void(i.attributes[n[0]]=o(e));/^on/.test(l)&&i.addEventListener("on"+l,Function("e",e))}}else i.name=e;else i.schema=t.schema(e)}else a.applyComponentStyle(!1,i)},a.observe=function(l){var r;window.MutationObserver&&(l.applyComponentStyle=function(){a.applyComponentStyle(!1,l),l.resize()},(r=new window.MutationObserver(function(e){var o,n;Array.prototype.forEach.call(e,function(i){i.attributeName!=="class"&&i.attributeName!=="style"&&i.target.nodeName!=="STYLE"?i.target.parentNode&&i.target.parentNode.nodeName==="STYLE"?n=!0:i.target===l&&(i.addedNodes.length>0||i.type==="characterData")&&(o=!0):n=!0}),n&&l.applyComponentStyle(!1,l),o&&(l.dataType==="application/x-canvas-datagrid"&&(l.dataType="application/json+x-canvas-datagrid"),l.data=l.innerHTML)})).observe(l,{characterData:!0,childList:!0,attributes:!0,subtree:!0}),Array.prototype.forEach.call(document.querySelectorAll("style"),function(e){r.observe(e,{characterData:!0,childList:!0,attributes:!0,subtree:!0})}))},a}var _this=void 0,SelectionType={UnselectedCells:0,Cells:1,Rows:2,Columns:3},swapProps=(function(t,a,l){_newArrowCheck(this,_this);var r=t[a];t[a]=t[l],t[l]=r}).bind(void 0),normalizeSelection=(function(t){if(_newArrowCheck(this,_this),!t)return t;switch(t.type){case SelectionType.UnselectedCells:case SelectionType.Cells:typeof t.endRow!="number"?t.endRow=t.startRow:t.endRow<t.startRow&&swapProps(t,"startRow","endRow"),typeof t.endColumn!="number"?t.endColumn=t.startColumn:t.endColumn<t.startColumn&&swapProps(t,"startColumn","endColumn");break;case SelectionType.Rows:typeof t.endRow!="number"?t.endRow=t.startRow:t.endRow<t.startRow&&swapProps(t,"startRow","endRow");break;case SelectionType.Columns:typeof t.endColumn!="number"?t.endColumn=t.startColumn:t.endColumn<t.startColumn&&swapProps(t,"startColumn","endColumn")}return t}).bind(void 0);(function(t){var a=this;if(_newArrowCheck(this,_this),typeof t=="string"){var l=t.indexOf(":");if(!(l<0)){var r=t.slice(0,l),e=t.slice(l+1).split(/[,:;-]+/).map((function(o){return _newArrowCheck(this,a),parseInt(o,10)}).bind(this));switch(r){case"cell":case"cells":case"-cell":case"-cells":return normalizeSelection({type:SelectionType[r[0]==="-"?"UnselectedCells":"Cells"],startRow:e[0],startColumn:e[1],endRow:e[2],endColumn:e[3]});case"row":case"rows":return normalizeSelection({type:SelectionType.Rows,startRow:e[0],endRow:e[1]});case"col":case"cols":return normalizeSelection({type:SelectionType.Columns,startColumn:e[0],endColumn:e[1]})}}}}).bind(void 0);var isSameCellsBlock=(function(t,a){return _newArrowCheck(this,_this),t.startRow===a.startRow&&t.endRow===a.endRow&&t.startColumn===a.startColumn&&t.endColumn===a.endColumn}).bind(void 0),mergeCellsIntoRowsOrColumns=(function(t,a){return _newArrowCheck(this,_this),a.type===SelectionType.Rows?t.startRow>=a.startRow&&t.endRow<=a.endRow?a:void 0:t.startColumn>=a.startColumn&&t.endColumn<=a.endColumn?a:void 0}).bind(void 0),mergeSelections=(function(t,a){if(_newArrowCheck(this,_this),t.type!==a.type)return a.type<=SelectionType.Cells&&t.type>SelectionType.Cells?mergeCellsIntoRowsOrColumns(a,t):t.type<=SelectionType.Cells&&a.type>SelectionType.Cells?mergeCellsIntoRowsOrColumns(t,a):void 0;var l=t.type===SelectionType.Columns||t.startRow===a.startRow&&t.endRow===a.endRow,r=t.type===SelectionType.Rows||t.startColumn===a.startColumn&&t.endColumn===a.endColumn;if(l)return r?t:a.startColumn>t.endColumn+1||a.endColumn<t.startColumn-1?void 0:Object.assign({},t,{startColumn:Math.min(t.startColumn,a.startColumn),endColumn:Math.max(t.endColumn,a.endColumn)});if(r)return a.startRow>t.endRow+1||a.endRow<t.startRow-1?void 0:Object.assign({},t,{startRow:Math.min(t.startRow,a.startRow),endRow:Math.max(t.endRow,a.endRow)});if(t.type===SelectionType.Cells||t.type===SelectionType.UnselectedCells){var e=_getIntersection(t,a);if(e){if(isSameCellsBlock(e,t))return a;if(isSameCellsBlock(e,a))return t}}}).bind(void 0),removePartOfRowsSelection=(function(t,a){if(_newArrowCheck(this,_this),!(a.endRow<t.startRow||a.startRow>t.endRow))return a.startRow<=t.startRow?a.endRow>=t.endRow?[]:[Object.assign({},t,{startRow:a.endRow+1})]:a.endRow>=t.endRow?[Object.assign({},t,{endRow:a.startRow-1})]:[Object.assign({},t,{endRow:a.startRow-1}),Object.assign({},t,{startRow:a.endRow+1})]}).bind(void 0),removePartOfColumnsSelection=(function(t,a){if(_newArrowCheck(this,_this),!(a.endColumn<t.startColumn||a.startColumn>t.endColumn))return a.startColumn<=t.startColumn?a.endColumn>=t.endColumn?[]:[Object.assign({},t,{startColumn:a.endColumn+1})]:a.endColumn>=t.endColumn?[Object.assign({},t,{endColumn:a.startColumn-1})]:[Object.assign({},t,{endColumn:a.startColumn-1}),Object.assign({},t,{startColumn:a.endColumn+1})]}).bind(void 0),removePartOfCellsSelection=(function(t,a){_newArrowCheck(this,_this);var l=_getIntersection(t,a);if(l){if(isSameCellsBlock(t,l))return[];var r=[],e=t.startRow,o=t.endRow,n=t.endColumn;return l.startRow>t.startRow&&(r.push(Object.assign({},t,{endRow:l.startRow-1})),e=l.startRow),l.endColumn<t.endColumn&&(r.push(Object.assign({},t,{startRow:e,startColumn:l.endColumn+1})),n=l.endColumn),l.endRow<t.endRow&&(r.push(Object.assign({},t,{endColumn:n,startRow:l.endRow+1})),o=l.endRow),l.startColumn>t.startColumn&&r.push(Object.assign({},t,{startRow:e,endRow:o,endColumn:l.startColumn-1})),r}}).bind(void 0),_getIntersection=(function(t,a){if(_newArrowCheck(this,_this),t.type>a.type)return _getIntersection(a,t);if(t.type<=SelectionType.Cells){if(a.type<=SelectionType.Cells){var l=Math.max(t.startColumn,a.startColumn),r=Math.min(t.endColumn,a.endColumn);if(l>r)return;var e=Math.max(t.startRow,a.startRow),o=Math.min(t.endRow,a.endRow);return e>o?void 0:{type:SelectionType.Cells,startRow:e,startColumn:l,endRow:o,endColumn:r}}if(a.type===SelectionType.Rows){var n=Math.max(t.startRow,a.startRow),i=Math.min(t.endRow,a.endRow);return n>i?void 0:{type:SelectionType.Cells,startRow:n,startColumn:t.startColumn,endRow:i,endColumn:t.endColumn}}var s=Math.max(t.startColumn,a.startColumn),d=Math.min(t.endColumn,a.endColumn);return s>d?void 0:{type:SelectionType.Cells,startColumn:s,startRow:t.startRow,endColumn:d,endRow:t.endRow}}if(t.type===SelectionType.Rows){if(a.type===SelectionType.Rows){var c=Math.max(t.startRow,a.startRow),p=Math.min(t.endRow,a.endRow);return c>p?void 0:{type:SelectionType.Rows,startRow:c,endRow:p}}return{type:SelectionType.Cells,startRow:t.startRow,startColumn:a.startColumn,endRow:t.endRow,endColumn:a.endColumn}}var h=Math.max(t.startColumn,a.startColumn),m=Math.min(t.endColumn,a.endColumn);return h>m?void 0:{type:SelectionType.Columns,startColumn:h,endColumn:m}}).bind(void 0),_addIntoSelections=(function(t,a,l){if(_newArrowCheck(this,_this),!a||typeof a.type!="number")return!1;if(a.type===SelectionType.Cells){for(var r=0;r<t.length;r++){var e=t[r];if(e.type!==SelectionType.UnselectedCells){if(e.type===SelectionType.Cells){var o=removePartOfCellsSelection(a,e);if(Array.isArray(o)){for(var n=!1,i=0;i<o.length;i++)_addIntoSelections(t,o[i],l)&&(n=!0);return n&&cleanupSelections(t),n}}}else{var s=removePartOfCellsSelection(e,a);s&&(t.splice.apply(t,[r,1].concat(_toConsumableArray(s))),r+=s.length-1)}}if(l){var d,c,p=a.startRow===0&&a.endRow+1>=l.rows,h=a.startColumn===0&&a.endColumn+1>=l.columns;if(p&&(d=_addIntoSelections(t,{type:SelectionType.Columns,startColumn:a.startColumn,endColumn:a.endColumn},l)),h&&(c=_addIntoSelections(t,{type:SelectionType.Rows,startRow:a.startRow,endRow:a.endRow},l)),p||h)return d||c}return t.push(a),cleanupSelections(t),!0}var m=a.type===SelectionType.Rows;if(m||a.type===SelectionType.Columns){for(var u=0;u<t.length;u++){var g=t[u];if(g.type!==SelectionType.UnselectedCells){if(g.type===a.type){var w=mergeSelections(g,a);if(w){for(var R=u+1;R<t.length;R++)if(t[R].type===a.type){var T=mergeSelections(t[R],w);T&&(t.splice(R,1),R--,w=T)}return t[u]=w,cleanupSelections(t),!0}}}else{var I=removePartOfCellsSelection(g,m?{startRow:a.startRow,endRow:a.endRow,startColumn:0,endColumn:g.endColumn}:{startColumn:a.startColumn,endColumn:a.endColumn,startRow:0,endRow:g.endRow});I&&(t.splice.apply(t,[u,1].concat(_toConsumableArray(I))),u+=I.length-1)}}return t.push(a),cleanupSelections(t),!0}return!1}).bind(void 0),_removeFromSelections=(function(t,a,l){if(_newArrowCheck(this,_this),!a||typeof a.type!="number")return!1;if(a.type===SelectionType.Cells){for(var r=0;r<t.length;r++){var e=t[r];if(e.type===SelectionType.UnselectedCells){var o=removePartOfCellsSelection(a,e);if(Array.isArray(o)){for(var n=!1,i=0;i<o.length;i++)_removeFromSelections(t,o[i],l)&&(n=!0);return n&&cleanupSelections(t),n}}if(e.type===SelectionType.Cells){var s=removePartOfCellsSelection(e,a);s&&(t.splice.apply(t,[r,1].concat(_toConsumableArray(s))),r+=s.length-1)}}if(l){var d,c,p=a.startRow===0&&a.endRow+1>=l.rows,h=a.startColumn===0&&a.endColumn+1>=l.columns;if(p&&(d=_removeFromSelections(t,{type:SelectionType.Columns,startColumn:a.startColumn,endColumn:a.endColumn},l)),h&&(c=_removeFromSelections(t,{type:SelectionType.Rows,startRow:a.startRow,endRow:a.endRow},l)),p||h)return d||c}return a.type=SelectionType.UnselectedCells,t.unshift(a),cleanupSelections(t),!0}var m=a.type===SelectionType.Rows;if(m||a.type===SelectionType.Columns){for(var u=!1,g=0;g<t.length;g++){var w=t[g];if(w.type!==SelectionType.Cells)if(w.type!==SelectionType.UnselectedCells)if(w.type===a.type){var R=m?removePartOfRowsSelection(w,a):removePartOfColumnsSelection(w,a);if(!R)continue;u=!0,t.splice.apply(t,[g,1].concat(_toConsumableArray(R))),g+=R.length-1}else{u=!0;var T=void 0;T=w.type===SelectionType.Rows?{type:SelectionType.UnselectedCells,startColumn:a.startColumn,endColumn:a.endColumn,startRow:w.startRow,endRow:w.endRow}:{type:SelectionType.UnselectedCells,startRow:a.startRow,endRow:a.endRow,startColumn:w.startColumn,endColumn:w.endColumn},t.unshift(T)}else m?w.startRow>=a.startRow&&w.endRow<=a.endRow&&(t.splice(g,1),g--):w.startColumn>=a.startColumn&&w.endColumn<=a.endColumn&&(t.splice(g,1),g--);else{var I=removePartOfCellsSelection(w,m?{startRow:a.startRow,endRow:a.endRow,startColumn:0,endColumn:w.endColumn}:{startColumn:a.startColumn,endColumn:a.endColumn,startRow:0,endRow:w.endRow});I&&(t.splice.apply(t,[g,1].concat(_toConsumableArray(I))),g+=I.length-1)}}return u&&cleanupSelections(t),u}return!1}).bind(void 0),cleanupSelections=(function(t){var a=this;_newArrowCheck(this,_this);for(var l=[],r=[],e=0;e<t.length;e++){var o=t[e];o.type===SelectionType.UnselectedCells?l.push(o):r.push(o)}l=l.filter((function(g){_newArrowCheck(this,a);for(var w=0;w<r.length;w++)if(_getIntersection(g,r[w]))return!0;return!1}).bind(this));for(var n=!1;!n;){n=!0;for(var i=0;i<r.length;i++){for(var s=r[i],d=i+1;d<r.length;d++){var c=r[d],p=mergeSelections(s,c);if(p){r[i]=p,r.splice(d,1),n=!1;break}}if(!n)break}}for(var h=0,m=0;m<l.length;m++)t[h++]=l[m];for(var u=0;u<r.length;u++)t[h++]=r[u];t.splice(h,t.length-h)}).bind(void 0),isRowSelected=(function(t,a){_newArrowCheck(this,_this);for(var l=0;l<t.length;l++){var r=t[l];switch(r.type){case SelectionType.UnselectedCells:if(a>=r.startRow&&a<=r.endRow)return!1;break;case SelectionType.Rows:if(a>=r.startRow&&a<=r.endRow)return!0}}return!1}).bind(void 0),isColumnSelected=(function(t,a){_newArrowCheck(this,_this);for(var l=0;l<t.length;l++){var r=t[l];switch(r.type){case SelectionType.UnselectedCells:if(a>=r.startColumn&&a<=r.endColumn)return!1;break;case SelectionType.Columns:if(a>=r.startColumn&&a<=r.endColumn)return!0}}return!1}).bind(void 0),isCellSelected=(function(t,a,l){_newArrowCheck(this,_this);for(var r=0;r<t.length;r++){var e=t[r];switch(e.type){case SelectionType.UnselectedCells:case SelectionType.Cells:if(l>=e.startColumn&&l<=e.endColumn&&a>=e.startRow&&a<=e.endRow)return e.type===SelectionType.Cells;break;case SelectionType.Rows:if(a>=e.startRow&&a<=e.endRow)return!0;break;case SelectionType.Columns:if(l>=e.startColumn&&l<=e.endColumn)return!0}}return!1}).bind(void 0),areAllCellsSelected=(function(t,a){_newArrowCheck(this,_this);for(var l=a.startRow,r=a.startColumn,e=a.endRow,o=a.endColumn,n=0,i=t.length;n<i;n++){var s=t[n];if(s)switch(s.type){case SelectionType.UnselectedCells:case SelectionType.Cells:var d=r>=s.startColumn&&l>=s.startRow,c=o<=s.endColumn&&e<=s.endRow;if(d||c){if(d&&c)return s.type===SelectionType.Cells;if(d&&r<=s.endColumn&&l<=s.endRow||c&&o>=s.startColumn&&e>=s.startRow)return!1}break;case SelectionType.Rows:if(l>=s.startRow){if(e<=s.endRow)return!0;if(l<=s.endRow)return!1}else if(e>=s.startRow)return!1;break;case SelectionType.Columns:if(r>=s.startColumn){if(o<=s.endColumn)return!0;if(r<=s.endColumn)return!1}else if(o>=s.startColumn)return!1}}return!1}).bind(void 0),getSelectionStateFromCells=(function(t,a){var l=this;if(_newArrowCheck(this,_this),!Array.isArray(t)||t.length===0||(t=t.filter((function(u){return _newArrowCheck(this,l),(typeof u.startRow!="number"||!(u.endRow<a.startRow||u.startRow>a.endRow))&&(typeof u.startColumn!="number"||!(u.endColumn<a.startColumn||u.startColumn>a.endColumn))&&u}).bind(this)),t.length===0))return!1;if(areAllCellsSelected(t,a))return!0;for(var r=a.endColumn-a.startColumn+1,e=new Array(a.endRow-a.startRow+1).fill(null).map((function(){return _newArrowCheck(this,l),new Array(r)}).bind(this)),o=Object.assign({type:SelectionType.Cells},a),n=t.length-1;n>=0;n--){var i=t[n],s=_getIntersection(o,i);if(s)for(var d=i.type!==SelectionType.UnselectedCells,c=s.startRow;c<=s.endRow;c++)for(var p=e[c-a.startRow],h=s.startColumn-a.startColumn,m=s.endColumn-a.startColumn;h<=m;h++)p[h]=d}return e}).bind(void 0);(function(t,a){var l=this;if(_newArrowCheck(this,_this),!Array.isArray(t)||t.length===0)return[];if(t=t.map((function(u){return _newArrowCheck(this,l),typeof u.startRow=="number"&&(u.endRow<a.startRow||u.startRow>a.endRow)||typeof u.startColumn=="number"&&(u.endColumn<a.startColumn||u.startColumn>a.endColumn)?null:u}).bind(this)),t.length===0)return[];for(var r=a.endColumn-a.startColumn+1,e=new Array(a.endRow-a.startRow+1).fill(null).map((function(){return _newArrowCheck(this,l),new Array(r)}).bind(this)),o=Object.assign({type:SelectionType.Cells},a),n=t.length-1;n>=0;n--){var i=t[n];if(i){var s=_getIntersection(o,i);if(s)for(var d=i.type!==SelectionType.UnselectedCells,c=s.startRow;c<=s.endRow;c++)for(var p=e[c-a.startRow],h=s.startColumn-a.startColumn,m=s.endColumn-a.startColumn;h<=m;h++)p[h]=d?n+1:0}}return e}).bind(void 0);var getSelectedContiguousColumns=(function(t,a){if(_newArrowCheck(this,_this),t&&t.length!==0){for(var l,r=t.length-1;r>=0;r--){var e=t[r];switch(e.type){case SelectionType.Columns:if(l){var o=mergeSelections(l,e);if(o){l=o;break}}l=e;break;case SelectionType.Rows:case SelectionType.Cells:if(!a)return;break;case SelectionType.UnselectedCells:if(!l||_getIntersection(e,l))return}}return l?[l.startColumn,l.endColumn]:void 0}}).bind(void 0),getSelectedContiguousRows=(function(t,a){if(_newArrowCheck(this,_this),t&&t.length!==0){for(var l,r=t.length-1;r>=0;r--){var e=t[r];switch(e.type){case SelectionType.Rows:if(l){var o=mergeSelections(l,e);if(o){l=o;break}}l=e;break;case SelectionType.Columns:case SelectionType.Cells:if(!a)return;break;case SelectionType.UnselectedCells:if(!l||_getIntersection(e,l))return}}return l?[l.startRow,l.endRow]:void 0}}).bind(void 0),areSelectionsComplex=(function(t){var a=this;if(_newArrowCheck(this,_this),!t||t.length<=1)return!1;var l=t[0].type;return l===SelectionType.UnselectedCells||t.findIndex((function(r){return _newArrowCheck(this,a),r.type!==l}).bind(this))>=0}).bind(void 0),areSelectionsNeat=(function(t){if(_newArrowCheck(this,_this),!t)return!1;if(t.length===1)return!0;var a=t[0],l=a.type;if(l===SelectionType.UnselectedCells)return!0;for(var r=0;r<t.length;r++){var e=t[r];if(l!==e.type)return!1;if(l===SelectionType.Cells){if(e.startColumn===a.startColumn&&e.endColumn===a.endColumn||e.startRow===a.startRow&&e.endRow===a.endRow)continue;return!1}}return!0}).bind(void 0),moveSelections=(function(t,a,l){_newArrowCheck(this,_this);for(var r=0;r<t.length;r++){var e=t[r];switch(e.type){case SelectionType.Cells:case SelectionType.UnselectedCells:e.startRow+=l,e.endRow+=l,e.startColumn+=a,e.endColumn+=a;break;case SelectionType.Rows:e.startRow+=l,e.endRow+=l;break;case SelectionType.Columns:e.startColumn+=a,e.endColumn+=a}}}).bind(void 0),cloneSelections=(function(t){_newArrowCheck(this,_this);for(var a=[],l=0;l<t.length;l++){var r=t[l];r&&a.push(Object.assign({},r))}return a}).bind(void 0),getSelectionBounds=(function(t){_newArrowCheck(this,_this);for(var a=1/0,l=-1/0,r=1/0,e=-1/0,o=0;o<t.length;o++){var n=t[o];n.type!==SelectionType.UnselectedCells&&(typeof n.startColumn!="number"?r=0:n.startColumn<r&&(r=n.startColumn),typeof n.endColumn!="number"?e=1/0:n.endColumn>e&&(e=n.endColumn),typeof n.startRow!="number"?a=0:n.startRow<a&&(a=n.startRow),typeof n.endRow!="number"?l=1/0:n.endRow>l&&(l=n.endRow))}return{top:a,left:r,bottom:l,right:e}}).bind(void 0),shrinkOrExpandSelections=(function(t,a,l,r){var e=this;_newArrowCheck(this,_this);var o=a.rowIndex,n=a.columnIndex;if(o<0||n<0)return!1;var i={ArrowLeft:{x:1,y:0,isLeft:!0},ArrowUp:{x:0,y:1,isUp:!0},ArrowRight:{x:-1,y:0,isRight:!0},ArrowDown:{x:0,y:-1,isDown:!0}}[l.key];if(!i)return!1;for(var s=o+i.y,d=n+i.x,c=[],p=0;p<t.length;p++){var h=t[p];switch(h.type){case SelectionType.Cells:case SelectionType.UnselectedCells:if(!(s!==h.startRow&&s!==h.endRow||d!==h.startColumn&&d!==h.endColumn)){if(h.type===SelectionType.UnselectedCells)return!1;c.push(h)}break;case SelectionType.Rows:s!==h.startRow&&s!==h.endRow||c.push(h);break;case SelectionType.Columns:d!==h.startColumn&&d!==h.endColumn||c.push(h)}}if(c.length!==1)return!1;var m=c[0],u=m.startRow===s,g=m.endRow===s,w=m.startColumn===d,R=m.endColumn===d,T=r?r.rows-1:1/0,I=r?r.columns-1:1/0,F=(function(){return _newArrowCheck(this,e),cleanupSelections(t),!0}).bind(this);if(u){if(i.isUp)return m.startRow!==0&&(m.startRow--,F());if(i.isDown&&m.startRow<m.endRow)return m.startRow++,F()}if(g){if(i.isDown)return!(m.endRow>=T)&&(m.endRow++,F());if(i.isUp&&m.startRow<m.endRow)return m.endRow--,F()}if(w){if(i.isLeft)return m.startColumn!==0&&(m.startColumn--,F());if(i.isRight&&m.startColumn<m.endColumn)return m.startColumn++,F()}if(R){if(i.isRight)return!(m.endColumn>=I)&&(m.endColumn++,F());if(i.isLeft&&m.startColumn<m.endColumn)return m.endColumn--,F()}return!1}).bind(void 0);function draw(t){var a=[],l=!1,r=0,e=300,o=[],n=[],i=[];function s(f,b,x,P){x=x||1;var A,O=[];for(A=f;A<=b;A+=x)O[A]=P===void 0?A:typeof P=="function"?P(A):P;return O}function d(f){var b,x=f.innerHTML||f.formattedValue,P=x.toString()+f.rowIndex.toString()+f.columnIndex.toString(),A=Math.round(f.x+t.canvasOffsetLeft),O=Math.round(f.y+t.canvasOffsetTop);if(t.htmlImageCache[P]){if(b=t.htmlImageCache[P].img,t.htmlImageCache[P].height===f.height&&t.htmlImageCache[P].width===f.width)return b.complete?t.ctx.drawImage(b,A,O):void 0;t.htmlImageCache[P]=void 0}else l=!1;b=new Image(f.width,f.height),t.htmlImageCache[P]={img:b,width:f.width,height:f.height},b.onload=function(){var B;t.ctx.drawImage(b,A,O),B=!0,Object.keys(t.htmlImageCache).forEach(function(j){t.htmlImageCache[j].img.complete||(B=!1)}),B&&!l&&(l=!0,t.draw())},b.src="data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="'+f.width+'" height="'+f.height+`">
<foreignObject class="node" x="0" y="0" width="100%" height="100%">
<body xmlns="http://www.w3.org/1999/xhtml" style="margin:0;padding:0;">
`+x+`
</body></foreignObject>
</svg>
`)}function c(f,b){if(!(f.length<4)){t.ctx.beginPath(),t.ctx.moveTo(f[0]+t.canvasOffsetLeft,f[1]+t.canvasOffsetTop);for(var x=2;x<f.length;x+=2){var P=f[x]+t.canvasOffsetLeft,A=f[x+1]+t.canvasOffsetTop;t.ctx.lineTo(P,A)}b?t.ctx.fill():t.ctx.stroke()}}function p(f,b,x,P){g(f,b,x,x),w(f,b,x,x);var A=f+.5*x,O=b+.5*x;c([f+.2*x,O,f+.78*x,O]),P&&c([A,b+.22*x,A,b+.8*x])}function h(f,b,x,P,A){var O,B,j,V,J=.2*x,Z=.3*x,W=x-2*J,k=x-2*Z,lt=.5*W;switch(P){case"r":V=[f,b,f+x,b,f+x,b+x,f,b+x],j=[O=f+Z,B=b+J,O,B+W,O+k,B+lt];break;case"l":V=[f+x,b,f,b,f,b+x,f+x,b+x],j=[O=f+x-Z,B=b+J,O,B+W,O-k,B+lt];break;case"t":V=[f,b+x,f,b,f+x,b,f+x,b+x],j=[O=f+J,B=b+x-Z,O+W,B,O+lt,B-k];break;case"b":V=[f,b,f,b+x,f+x,b+x,f+x,b],j=[O=f+J,B=b+Z,O+W,B,O+lt,B+k]}if(A){t.ctx.strokeStyle=t.style.unhideIndicatorBorderColor,t.ctx.lineWidth=2,c(V),t.ctx.fillStyle=t.style.unhideIndicatorBackgroundColor;var rt=P==="r"||P==="b"?1:0;P==="l"||P==="r"?g(f-rt,b,x+rt,x):g(f,b-rt,x,x+rt)}t.ctx.fillStyle=t.style.unhideIndicatorColor,c(j,!0)}function m(f,b,x){var P=x?b.parentCount:0,A=t.style.cellTreeIconWidth*t.scale,O=t.style.cellTreeIconMarginTop*t.scale,B=t.style.cellTreeIconMarginRight*t.scale,j=t.style.cellTreeIconMarginLeft*t.scale+P*(A+f.paddingLeft),V=f.x+f.paddingLeft+t.canvasOffsetLeft+j,J=f.y+t.canvasOffsetTop+O;if(b.icon){t.ctx.beginPath();var Z=t.ctx.fillStyle,W=t.ctx.strokeStyle;f.hovered&&t.hovers.onCellTreeIcon?t.ctx.fillStyle=t.style.cellTreeIconHoverFillColor:t.ctx.fillStyle=t.style.cellTreeIconFillColor,t.ctx.fillRect(V,J,A,A),t.ctx.strokeStyle=t.style.cellTreeIconBorderColor,t.ctx.rect(V,J,A,A),t.ctx.stroke(),t.ctx.beginPath(),b.expand?(t.ctx.moveTo(V+3,J+.5*A),t.ctx.lineTo(V+A-3,J+.5*A)):(t.ctx.moveTo(V+2,J+.5*A),t.ctx.lineTo(V+A-2,J+.5*A),t.ctx.moveTo(V+.5*A,J+2),t.ctx.lineTo(V+.5*A,J+A-2)),t.ctx.lineWidth=t.style.cellTreeIconLineWidth,t.ctx.strokeStyle=t.style.cellTreeIconLineColor,t.ctx.stroke(),t.ctx.strokeStyle=W,t.ctx.fillStyle=Z}return j+A+B}function u(f,b,x,P,A){var O=(f+=t.canvasOffsetLeft)+x,B=(b+=t.canvasOffsetTop)+P;t.ctx.beginPath(),t.ctx.moveTo(f+A,b),t.ctx.lineTo(O-A,b),t.ctx.quadraticCurveTo(O,b,O,b+A),t.ctx.lineTo(O,b+P-A),t.ctx.quadraticCurveTo(O,B,O-A,B),t.ctx.lineTo(f+A,B),t.ctx.quadraticCurveTo(f,B,f,B-A),t.ctx.lineTo(f,b+A),t.ctx.quadraticCurveTo(f,b,f+A,b)}function g(f,b,x,P){f+=t.canvasOffsetLeft,b+=t.canvasOffsetTop,t.ctx.fillRect(f,b,x,P)}function w(f,b,x,P){f+=t.canvasOffsetLeft,b+=t.canvasOffsetTop,t.ctx.strokeRect(f,b,x,P)}function R(f,b,x){b+=t.canvasOffsetLeft,x+=t.canvasOffsetTop,t.ctx.fillText(f,b,x)}function T(f){t.ctx.beginPath(),f===0&&(t.ctx.moveTo(t.lastFrozenColumnPixel,t.lastFrozenRowPixel),t.ctx.lineTo(t.lastFrozenColumnPixel,t.height),t.ctx.lineTo(t.width,t.height),t.ctx.lineTo(t.width,t.lastFrozenRowPixel)),f===1&&(t.ctx.moveTo(0,t.lastFrozenRowPixel),t.ctx.lineTo(0,t.height),t.ctx.lineTo(t.width,t.height),t.ctx.lineTo(t.width,t.lastFrozenRowPixel)),f===2&&(t.ctx.moveTo(t.lastFrozenColumnPixel,0),t.ctx.lineTo(t.width,0),t.ctx.lineTo(t.width,t.height),t.ctx.lineTo(t.lastFrozenColumnPixel,t.height)),t.ctx.clip()}function I(f,b,x){if(t.style.selectionHandleType==="circle")return function(P,A,O){P+=t.canvasOffsetLeft,A+=t.canvasOffsetTop,t.ctx.beginPath(),t.ctx.arc(P,A,O,0,2*Math.PI),t.ctx.fill()}(f,b,.5*x);g(f-.5*x,b-.5*x,x,x)}function F(f,b,x){if(t.style.selectionHandleType==="circle")return function(P,A,O){P+=t.canvasOffsetLeft,A+=t.canvasOffsetTop,t.ctx.beginPath(),t.ctx.arc(P,A,O,0,2*Math.PI),t.ctx.stroke()}(f,b,.5*x);w(f-.5*x,b-.5*x,x,x)}function D(f,b){t.ctx.beginPath(),{t:function(){t.ctx.moveTo(f.x+t.canvasOffsetLeft,f.y+t.canvasOffsetTop),t.ctx.lineTo(f.x+t.canvasOffsetLeft+f.width,f.y+t.canvasOffsetTop)},r:function(){t.ctx.moveTo(f.x+t.canvasOffsetLeft+f.width,f.y+t.canvasOffsetTop),t.ctx.lineTo(f.x+t.canvasOffsetLeft+f.width,f.y+t.canvasOffsetTop+f.height)},b:function(){t.ctx.moveTo(f.x+t.canvasOffsetLeft,f.y+t.canvasOffsetTop+f.height),t.ctx.lineTo(f.x+t.canvasOffsetLeft+f.width,f.y+t.canvasOffsetTop+f.height)},l:function(){t.ctx.moveTo(f.x+t.canvasOffsetLeft,f.y+t.canvasOffsetTop),t.ctx.lineTo(f.x+t.canvasOffsetLeft,f.y+t.canvasOffsetTop+f.height)}}[b](),t.ctx.stroke()}function L(){for(var f=this,b=0,x=t.getSchema(),P=0,A=Math.min(t.frozenColumn,x.length),O=t.getCollapsedColumnGroups();P<A;)x[P].hidden||O.findIndex((function(B){return _newArrowCheck(this,f),P>=B.from&&P<=B.to}).bind(this))>=0||(b+=t.getColumnWidth(P)),P+=1;return b}t.htmlImageCache={},t.draw=function(f){var b=this;if(!t.dispatchEvent("beforedraw",{})&&(t.isChildGrid||t.height&&t.width)){if(t.isChildGrid&&f)requestAnimationFrame(t.parentGrid.draw);else if(t.intf.visible!==!1){var x,P,A,O,B,j,V,J,Z,W,k,lt,rt,at,ut,wt,ht,Ot,X,vt,K,Bt=t.viewData||[],ce=t.style.gridBorderCollapse==="collapse",Ht=[],Ft=[],de=[],ye=[],ue=Bt.length,Be=t.currentCell||{},ee=t.getColumnHeaderCellHeight(),kt=t.getRowHeaderCellWidth(),xe=t.getRowGroupAreaWidth(),Dt=t.getColumnGroupAreaHeight(),Wt={},Gt={},qt={},Ce=t.getCollapsedColumnGroups(),ae=t.getCollapsedRowGroups(),Et=t.style.cellHeight,pe=0,Xt=t.hiddenRowRanges.map((function(y){return _newArrowCheck(this,b),{from:y[0],plus:y[1]-y[0]+1}}).bind(this)).sort((function(y,S){return _newArrowCheck(this,b),y.from-S.from}).bind(this));r+=1,P=performance.now(),t.visibleRowHeights=[],Bt.length>t.orders.rows.length&&t.createRowOrders(),t.ctx.save(),function(){t.visibleRows=[],at=t.getSchema(),t.visibleCells=[],t.visibleGroups=[],t.visibleUnhideIndicators=[],t.canvasOffsetTop=t.isChildGrid?t.parentNode.offsetTop:.5,t.canvasOffsetLeft=t.isChildGrid?t.parentNode.offsetLeft:-.5,lt=t.height,rt=t.width;var y=Xt[0];y&&y.from===0&&(pe=y.plus,Xt.shift())}(),u(0,0,rt,lt,0),t.ctx.clip(),t.ctx.fillStyle=t.style.gridBackgroundColor,g(0,0,rt,lt),t.ctx.translate(xe,Dt),function(){var y=Math.min(Bt.length,t.frozenRow);for(W=-t.scrollBox.scrollLeft+t.scrollPixelLeft+t.style.cellBorderWidth,Z=ee,ut=0;ut<y&&Te(t.orders.rows[ut],ut);ut+=1);t.attributes.allowFreezingRows&&(Z>ee&&(Z+=t.style.frozenMarkerWidth),Z+=t.style.frozenMarkerBorderWidth-.4999999999),t.lastFrozenRowPixel=Z}(),function(){t.ctx.save(),t.frozenRow>0&&(u(0,t.lastFrozenRowPixel,t.width,t.height-t.lastFrozenRowPixel,0),t.ctx.clip());var y,S,G,ot=at.length;for(W=-t.scrollBox.scrollLeft+t.scrollPixelLeft+t.style.cellBorderWidth,t.attributes.snapToRow||(Z+=-t.scrollBox.scrollTop+t.scrollPixelTop+t.style.cellBorderWidth),ut=t.frozenRow+t.scrollIndexTop;ut<ue&&(S=t.orders.rows[ut],t.scrollIndexBottom=ut,t.scrollPixelBottom=Z,t.cellTree.rows.length>0&&Object.keys(t.cellTree.rows[S]).length>0&&t.cellTree.rows[S].hide||Te(S,ut));ut+=1);if(t.attributes.showNewRow){for(t.attributes.showRowHeaders&&(W+=kt),V=Et=t.style.cellHeight,j=!1,y=t.scrollIndexLeft;y<ot&&(we(y)||(G=t.orders.columns[y],W+=re(t.newRow,Bt.length,Bt.length)(at[G],G,y)),!(W>t.width+t.scrollBox.scrollLeft));y+=1);ye.push([t.newRow,Bt.length,Bt.length,Z,V])}t.ctx.restore()}(),function(){if(ht){t.ctx.save();var y=t.activeCell.columnIndex+1>t.frozenColumn||t.activeCell.rowIndex+1>t.frozenRow;u(y?t.lastFrozenColumnPixel:0,y?t.lastFrozenRowPixel:0,y?t.width-t.lastFrozenColumnPixel:t.width,y?t.height-t.lastFrozenRowPixel:t.height,0),t.ctx.clip(),t.attributes.selectionMode==="row"?t.activeCell&&t.activeCell.rowIndex===ht.rowIndex&&(t.ctx.lineWidth=t.style.activeCellOverlayBorderWidth,t.ctx.strokeStyle=t.style.activeCellOverlayBorderColor,w(1,ht.y,t.getHeaderWidth()+kt,t.visibleRowHeights[ht.rowIndex])):(t.ctx.lineWidth=t.style.activeCellOverlayBorderWidth,t.ctx.strokeStyle=t.style.activeCellOverlayBorderColor,w(ht.x,ht.y,ht.width,ht.height)),t.ctx.restore()}}(),function(){var y,S,G,ot,z,_,E=at.length;function M(N,v){for(v=Math.min(v,E),G=N;G<v&&(S=t.orders.columns[G],(z=at[S]).hidden||we(G)||(y={title:z.title,name:z.name,width:z.width||t.style.cellWidth,style:"columnHeaderCell",type:"string",index:G,order:S},ot={columnHeaderCell:z.title||z.name},!((W+=re(ot,-1,-1)(y,S,G))>t.width+t.scrollBox.scrollLeft)));G+=1);}ye.forEach(function(N,v){Z=N[3],Et=N[4],v===t.frozenRow&&(t.ctx.save(),u(0,t.lastFrozenRowPixel,t.width,t.height-t.lastFrozenRowPixel,0),t.ctx.clip()),function(Y,H,nt){if(t.attributes.showRowHeaders){var Ct;W=0,Ct=t.viewData&&H<t.viewData.length?t.getBoundRowIndexFromViewRowIndex(H)+1:t.originalData?t.originalData.length+1:nt+1;var st=t.hasActiveFilters()||t.hasCollapsedRowGroup()?Ct:H+1,ft={rowHeaderCell:st+=pe},tt={name:"rowHeaderCell",width:t.sizes.columns[-1]||t.style.rowHeaderCellWidth,style:"rowHeaderCell",type:"string",data:st,index:-1};if(j=t.openChildren[H],re(ft,nt,H)(tt,-1,-1),Xt[0]&&st>=Xt[0].from){var it=Xt.shift().plus;pe+=it}}}(N[0],N[1],N[2])}),t.ctx.restore(),t.attributes.showColumnHeaders&&(W=-t.scrollBox.scrollLeft+t.scrollPixelLeft+t.style.columnHeaderCellBorderWidth,t.attributes.showRowHeaders&&(W+=kt),Z=0,Et=t.getColumnHeaderCellHeight(),M(t.scrollIndexLeft,E),_=W,W=t.style.columnHeaderCellBorderWidth,t.attributes.showRowHeaders&&(W+=kt),M(0,t.frozenColumn),(W=_)<rt&&(k={name:"",width:t.style.scrollBarWidth,style:"columnHeaderCellCap",isColumnHeaderCell:!0,isColumnHeaderCellCap:!0,type:"string",index:at.length},re({endCap:""},-1,-1)(k,-1,-1)),t.attributes.showRowHeaders&&(J={cornerCell:""},W=0,k={name:"cornerCell",width:t.style.rowHeaderCellWidth,style:"cornerCell",type:"string",index:-1},re(J,-1,-1)(k,-1,-1)))}(),function(){var y=t.lastFrozenRowPixel-t.style.frozenMarkerWidth,S=t.lastFrozenColumnPixel-t.style.frozenMarkerWidth,G=t.currentCell&&t.currentCell.style==="frozen-row-marker",ot=t.currentCell&&t.currentCell.style==="frozen-column-marker",z=t.getRowHeaderCellWidth();if(t.ctx.lineWidth=t.style.frozenMarkerBorderWidth,t.attributes.allowFreezingColumns&&((!t.freezeMarkerPosition||t.freezeMarkerPosition&&t.dragMode==="frozen-row-marker")&&(S>t.style.rowHeaderCellWidth&&(t.ctx.fillStyle=t.style.frozenMarkerColor,t.ctx.strokeStyle=t.style.frozenMarkerBorderColor,g(S,0,t.style.frozenMarkerWidth,t.height),w(S,0,t.style.frozenMarkerWidth,t.height)),t.ctx.fillStyle=ot?t.style.frozenMarkerHoverColor:t.style.frozenMarkerHeaderColor,t.ctx.strokeStyle=ot?t.style.frozenMarkerHoverBorderColor:t.style.frozenMarkerHeaderColor,g(S,0,t.style.frozenMarkerWidth,t.style.columnHeaderCellHeight),w(S,0,t.style.frozenMarkerWidth,t.style.columnHeaderCellHeight)),(!t.dragStartObject||t.dragStartObject&&t.dragStartObject.style!=="rowHeaderCell")&&t.visibleCells.unshift({x:S,y:0,height:t.height,width:t.style.frozenMarkerWidth,style:"frozen-column-marker"})),t.attributes.allowFreezingRows){(!t.freezeMarkerPosition||t.freezeMarkerPosition&&t.dragMode==="frozen-column-marker")&&(y>z&&(t.ctx.fillStyle=t.style.frozenMarkerColor,t.ctx.strokeStyle=t.style.frozenMarkerBorderColor,g(0,y,t.width,t.style.frozenMarkerWidth),w(0,y,t.width,t.style.frozenMarkerWidth)),t.ctx.fillStyle=G?t.style.frozenMarkerHoverColor:t.style.frozenMarkerHeaderColor,t.ctx.strokeStyle=G?t.style.frozenMarkerHoverBorderColor:t.style.frozenMarkerHeaderColor,g(0,y,z,t.style.frozenMarkerWidth),w(0,y,z,t.style.frozenMarkerWidth));var _=t.style.frozenMarkerWidth+t.style.frozenMarkerBorderWidth;(!t.dragStartObject||t.dragStartObject&&t.dragStartObject.style!=="columnHeaderCell")&&t.visibleCells.unshift({x:0,y,height:_,width:t.width,style:"frozen-row-marker"}),Gt={y,h:_}}if(t.freezeMarkerPosition)if(t.ctx.fillStyle=t.style.frozenMarkerActiveColor,t.ctx.strokeStyle=t.style.frozenMarkerActiveBorderColor,t.dragMode==="frozen-column-marker"){var E=t.freezeMarkerPosition.x,M=t.getCellAt(E,0);if(t.freezeMarkerPosition.isGrab&&(E=S),E>z){var N=M.x-t.style.frozenMarkerWidth-t.style.frozenMarkerBorderWidth;E>N+M.width/2&&(N+=M.width),t.ctx.fillStyle=t.style.frozenMarkerColor,t.ctx.strokeStyle=t.style.frozenMarkerBorderColor,g(N,0,t.style.frozenMarkerWidth,t.height),w(N,0,t.style.frozenMarkerWidth,t.height),t.ctx.fillStyle=t.style.frozenMarkerHeaderColor,t.ctx.strokeStyle=t.style.frozenMarkerHeaderColor,g(N,0,t.style.frozenMarkerWidth,t.style.columnHeaderCellHeight),w(N,0,t.style.frozenMarkerWidth,t.style.columnHeaderCellHeight)}t.ctx.fillStyle=t.style.frozenMarkerActiveHeaderColor,t.ctx.strokeStyle=t.style.frozenMarkerActiveBorderColor,g(E,0,t.style.frozenMarkerWidth,t.style.columnHeaderCellHeight),w(E,0,t.style.frozenMarkerWidth,t.style.columnHeaderCellHeight),t.ctx.fillStyle=t.style.frozenMarkerActiveColor,g(E,0,t.style.frozenMarkerWidth,t.height),w(E,0,t.style.frozenMarkerWidth,t.height)}else{var v=t.freezeMarkerPosition.y,Y=t.getCellAt(0,v);if(t.freezeMarkerPosition.isGrab&&(v=y),v>t.style.columnHeaderCellHeight){var H=Y.y-t.style.frozenMarkerWidth-t.style.frozenMarkerBorderWidth;v>H+Y.height/2&&(H+=Y.height),t.ctx.fillStyle=t.style.frozenMarkerColor,t.ctx.strokeStyle=t.style.frozenMarkerBorderColor,g(0,H,t.width,t.style.frozenMarkerWidth),w(0,H,t.width,t.style.frozenMarkerWidth),t.ctx.fillStyle=t.style.frozenMarkerHeaderColor,t.ctx.strokeStyle=t.style.frozenMarkerHeaderColor,g(0,H,z,t.style.frozenMarkerWidth),w(0,H,z,t.style.frozenMarkerWidth)}t.ctx.fillStyle=t.style.frozenMarkerActiveHeaderColor,t.ctx.strokeStyle=t.style.frozenMarkerActiveBorderColor,g(0,v,z,t.style.frozenMarkerWidth),w(0,v,z,t.style.frozenMarkerWidth),t.ctx.fillStyle=t.style.frozenMarkerActiveColor,g(0,v,t.width,t.style.frozenMarkerWidth),w(0,v,t.width,t.style.frozenMarkerWidth)}}(),(t.mobile||t.attributes.allowMovingSelection)&&t.attributes.editable&&(t.ctx.lineWidth=t.style.selectionHandleBorderWidth,t.ctx.strokeStyle=t.style.selectionHandleBorderColor,t.ctx.fillStyle=t.style.selectionHandleColor,de.forEach(function(y){(function(z,_){var E=t.style.selectionHandleSize;({tr:function(){I(z.x+z.width,z.y,E),F(z.x+z.width,z.y,E)},br:function(){I(z.x+z.width,z.y+z.height,E),F(z.x+z.width,z.y+z.height,E)},tl:function(){I(z.x,z.y,E),F(z.x,z.y,E)},bl:function(){I(z.x,z.y+z.height,E),F(z.x,z.y+z.height,E)}})[_]()})(y[0],y[1]);var S=t.attributes.touchSelectHandleZone/2,G=y[0].x+(y[1]==="tl"||y[1]==="bl"?0:y[0].width)-S,ot=y[0].y+(y[1]==="bl"||y[1]==="br"?y[0].height:0)-S;t.visibleCells.unshift({x:G,y:ot,height:t.style.selectionHandleSize+S,width:t.style.selectionHandleSize+S,style:"selection-handle-"+y[1]})})),function(){if(t.reorderObject){var y={height:t.reorderObject.height,width:t.reorderObject.width,x:t.reorderObject.x+t.reorderObject.dragOffset.x,y:t.reorderObject.y+t.reorderObject.dragOffset.y},S={width:rt,height:lt,x:0,y:0};t.ctx.fillStyle=t.style.reorderMarkerBackgroundColor,t.ctx.lineWidth=t.style.reorderMarkerBorderWidth,t.ctx.strokeStyle=t.style.reorderMarkerBorderColor,t.dragMode==="row-reorder"?(y.height=t.getSelectedRowsHeight(),y.width=rt,y.x=0,S.width=rt,S.height=t.currentCell.height,S.y=t.currentCell.y,g(y.x,y.y,y.width,y.height),w(y.x,y.y,y.width,y.height),t.ctx.lineWidth=t.style.reorderMarkerIndexBorderWidth,t.ctx.strokeStyle=t.style.reorderMarkerIndexBorderColor,!t.isRowSelected(t.reorderTarget.sortRowIndex)&&t.currentCell.rowIndex!==t.reorderObject.rowIndex&&t.currentCell.rowIndex>-1&&t.currentCell.rowIndex<ue&&D(S,t.reorderTarget.sortRowIndex>t.reorderObject.sortRowIndex?"b":"t")):t.dragMode==="column-reorder"&&t.reorderObject&&(y.width=t.getSelectedColumnsWidth(),y.height=lt,y.y=0,S.height=lt,S.width=t.currentCell.width,S.y=0,S.x=t.currentCell.x,g(y.x,y.y,y.width,y.height),w(y.x,y.y,y.width,y.height),t.ctx.lineWidth=t.style.reorderMarkerIndexBorderWidth,t.ctx.strokeStyle=t.style.reorderMarkerIndexBorderColor,!t.isColumnSelected(t.reorderTarget.sortColumnIndex)&&t.currentCell.sortColumnIndex!==t.reorderObject.sortColumnIndex&&t.reorderTarget.columnIndex!==t.reorderObject.columnIndex&&t.currentCell.sortColumnIndex>-1&&t.currentCell.sortColumnIndex<at.length&&D(S,t.reorderTarget.columnIndex>t.reorderObject.columnIndex?"r":"l"))}}(),t.movingSelection&&(t.ctx.lineWidth=t.style.moveOverlayBorderWidth,t.ctx.strokeStyle=t.style.moveOverlayBorderColor,t.ctx.setLineDash(t.style.moveOverlayBorderSegments),Ft.forEach(function(y){D(y[0],y[1])}),t.ctx.setLineDash([])),function(){if(t.attributes.resizeAfterDragged&&t.draggingItem&&t.pendingDragResize&&(t.dragMode=="ew-resize"||t.dragMode=="ns-resize")){var y=t.dragMode=="ns-resize",S=y?t.style.resizeMarkerSize:t.height,G=y?t.width:t.style.resizeMarkerSize,ot=t.dragStart.x-(t.resizingStartingWidth-t.style.minColumnWidth),z=t.dragStart.y-(t.resizingStartingHeight-t.style.minRowHeight),_=y?0:Math.max(t.pendingDragResize.x,ot),E=y?Math.max(t.pendingDragResize.y,z):0;t.ctx.fillStyle=t.style.resizeMarkerColor,g(_,E,G,S)}}(),t.ctx.lineWidth=t.style.gridBorderWidth,t.ctx.strokeStyle=t.style.gridBorderColor,w(0,0,t.width,t.height),function(){function y(S){t.fillOverlay.handle||(t.ctx.lineWidth=t.style.selectionOverlayBorderWidth,t.ctx.strokeStyle=t.style.selectionOverlayBorderColor,D(S[0],S[1]))}Ht.filter(function(S){return S[0].rowIndex<t.frozenRow&&S[0].columnIndex<t.frozenColumn}).forEach(y),t.ctx.save(),T(0),Ht.filter(function(S){return S[0].rowIndex>=t.frozenRow&&S[0].columnIndex>=t.frozenColumn}).forEach(y),t.ctx.restore(),t.ctx.save(),T(1),Ht.filter(function(S){return S[0].rowIndex>=t.frozenRow&&S[0].columnIndex<t.frozenColumn}).forEach(y),t.ctx.restore(),t.ctx.save(),T(2),Ht.filter(function(S){return S[0].rowIndex<t.frozenRow&&S[0].columnIndex>=t.frozenColumn}).forEach(y),t.ctx.restore(),function(){if(!(!t.fillOverlay.handle||!t.fillOverlay.snapTo)){t.ctx.save();var S=t.fillOverlay,G=S.handle,ot=S.snapTo.x,z=S.snapTo.y,_=S.snap,E=S.direction==="x"?_?_.x+(S.x<ot?0:_.width):S.x:G.x,M=S.direction===void 0||S.direction==="y"?_?_.y+(S.y<z?0:_.height):S.y:G.y,N=Math.max(Math.min(ot,E),S.minX),v=Math.max(Math.min(z,M),S.minY),Y=Math.max(ot,E)-N,H=Math.max(z,M)-v;t.ctx.strokeStyle=t.style.fillOverlayBorderColor,t.ctx.lineWidth=t.style.fillOverlayBorderWidth,t.ctx.setLineDash([3,3]),w(N,v,Y,H),t.ctx.setLineDash([]),t.ctx.restore()}}()}(),X=t.scrollBox.entities,vt=2*t.style.scrollBarBoxMargin,t.ctx.strokeStyle=t.style.scrollBarBorderColor,t.ctx.lineWidth=t.style.scrollBarBorderWidth,t.frozenColumn>0?X.horizontalBox.x=kt+t.style.scrollBarBoxMargin+t.scrollCache.x[t.frozenColumn-1]+(X.horizontalBar.width-t.scrollCache.x[t.frozenColumn-1]-t.scrollBox.scrollBoxWidth)*(t.scrollBox.scrollLeft/t.scrollBox.scrollWidth):X.horizontalBox.x=kt+t.style.scrollBarBoxMargin+(X.horizontalBar.width-t.scrollBox.scrollBoxWidth)*(t.scrollBox.scrollLeft/t.scrollBox.scrollWidth),X.verticalBox.y=ee+t.style.scrollBarBoxMargin+t.scrollCache.y[t.frozenRow]+(X.verticalBar.height-t.scrollBox.scrollBoxHeight-t.scrollCache.y[t.frozenRow])*(t.scrollBox.scrollTop/t.scrollBox.scrollHeight),t.scrollBox.horizontalBarVisible&&(t.ctx.fillStyle=t.style.scrollBarBackgroundColor,g(X.horizontalBar.x,X.horizontalBar.y,X.horizontalBar.width+vt,X.horizontalBar.height),w(X.horizontalBar.x,X.horizontalBar.y,X.horizontalBar.width+vt,X.horizontalBar.height),t.ctx.fillStyle=t.style.scrollBarBoxColor,t.scrollBox.horizontalBoxVisible&&(/horizontal/.test(Be.context)&&(t.ctx.fillStyle=t.style.scrollBarActiveColor),u(X.horizontalBox.x,X.horizontalBox.y,X.horizontalBox.width,X.horizontalBox.height,t.style.scrollBarBoxBorderRadius),t.ctx.stroke(),t.ctx.fill()),Ot=!0,t.visibleCells.unshift(X.horizontalBar),t.visibleCells.unshift(X.horizontalBox)),t.scrollBox.verticalBarVisible&&(t.ctx.fillStyle=t.style.scrollBarBackgroundColor,g(X.verticalBar.x,X.verticalBar.y,X.verticalBar.width,X.verticalBar.height+vt),w(X.verticalBar.x,X.verticalBar.y,X.verticalBar.width,X.verticalBar.height+vt),t.scrollBox.verticalBoxVisible&&(t.ctx.fillStyle=t.style.scrollBarBoxColor,/vertical/.test(Be.context)&&(t.ctx.fillStyle=t.style.scrollBarActiveColor),u(X.verticalBox.x,X.verticalBox.y,X.verticalBox.width,X.verticalBox.height,t.style.scrollBarBoxBorderRadius),t.ctx.stroke(),t.ctx.fill()),Ot=!0,t.visibleCells.unshift(X.verticalBar),t.visibleCells.unshift(X.verticalBox)),Ot&&(t.ctx.strokeStyle=t.style.scrollBarCornerBorderColor,t.ctx.fillStyle=t.style.scrollBarCornerBackgroundColor,u(X.corner.x,X.corner.y,X.corner.width,X.corner.height,0),t.ctx.stroke(),t.ctx.fill(),t.visibleCells.unshift(X.corner)),x&&t.resize(!0),function(){var y=xe,S=Dt,G=L(),ot=Gt.y+Gt.h-ee,z=t.attributes.columnGroupIndicatorPosition==="left",_=t.attributes.rowGroupIndicatorPosition==="top",E=t.ctx;E.save(),E.fillStyle=t.style.groupingAreaBackgroundColor,g(0,-S,rt,S),g(-y,-S,y,lt),E.restore();for(var M=[],N=0;N<t.groupedColumns.length;N++)for(var v=t.groupedColumns[N],Y=0;Y<v.length;Y++)M.push(Object.assign({row:N},v[Y]));M.length>0&&function(){for(var ft=t.style.columnGroupRowHeight,tt=.5*ft,it=.5*(ft-tt),oe=function(he){var Yt=this,U=M[he],Jt=U.row,Ut=U.collapsed,Tt=Jt*ft-S,It=Tt+.5*ft,At=Tt+ft-it,zt=kt-tt-it,gt=(function(te){return _newArrowCheck(this,Yt),p(te,Tt+it,tt,U.collapsed)}).bind(this),_t=(function(te,ve){return _newArrowCheck(this,Yt),t.visibleGroups.push({type:"c",collapsed:Ut,from:U.from,to:U.to,row:Jt,x:te+y,y:Tt+S,x2:ve+y,y2:At+S})}).bind(this),fe=U.from<t.frozenColumn&&U.to>=t.frozenColumn,ge=U.from>=t.frozenColumn;if(Ut){var yt=zt+tt;if(U.from>0){var Qt=U.to+1,Mt=qt[Qt];if(Mt)yt=Mt.x+it;else{if(Qt=U.from-1,!(Mt=qt[Qt]))return"continue";yt=Mt.x+Mt.w-.5*tt}if(Qt>=t.frozenColumn&&yt<G+kt-it)return"continue"}var le=yt+tt;E.save(),E.strokeStyle=t.style.groupIndicatorColor,E.fillStyle=t.style.groupIndicatorBackgroundColor,gt(yt),E.restore(),_t(yt,le)}var St=void 0,Zt=qt[U.from],Rt=qt[U.to],ie=!0,Pt=!0;for(St=U.from;!Zt&&St<U.to;)Zt=qt[++St],ie=!1;for(St=U.to;!Rt&&St>U.from;)Rt=qt[--St],Pt=!1;if(!Zt||!Rt)return"continue";var $=Rt.x+Rt.w,Q=Zt.x;if(fe){var Lt=qt[t.frozenColumn-1];if(Lt){var $t=Lt.x+Lt.w;z||($t+=tt),$t>=$&&($=(Rt=Lt).x+Rt.w,Pt=!1)}}var bt=kt+(ge?G:0);if($+(z?0:tt)<bt)return"continue";$-=it,Q+=it,E.save(),E.strokeStyle=t.style.groupIndicatorColor,E.fillStyle=t.style.groupIndicatorBackgroundColor;var jt=[];z?(Q<(bt+=2*it)&&(Q=bt),U.from===0&&(Q-=2*it),$>=Q?(jt.push(Q,It,$,It),Pt&&jt.push($,At)):$=Q,gt(Q-=tt),$+=it-1):(Q<bt&&(Q=bt),U.from===0&&(Q-=2*it),Pt&&(U.to===t.frozenColumn-1?$-=tt:$+=2*it,gt($)),Q>$?Q=$:(U.from===0&&(ie=!0,Q=zt+tt),ie&&jt.push(Q,At),jt.push(Q,It,$,It)),Q-=it+1,Pt&&($+=tt)),c(jt),E.restore(),_t(Q,$)},Nt=0;Nt<M.length;Nt++)oe(Nt)}();for(var H=[],nt=0;nt<t.groupedRows.length;nt++)for(var Ct=t.groupedRows[nt],st=0;st<Ct.length;st++)H.push(Object.assign({col:nt},Ct[st]));H.length>0&&function(){for(var ft=t.style.rowGroupColumnWidth,tt=.5*ft,it=.5*(ft-tt),oe=function(he){var Yt=this,U=H[he],Jt=U.col,Ut=U.collapsed,Tt=Jt*ft-y,It=Tt+.5*ft,At=Tt+ft-it,zt=ee-tt-it,gt=(function(te){return _newArrowCheck(this,Yt),p(Tt+it,te,tt,U.collapsed)}).bind(this),_t=(function(te,ve){return _newArrowCheck(this,Yt),t.visibleGroups.push({type:"r",collapsed:Ut,from:U.from,to:U.to,col:Jt,x:Tt+y,y:te+S,x2:At+y,y2:ve+S})}).bind(this),fe=U.from<t.frozenRow&&U.to>=t.frozenRow,ge=U.from>=t.frozenRow;if(Ut){var yt=zt+tt;if(U.from>0){var Qt=U.to+1,Mt=Wt[Qt];if(Mt)yt=Mt.y;else{if(Qt=U.from-1,!(Mt=Wt[Qt]))return"continue";yt=Mt.y+Mt.h-.5*tt}if(Qt>=t.frozenRow&&yt<ot+ee-it)return"continue"}var le=yt+tt;E.save(),E.strokeStyle=t.style.groupIndicatorColor,E.fillStyle=t.style.groupIndicatorBackgroundColor,gt(yt),E.restore(),_t(yt,le)}var St=void 0,Zt=Wt[U.from],Rt=Wt[U.to],ie=!0,Pt=!0;for(St=U.from;!Zt&&St<U.to;)Zt=Wt[++St],ie=!1;for(St=U.to;!Rt&&St>U.from;)Rt=Wt[--St],Pt=!1;if(!Zt||!Rt)return"continue";var $=Rt.y+Rt.h,Q=Zt.y;if(fe){var Lt=Wt[t.frozenRow-1];if(Lt){var $t=Lt.y+Lt.h;_||($t+=tt),$t>=$&&($=(Rt=Lt).y+Rt.h,Pt=!1)}}var bt=ee+(ge?ot:0);if($+(_?0:tt)<bt)return"continue";$-=it,Q+=it,E.save(),E.strokeStyle=t.style.groupIndicatorColor,E.fillStyle=t.style.groupIndicatorBackgroundColor;var jt=[];_?(Q<(bt+=2*it)&&(Q=bt),U.from===0&&(Q-=2*it),$>=Q?(jt.push(It,Q,It,$),Pt&&jt.push(At,$)):$=Q,gt(Q-=tt),$+=it-1):(Q<bt&&(Q=bt),U.from===0&&(Q-=2*it),Pt&&(U.to===t.frozenRow-1&&($-=tt),gt($)),Q>$?Q=$:(U.from===0&&(ie=!0,Q=zt+tt),ie&&jt.push(At,Q),jt.push(It,Q,It,$),Q-=it+1),Pt&&($+=tt)),c(jt),E.restore(),_t(Q,$)},Nt=0;Nt<H.length;Nt++)oe(Nt)}()}(),t.ctx.save(),(t.attributes.showPerformance||t.attributes.debug)&&(a.length===0&&(a=s(0,e,1,0)),a.pop(),a.unshift(performance.now()-P)),t.attributes.debug&&(t.ctx.font=t.style.debugFont,(K={}).perf=(a.reduce(function(y,S){return y+S},0)/Math.min(r,a.length)).toFixed(1),K.perfDelta=a[0].toFixed(1),K.frozenColumnsWidth=L(),K.htmlImages=Object.keys(t.htmlImageCache).length,K.reorderObject="x: "+(t.reorderObject||{columnIndex:0}).columnIndex+", y: "+(t.reorderObject||{rowIndex:0}).rowIndex,K.reorderTarget="x: "+(t.reorderTarget||{columnIndex:0}).columnIndex+", y: "+(t.reorderTarget||{rowIndex:0}).rowIndex,K.scale=t.scale,K.startScale=t.startScale,K.scaleDelta=t.scaleDelta,K.zoomDeltaStart=t.zoomDeltaStart,K.touchLength=t.touchLength,K.touches="y0: "+(t.touchPosition||{y:0}).y+" y1: "+(t.touchPosition1||{y:0}).y,K.scrollBox=t.scrollBox.toString(),K.scrollIndex="x: "+t.scrollIndexLeft+", y: "+t.scrollIndexTop,K.scrollPixel="x: "+t.scrollPixelLeft+", y: "+t.scrollPixelTop,K.canvasOffset="x: "+t.canvasOffsetLeft+", y: "+t.canvasOffsetTop,K.touchDelta="x: "+t.touchDelta.x+", y: "+t.touchDelta.y,K.touchAnimateTo="x: "+t.touchAnimateTo.x+", y: "+t.touchAnimateTo.y,K.scrollAnimation="x: "+t.scrollAnimation.x+", y: "+t.scrollAnimation.y,K.touchPPS="x: "+t.xPPS+", y: "+t.yPPS,K.touchPPST="x: "+t.xPPST+", y: "+t.yPPST,K.touchDuration=t.touchDuration,K.pointerLockPosition=t.pointerLockPosition?t.pointerLockPosition.x+", "+t.pointerLockPosition.y:"",K.size="w: "+t.width+", h: "+t.height,K.mouse="x: "+t.mouse.x+", y: "+t.mouse.y,K.touch=t.touchStart?"x: "+t.touchStart.x+", y: "+t.touchStart.y:"",K.entities=t.visibleCells.length,K.hasFocus=t.hasFocus,K.dragMode=t.dragMode,t.currentCell&&(K.columnIndex=t.currentCell.columnIndex,K.rowIndex=t.currentCell.rowIndex,K.sortColumnIndex=t.currentCell.sortColumnIndex,K.sortRowIndex=t.currentCell.sortRowIndex,K.context=t.currentCell.context,K.dragContext=t.currentCell.dragContext,K.style=t.currentCell.style,K.type=t.currentCell.type),t.ctx.textAlign="right",t.ctx.fillStyle=t.style.debugBackgroundColor,g(0,0,t.width,t.height),Object.keys(K).forEach(function(y,S){var G=y+": "+K[y];t.ctx.fillStyle=t.style.debugColor,R(G,rt-20,(t.attributes.showPerformance?140:24)+14*S)})),t.ctx.restore(),function(){if(t.attributes.showPerformance){var y=250,S=t.width-y-t.style.scrollBarWidth-2*t.style.scrollBarBorderWidth,G=ee,ot=100;n.length===0&&(n=s(0,e,1,function(){return[0,0]})),i.length===0&&(i=s(0,e,1,function(){return[0,0]})),o.length===0&&(o=s(0,e,1,0)),t.ctx.lineWidth=.5,t.ctx.textAlign="left",t.ctx.font=t.style.debugFont,t.ctx.fillStyle=t.style.debugPerfChartBackground,g(S,G,y,ot),[["Scroll Height",n,0,t.scrollBox.scrollHeight,t.style.debugScrollHeightColor,!1],["Scroll Width",n,1,t.scrollBox.scrollWidth,t.style.debugScrollWidthColor,!1],["Performance",a,void 0,200,t.style.debugPerformanceColor,!1],["Entities",o,void 0,1500,t.style.debugEntitiesColor,!1],["TouchPPSX",i,0,1e3,t.style.debugTouchPPSXColor,!0],["TouchPPSY",i,1,1e3,t.style.debugTouchPPSYColor,!0]].forEach(function(_,E){_.push(E),z.apply(null,_)}),t.ctx.fillStyle=t.style.debugPerfChartBackground,o.pop(),o.unshift(t.visibleCells.length),n.pop(),n.unshift([t.scrollBox.scrollTop,t.scrollBox.scrollLeft]),i.pop(),i.unshift([t.yPPS,t.xPPS])}function z(_,E,M,N,v,Y,H){var nt;(function(Ct,st,ft,tt,it,oe,Nt,he,Yt){var U=Ct/it.length,Jt=st/Nt;ft+=t.canvasOffsetLeft,tt+=t.canvasOffsetTop,t.ctx.beginPath(),t.ctx.moveTo(ft,tt+st),it.forEach(function(Ut){var Tt,It,At=oe===void 0?Ut:Ut[oe];Yt&&(At=Math.abs(At)),Tt=ft+U,It=tt+st-At*Jt,t.ctx.lineTo(Tt,It),ft+=U}),t.ctx.moveTo(ft+Ct,tt+st),t.ctx.strokeStyle=he,t.ctx.stroke()})(y,ot,S,G,E,M,N,v,Y),t.ctx.fillStyle=v,g(3+S,G+9+11*H,8,8),t.ctx.fillStyle=t.style.debugPerfChartTextColor,nt=M!==void 0?E[0][M]:E[0],R(_+" "+(isNaN(nt)?0:nt).toFixed(3),14+S,G+16+11*H)}}(),t.dispatchEvent("afterdraw",{})||t.ctx.restore()}}function we(y){var S=this;return Ce.findIndex((function(G){return _newArrowCheck(this,S),y>=G.from&&y<=G.to}).bind(this))>=0}function be(y,S,G,ot){var z=this;y.selectionBorder="";var _=ot?(function(H,nt){return _newArrowCheck(this,z),isCellSelected(t.selections,H-ot.y,nt-ot.x)}).bind(this):(function(H,nt){return _newArrowCheck(this,z),isCellSelected(t.selections,H,nt)}).bind(this),E=Math.max(at.length-1,0),M=Math.max(Bt.length-1,0),N=y.isRowHeader,v=y.rowIndex,Y=y.columnIndex;!N&&_(v,Y)&&(_(v-1,Y)&&v!==0||y.isHeader||(S.push([y,"t"]),y[G+"BorderTop"]=!0,y[G+"Border"]+="t"),(v>=M||!_(v+1,Y))&&(S.push([y,"b"]),y[G+"BorderBottom"]=!0,y[G+"Border"]+="b"),Y!==0&&_(v,Y-1)||(S.push([y,"l"]),y[G+"BorderLeft"]=!0,y[G+"Border"]+="l"),(Y>=E||!_(v,Y+1))&&(S.push([y,"r"]),y[G+"BorderRight"]=!0,y[G+"Border"]+="r"))}function re(y,S,G){var ot=t.orders.rows[t.activeCell.rowIndex]===S||t.isRowSelected(S);return function(z,_,E){var M=this;if(z.hidden)return 0;var N,v,Y,H=z.style||"cell",nt=/HeaderCell/.test(H),Ct=/cornerCell/.test(H),st=H==="rowHeaderCell",ft=H==="columnHeaderCell",tt=t.filterable.rows.includes(G)&&t.filterable.columns.includes(_),it=t.style.cellWhiteSpace!=="nowrap",oe=isCellSelected(t.selections,S,E),Nt=t.hovers.rowIndex===S&&(t.attributes.hoverMode==="row"||t.hovers.columnIndex===E),he=t.selectedFilterButton.rowIndex==G&&t.selectedFilterButton.columnIndex==_,Yt=t.activeCell.rowIndex===S&&t.activeCell.columnIndex===E,U=H==="columnHeaderCellCap",Jt=y?y[z.name]:void 0,Ut=z.type==="canvas-datagrid",Tt=t.formatters[z.type||"string"],It=0,At=0,zt=t.sizes.columns[_]||z.width,gt={value:Jt,row:y,header:z},_t=!1;if(!(t.orders.columns[t.activeCell.columnIndex]===_||t.isColumnSelected(t.activeCell.viewColumnIndex))&&!ot||E!==-1&&S!==-1||(_t=st?"activeRowHeaderCell":"activeColumnHeaderCell"),U&&(zt=rt-W),zt===void 0&&(zt=t.style.cellWidth),zt*=t.scale,W+zt+t.style.cellBorderWidth<0&&(W+=zt+t.style.cellBorderWidth),Yt&&H!=="cornerCell"&&(H="activeCell"),t.visibleRows.indexOf(G)!==-1||nt||t.visibleRows.push(G),Y=t.dispatchEvent("formatcellvalue",gt),A=W,O=Z,H==="cornerCell"?(A=0,O=0):st?A=0:nt&&(O=0),(v={type:Ut?"canvas-datagrid-cell":z.type,style:H,nodeType:"canvas-datagrid-cell",x:A,y:O,fontHeight:(t.style[H+"FontHeight"]||0)*t.scale,horizontalAlignment:t.style[H+"HorizontalAlignment"],verticalAlignment:t.style[H+"VerticalAlignment"],paddingLeft:(t.style[H+"PaddingLeft"]||0)*t.scale,paddingTop:(t.style[H+"PaddingTop"]||0)*t.scale,paddingRight:(t.style[H+"PaddingRight"]||0)*t.scale,paddingBottom:(t.style[H+"PaddingBottom"]||0)*t.scale,whiteSpace:t.style.cellWhiteSpace,lineHeight:t.style.cellLineHeight,lineSpacing:t.style.cellLineSpacing,offsetTop:t.canvasOffsetTop+O,offsetLeft:t.canvasOffsetLeft+A,scrollTop:t.scrollBox.scrollTop,scrollLeft:t.scrollBox.scrollLeft,active:Yt||_t,hovered:Nt,selected:oe,width:zt,height:Et,offsetWidth:zt,offsetHeight:Et,parentNode:t.intf.parentNode,offsetParent:t.intf.parentNode,data:y,isCorner:Ct,isHeader:nt,isColumnHeader:ft,isColumnHeaderCellCap:U,isRowHeader:st,isFilterable:tt,openedFilter:he,rowOpen:j,header:z,columnIndex:E,rowIndex:S,viewRowIndex:S,viewColumnIndex:E,boundRowIndex:t.getBoundRowIndexFromViewRowIndex(S),boundColumnIndex:t.getBoundColumnIndexFromViewColumnIndex(E),sortColumnIndex:_,sortRowIndex:G,isGrid:Ut,isNormal:!Ut&&!Ct&&!nt,gridId:(t.attributes.name||"")+G+":"+_,parentGrid:t.intf,innerHTML:"",activeHeader:_t,value:nt&&!st?z.title||z.name:Jt,isRowTree:S>=0&&E==t.cellTree.rowTreeColIndex&&t.cellTree.rows.length>0&&t.cellTree.rows[S].icon,isColumnTree:E>=0&&t.cellTree.columns[S]&&t.cellTree.columns[S][E].icon}).calculatedLineHeight=v.fontHeight*v.lineHeight+v.lineSpacing,v.paddedWidth=v.width-v.paddingRight-v.paddingLeft,v.paddedHeight=v.height-v.paddingTop-v.paddingBottom,gt.cell=v,v.userHeight=v.isHeader?t.sizes.rows[-1]:V,v.userWidth=v.isHeader?t.sizes.columns.cornerCell:t.sizes.columns[_],t.visibleCells.unshift(v),function(C){var q=C.boundRowIndex;if(q>=-1==0){if(C.rowIndex!==-1)return;q=-1}Wt[q]||(Wt[q]={y:C.y,h:C.height})}(v),function(C){var q=C.columnIndex;qt[q]||(qt[q]={x:C.x,w:C.width})}(v),!t.dispatchEvent("beforerendercell",gt)){if(t.ctx.fillStyle=t.style[H+"BackgroundColor"],t.ctx.strokeStyle=t.style[H+"BorderColor"],t.ctx.lineWidth=t.style[H+"BorderWidth"],Nt&&(t.ctx.fillStyle=t.style[H+"HoverBackgroundColor"],t.ctx.strokeStyle=t.style[H+"HoverBorderColor"]),oe&&(t.ctx.fillStyle=t.style[H+"SelectedBackgroundColor"],t.ctx.strokeStyle=t.style[H+"SelectedBorderColor"]),_t&&(t.ctx.fillStyle=t.style[_t+"BackgroundColor"]),t.dispatchEvent("rendercell",gt),v.isGrid&&(v.height!==V&&(v.height=V||t.style.cellHeightWithChildGrid,x=!0),v.width=t.sizes.columns[_]||t.style.cellWidthWithChildGrid),j&&!v.isRowHeader&&(v.height=t.sizes.rows[G]||t.style.cellHeight),v.isGrid||(g(A,O,v.width,v.height),w(A,O,v.width,v.height)),t.ctx.save(),u(v.x,v.y,v.width,v.height,0),t.ctx.clip(),t.dispatchEvent("afterrendercell",gt),v.height===Et||j&&!v.isRowHeader||(t.sizes.rows[nt?-1:G]=v.height,x=!0),v.width!==zt&&(t.sizes.columns[_]=v.width,x=!0),st&&t.attributes.tree&&(t.dispatchEvent("rendertreearrow",gt)||(At=function(C,q,et){var ct=t.style.treeArrowMarginTop*t.scale,dt=t.style.treeArrowMarginRight*t.scale,mt=t.style.treeArrowMarginLeft*t.scale,pt=t.style.treeArrowWidth*t.scale,xt=t.style.treeArrowHeight*t.scale;return q+=t.canvasOffsetLeft,et+=t.canvasOffsetTop,t.ctx.fillStyle=t.style.treeArrowColor,t.ctx.strokeStyle=t.style.treeArrowBorderColor,t.ctx.beginPath(),q+=mt,et+=ct,t.openChildren[C.rowIndex]?(t.ctx.moveTo(q,et),t.ctx.lineTo(q+pt,et),t.ctx.lineTo(q+.5*pt,et+xt),t.ctx.moveTo(q,et)):(t.ctx.lineTo(q,et),t.ctx.lineTo(q+xt,et+.5*pt),t.ctx.lineTo(q,et+pt),t.ctx.lineTo(q,et)),t.ctx.stroke(),t.ctx.fill(),mt+pt+dt}(v,t.style[H+"PaddingLeft"],O))),t.attributes.showRowNumbers&&st||!st){if(v.isGrid&&!t.dispatchEvent("beforerendercellgrid",gt)){if(!t.childGrids[v.gridId]){if((N=t.cellGridAttributes).name=t.attributes.saveAppearance?v.gridId:void 0,N.component=!1,N.parentNode=v,N.data=Jt,gt.cellGridAttributes=N,t.dispatchEvent("beforecreatecellgrid",gt))return;t.childGrids[v.gridId]=t.createGrid(N),t.sizes.rows[G]=t.sizes.rows[G]||t.style.cellGridHeight,x=!0}v.grid=t.childGrids[v.gridId],v.grid.parentNode=v,v.grid.visible=!0,v.grid.draw(),t.dispatchEvent("rendercellgrid",gt)}else if(!v.isGrid&&(t.childGrids[v.gridId]&&(t.childGrids[v.gridId].parentNode.offsetHeight=0),nt&&t.orderBy===z.name&&(t.dispatchEvent("renderorderbyarrow",gt)||(It=function(C,q){var et=t.style.columnHeaderOrderByArrowMarginTop*t.scale,ct=t.style.columnHeaderOrderByArrowMarginLeft*t.scale,dt=t.style.columnHeaderOrderByArrowMarginRight*t.scale,mt=t.style.columnHeaderOrderByArrowWidth*t.scale,pt=t.style.columnHeaderOrderByArrowHeight*t.scale;return C+=t.canvasOffsetLeft,q+=t.canvasOffsetTop,t.ctx.fillStyle=t.style.columnHeaderOrderByArrowColor,t.ctx.strokeStyle=t.style.columnHeaderOrderByArrowBorderColor,t.ctx.beginPath(),C+=ct,q+=et,t.orderDirection==="asc"?(t.ctx.lineTo(C,q+pt),t.ctx.lineTo(C+mt,q+pt),t.ctx.lineTo(C+.5*mt,q),t.ctx.lineTo(C,q+pt)):(t.ctx.moveTo(C,q),t.ctx.lineTo(C+mt,q),t.ctx.lineTo(C+.5*mt,q+pt),t.ctx.moveTo(C,q)),t.ctx.stroke(),t.ctx.fill(),ct+mt+dt}(A+t.style[H+"PaddingLeft"],0))),t.ctx.fillStyle=t.style[H+"Color"],Nt&&(t.ctx.fillStyle=t.style[H+"HoverColor"]),oe&&(t.ctx.fillStyle=t.style[H+"SelectedColor"]),_t&&(t.ctx.fillStyle=t.style[_t+"Color"]),v.treeArrowWidth=At,v.orderByArrowWidth=It,(Y=Y!==void 0?Y:Tt?Tt(gt):"")!==void 0||Tt||(Y="",console.warn("canvas-datagrid: Unknown format "+z.type+" add a cellFormater")),v.formattedValue=(Y??"").toString(),t.columnFilters&&t.columnFilters[Y]!==void 0&&nt&&(v.formattedValue=t.attributes.filterTextPrefix+Y),t.ctx.font=t.style[H+"FontHeight"]*t.scale+"px "+t.style[H+"FontName"],t.dispatchEvent("formattext",gt)||(v.text=function(C,q){var et=this;if(!C.formattedValue)return{lines:[{width:0,value:""}],width:0,height:C.calculatedLineHeight};var ct,dt,mt,pt,xt,Kt,ne=C.formattedValue.split(q),rr=C.calculatedLineHeight,se=[],qe=t.style.cellWhiteSpace!=="nowrap",or=t.attributes.autoResizeRows&&qe,Ae=t.attributes.ellipsisText,me={width:0,value:""},nr=qe?C.paddedHeight:C.calculatedLineHeight;for(se.push(me),mt=t.ctx.measureText(" "+Ae).width,ct=0;ct<ne.length;ct+=1){var Fe=(dt=ne[ct])[dt.length-1]==="-"?"":q,ze=t.ctx.measureText(dt+Fe);if(me.width+ze.width+mt<C.paddedWidth)me.value+=dt+Fe,me.width+=ze.width;else if(/\w-\w/.test(dt)&&C.paddedWidth<ze.width){var Oe=dt.split("-");Oe=Oe.map((function(Je,lr){return _newArrowCheck(this,et),lr===Oe.length-1?Je:Je+"-"}).bind(this)),ne.splice.apply(ne,[ct,1].concat(_toConsumableArray(Oe))),ct-=1}else{if(me={width:ze.width,value:dt+Fe},ct===0&&(se=[]).push(me),(rr+=C.calculatedLineHeight)>nr&&!or){if(se.length===0||(Kt=se[se.length-1]).width<C.paddedWidth&&ne.length===1)break;var Xe=xt=Kt.value+dt;if((pt=t.ctx.measureText(xt+Ae).width)>C.paddedWidth)for(var He=parseInt(xt.length/2),Ye=-1;He>0;)xt=Xe.substr(0,He*Ye+xt.length),Ye=(pt=t.ctx.measureText(xt+Ae).width)>C.paddedWidth?-1:1,He=parseInt(He/2);xt+=Xe.length!=xt.length?Ae:"",Kt.value=xt,Kt.width=pt;break}ct>0&&se.push(me)}}return{lines:se,width:0,height:C.calculatedLineHeight*se.length}}(v," ")),!t.dispatchEvent("rendertext",gt))){if(v.innerHTML||z.type==="html")d(v);else{var fe=0,ge=!0;if(v.columnIndex==t.cellTree.rowTreeColIndex&&!v.isColumnHeader&&t.cellTree.rows.length>0&&Object.keys(t.cellTree.rows[v.rowIndex]).length>1&&(fe=m(v,t.cellTree.rows[v.rowIndex],!0)),!v.isRowHeader&&v.rowIndex>0&&t.cellTree.columns[v.rowIndex-1]&&t.cellTree.columns[v.rowIndex-1][v.columnIndex].icon){for(var yt=v.rowIndex-1;yt>=0&&t.cellTree.columns[yt]&&t.cellTree.columns[yt][v.columnIndex].icon;yt--)if(!t.cellTree.columns[yt][v.columnIndex].expand){ge=!1;break}}ge&&!v.isRowHeader&&t.cellTree.columns[v.rowIndex]&&t.cellTree.columns[v.rowIndex][v.columnIndex].icon&&t.viewData.length>0&&t.viewData[v.rowIndex][v.columnIndex].length>0&&(fe=m(v,t.cellTree.columns[v.rowIndex][v.columnIndex],!1)),ge&&function(C){var q,et,ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,dt=(C.text.lines.length,C.fontHeight*C.lineHeight),mt=t.style.cellWhiteSpace!=="nowrap",pt=0;for(q=0;q<C.text.lines.length;q+=1){et=C.text.lines[q];var xt=Math.max(.5*(C.height-(mt?C.text.height:C.calculatedLineHeight)),0)+dt,Kt=C.paddingLeft+ct+C.treeArrowWidth+C.orderByArrowWidth;C.horizontalAlignment==="right"?Kt=C.paddingLeft+ct+C.paddedWidth-et.width:C.horizontalAlignment==="center"&&(Kt=C.paddingLeft+ct+(C.paddedWidth+C.paddingRight)/2-et.width/2),C.verticalAlignment==="top"?xt=C.calculatedLineHeight:C.verticalAlignment==="bottom"&&(xt=C.height-C.paddingBottom-C.text.height),et.height=dt+C.lineSpacing,et.offsetLeft=Kt,et.offsetTop=xt,et.x=C.x+Kt,et.y=C.y+pt+xt,pt+=et.height,R(et.value,et.x,et.y)}t.attributes.debug&&C.active&&requestAnimationFrame(function(){t.ctx.font=t.style.debugFont,t.ctx.fillStyle=t.style.debugColor,R(JSON.stringify({x:C.x,y:C.y,h:C.height,w:C.width,pw:C.paddedWidth,idx:C.columnIndex,idx_ord:C.sortColumnIndex},null,"	"),C.x+14,C.y+14),R(JSON.stringify(C.text.lines.map(function(ne){return{w:ne.width,v:ne.value.length}}),null,"	"),C.x+14,C.y+30)})}(v,fe)}it&&v.text&&v.text.height>V&&(t.sizes.rows[nt?-1:G]=v.text.height,x=!0)}}Yt&&(ht=v),be(v,Ht,"selection"),function(C){(t.attributes.allowMovingSelection||t.mobile)&&(C.selectionBorderTop&&C.selectionBorderRight&&t.mobile&&(de.push([C,"tr"]),C.selectionHandle="tr"),C.selectionBorderTop&&C.selectionBorderLeft&&(t.mobile&&(de.push([C,"tl"]),C.selectionHandle="tl"),t.fillOverlay.handle&&(t.fillOverlay.snapTo={x:C.x,y:C.y})),C.selectionBorderBottom&&C.selectionBorderLeft&&t.mobile&&(de.push([C,"bl"]),C.selectionHandle="bl"),C.selectionBorderBottom&&C.selectionBorderRight&&(t.attributes.selectionHandleBehavior!=="none"||t.mobile)&&(de.push([C,"br"]),C.selectionHandle="br",t.fillOverlay.handle&&(t.fillOverlay.handle.x=C.x+C.width,t.fillOverlay.handle.y=C.y+C.height)),t.fillOverlay.handle&&(t.fillOverlay.snapTo.x===-1&&C.selectionBorderLeft&&(t.fillOverlay.snapTo.x=C.x),t.fillOverlay.snapTo.y===-1&&C.selectionBorderTop&&(t.fillOverlay.snapTo.y=C.y)))}(v),t.movingSelection&&be(v,Ft,"move",t.moveOffset),t.ctx.restore(),tt&&function(C,q){var et=C.x+C.width-t.style.filterButtonWidth-1,ct=C.y+C.height-t.style.filterButtonHeight-2;t.dispatchEvent("beforerenderfilterbutton",q)||(t.ctx.save(),t.ctx.strokeStyle=t.style.filterButtonBorderColor,t.ctx.fillStyle=t.style.filterButtonBackgroundColor,C.openedFilter?t.ctx.fillStyle=t.style.filterButtonActiveBackgroundColor:C.hovered&&t.hovers.onFilterButton&&(t.ctx.fillStyle=t.style.filterButtonHoverBackgroundColor),u(et,ct,t.style.filterButtonWidth,t.style.filterButtonHeight,t.style.filterButtonBorderRadius),t.ctx.stroke(),t.ctx.fill(),function(dt,mt){var pt=(t.style.filterButtonHeight-t.style.filterButtonArrowHeight)/2*t.scale,xt=(t.style.filterButtonWidth-t.style.filterButtonArrowWidth)/2*t.scale,Kt=t.style.filterButtonArrowWidth*t.scale,ne=t.style.filterButtonArrowHeight*t.scale;dt+=t.canvasOffsetLeft,mt+=t.canvasOffsetTop,t.ctx.fillStyle=t.style.filterButtonArrowColor,t.ctx.strokeStyle=t.style.filterButtonArrowBorderColor,t.ctx.beginPath(),dt+=xt,mt+=pt,t.ctx.moveTo(dt,mt),t.ctx.lineTo(dt+Kt,mt),t.ctx.lineTo(dt+.5*Kt,mt+ne),t.ctx.moveTo(dt,mt),t.ctx.stroke(),t.ctx.fill()}(et,ct),t.ctx.clip(),t.dispatchEvent("afterrenderfilterbutton",q),t.ctx.restore())}(v);var Qt=t.orderings.columns&&t.orderings.columns.length>0;if(st&&t.attributes.showRowNumbers&&t.attributes.showRowNumberGaps&&Qt===!1){var Mt=t.getBoundRowIndexFromViewRowIndex(S-1),le=Mt!==void 0&&v.boundRowIndex>0&&v.boundRowIndex-Mt>1;if(le&&ae.length>0&&(le=ae.find((function(C){return _newArrowCheck(this,M),C.from===Mt&&C.to===v.boundRowIndex}).bind(this))>=0),le&&t.hiddenRowRanges.length>0)for(var St=0;St<t.hiddenRowRanges.length;St++){var Zt=_slicedToArray(t.hiddenRowRanges[St],2),Rt=Zt[0],ie=Zt[1];if(v.boundRowIndex===ie+1&&Mt===Rt-1){le=!1;break}}if(le){var Pt=t.style.rowHeaderCellRowNumberGapHeight,$=t.style.rowHeaderCellRowNumberGapColor;t.ctx.save(),t.ctx.fillStyle=$,g(v.x,v.y-Pt/2,v.width,Pt),t.ctx.restore()}}if(ft&&t.attributes.showUnhideColumnsIndicator){var Q,Lt,$t=t.hovers.unhideIndicator,bt=t.style.unhideIndicatorSize,jt=W,te=v.y+Math.max(.5*(v.height-bt),0),ve=(function(C){return _newArrowCheck(this,M),$t&&($t.dir==="l"||$t.dir==="r")&&C>=$t.orderIndex0&&C<=$t.orderIndex1}).bind(this),Ie=(function(C){return _newArrowCheck(this,M),C>=0&&at[C]&&at[C].hidden}).bind(this),De=(function(C,q,et){if(_newArrowCheck(this,M),t.visibleUnhideIndicators.push({x:C-1,y:te-1,x2:C+bt+2,y2:te+bt+2,orderIndex0:Q,orderIndex1:Lt,dir:q}),!et){var ct=v.text&&v.text.lines&&v.text.lines[0];if(ct){var dt=It+At,mt=dt>0?dt:ct.x,pt=ct.x+ct.width;if(C+bt>=mt&&C<=pt)return}}h(C,te,bt,q,et)}).bind(this),Vt=E-1,We=t.orders.columns[Vt];if(Ie(We)){var Qe=ve(We);for(Q=Vt,Lt=Vt;--Vt>=0&&Ie(t.orders.columns[Vt]);)Q=Vt;De(jt,"r",Qe)}Vt=E+1;var Ge=t.orders.columns[Vt];if(Ie(Ge)){var $e=ve(Ge);for(Q=Vt,Lt=Vt;++Vt<t.orders.columns.length&&Ie(t.orders.columns[Vt]);)Lt=Vt;De(W+v.width-bt,"l",$e)}}if(st&&t.attributes.showUnhideRowsIndicator&&t.hiddenRowRanges.length>0){var Se=t.hovers.unhideIndicator,Re=t.style.unhideIndicatorSize,Ee=v.x+v.width-Re-2,Ne=Z,_e={},je={};t.hiddenRowRanges.forEach((function(C){_newArrowCheck(this,M),_e[C[0]-1]=C,je[C[1]+1]=C}).bind(this));var Pe,Le,Me=v.rowIndex+pe,Ve=(function(){return _newArrowCheck(this,M),Se&&(Se.dir==="t"||Se.dir==="b")&&Me>=Se.orderIndex0-1&&Me<=Se.orderIndex1+1}).bind(this),Ue=(function(C,q,et){_newArrowCheck(this,M),t.visibleUnhideIndicators.push({x:Ee-1,y:C-1,x2:Ee+Re+2,y2:C+Re+2,orderIndex0:Pe,orderIndex1:Le,dir:q}),h(Ee,C,Re,q,et)}).bind(this),ke=_e[Me];if(ke){var tr=Ne+v.height-Re,Ze=_slicedToArray(ke,2);Pe=Ze[0],Le=Ze[1],Ue(tr,"t",Ve())}if(ke=je[Me]){var er=Ne,Ke=_slicedToArray(ke,2);Pe=Ke[0],Le=Ke[1],Ue(er,"b",Ve())}}return W+=v.width+(ce?0:t.style.cellBorderWidth),v.width}}}function Te(y,S){var G,ot,z,_,E=at.length;if(Z-2*Et>lt||(wt=Bt[y],j=t.openChildren[y],z=(t.sizes.rows[y]||t.style.cellHeight)*t.scale,ot=(j?t.sizes.trees[y]:0)*t.scale,Z<-(V=z+ot)))return!1;for(t.attributes.showRowHeaders&&(W+=kt),Et=V,_=t.scrollIndexLeft;_<E;_+=1)if(we(_)||(G=t.orders.columns[_],W+=re(wt,y,S)(at[G],G,_)),W>t.width){t.scrollIndexRight=_,t.scrollPixelRight=W;break}for(W=1,t.attributes.showRowHeaders&&(W+=kt),_=0;_<t.frozenColumn&&(we(_)||(G=t.orders.columns[_],W+=re(wt,y,S)(at[G],G,_)),!(W>t.width));_+=1);if(t.lastFrozenColumnPixel=W,Et=V,W=-t.scrollBox.scrollLeft+t.scrollPixelLeft+t.style.cellBorderWidth,B=t.childGrids[y],y!==Bt.length&&j){if(B.visible=!0,B.parentNode={offsetTop:Z+z+t.canvasOffsetTop,offsetLeft:kt-1+t.canvasOffsetLeft,offsetHeight:ot,offsetWidth:t.width-kt-t.style.scrollBarWidth-1,offsetParent:t.intf.parentNode,parentNode:t.intf.parentNode,style:t.style,nodeType:"canvas-datagrid-tree",scrollTop:t.scrollBox.scrollTop,scrollLeft:t.scrollBox.scrollLeft,rowIndex:y,columnGroupsAreaHeight:Dt,rowGroupsAreaWidth:xe},t.intf.parentNode){var M=t.intf.parentNode,N=M.columnGroupsAreaHeight,v=M.rowGroupsAreaWidth;B.parentNode.columnGroupsAreaHeight+=N||0,B.parentNode.rowGroupsAreaWidth+=v||0}t.visibleCells.unshift({rowIndex:y,columnIndex:0,y:B.parentNode.offsetTop,x:B.parentNode.offsetLeft,height:B.height,width:B.width,style:"tree-grid",type:B.parentNode.nodeType}),B.draw()}else B&&(B.parentNode.offsetHeight=0,delete t.sizes.trees[y]);return ye.push([wt,y,S,Z,V]),t.visibleRowHeights[y]=V,Z+=Et+(ce?0:t.style.cellBorderWidth),!0}}}function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function createCommonjsModule(t,a,l){return t(l={path:a,exports:{},require:function(r,e){return commonjsRequire(r,e??l.path)}},l.exports),l.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var dist=createCommonjsModule(function(t){t.exports=function(a){var l={};function r(e){if(l[e])return l[e].exports;var o=l[e]={i:e,l:!1,exports:{}};return a[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=a,r.c=l,r.d=function(e,o,n){r.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},r.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,o){if(1&o&&(e=r(e)),8&o||4&o&&_typeof(e)=="object"&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&typeof e!="string")for(var i in e)r.d(n,i,(function(s){return e[s]}).bind(null,i));return n},r.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(o,"a",o),o},r.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},r.p="",r(r.s=0)}([function(a,l,r){Object.defineProperty(l,"__esModule",{value:!0});var e=r(1),o=Object.keys(e.default).reduce(function(n,i){return n.concat(e.default[i])},[]);l.default=function(n){return o.indexOf(n.key)===-1}},function(a,l,r){Object.defineProperty(l,"__esModule",{value:!0}),l.default={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]}}]).default}),isPrintableKeyEvent=getDefaultExportFromCjs(dist),isSupportedHtml=function(t){var a=this;return[/(?:^(<meta[^>]*>)?[\s\S]*<div[^>]*>)/,/(?:^(<meta[^>]*>)?[\s\S]*<table[^>]*>)/,/(?:^(<meta[^>]*>)?[\s\S]*<span[^>]*>)/,/(?:<!--StartFragment-->[\s\S]*<tr[^>]*>)/,/(?:<!--StartFragment-->[\s\S]*<td[^>]*>)/].some((function(l){return _newArrowCheck(this,a),l.test(t)}).bind(this))},IGNORE_NODETYPES=[8,3],isHtmlTable=function(t){return/(?:<table[^>]*>)|(?:<tr[^]*>)/.test(t)},sanitizeElementData=function(t){var a=t.nodeType===1?t.innerText:t.data;return String(a).replace(/\s+/g," ").trim()},parseHtmlText=function(t){var a=this,l=new DOMParser().parseFromString(t,"text/html"),r=l.querySelector("div")||l.querySelector("span");return sanitizeElementData(r).split(`
`).map((function(e){var o=this;return _newArrowCheck(this,a),e.split("	").map((function(n){return _newArrowCheck(this,o),{value:[{value:n}]}}).bind(this))}).bind(this))},parseHtmlTable=function(t){var a,l=[],r=_createForOfIteratorHelper(new DOMParser().parseFromString(t,"text/html").querySelectorAll("table tr"));try{for(r.s();!(a=r.n()).done;){var e,o=a.value,n=[],i=_createForOfIteratorHelper(o.childNodes);try{for(i.s();!(e=i.n()).done;){var s=e.value;if(!IGNORE_NODETYPES.includes(s.nodeType)){var d={value:[]},c=sanitizeElementData(s);c&&d.value.push({value:c}),n.push(d)}}}catch(p){i.e(p)}finally{i.f()}l.push(n)}}catch(p){r.e(p)}finally{r.f()}return l},parseText=function(t){var a=this;return t.split(`
`).map((function(l){var r=this;return _newArrowCheck(this,a),l.split("	").map((function(e){return _newArrowCheck(this,r),{value:[{value:e}]}}).bind(this))}).bind(this))},parseData=function(t,a){return a==="text/html"&&isHtmlTable(t)?parseHtmlTable(t):a==="text/html"?parseHtmlText(t):parseText(t)},htmlSafe=function(t){return typeof t!="string"?t:t.replace(/</g,"&lt;").replace(/>/g,"&gt;")},createTextString=function(t,a){var l=this;return a?t.map((function(r){return _newArrowCheck(this,l),Object.values(r).join("	")}).bind(this)).join(`
`):t.map((function(r){return _newArrowCheck(this,l),Object.values(r).join("")}).bind(this)).join("")},createHTMLString=function(t,a){var l=this;if(!a)return createTextString(t,a);var r="<table>";return r+=t.map((function(e){var o=this;return _newArrowCheck(this,l),"<tr>"+Object.values(e).map((function(n){return _newArrowCheck(this,o),["<td>",htmlSafe(n),"</td>"].join("")}).bind(this)).join("")+"</tr>"}).bind(this)).join(""),r+="</table>"};function events(t){var a;t.stopPropagation=function(l){l.stopPropagation()},t.addEventListener=function(l,r){t.events[l]=t.events[l]||[],t.events[l].unshift(r)},t.removeEventListener=function(l,r){(t.events[l]||[]).forEach(function(e,o){r===e&&t.events[l].splice(o,1)})},t.dispatchEvent=function(l,r){var e;function o(){e=!0}if(r=l.type?l:r||{},l=l.type||l,t.events[l])return t.events[l].forEach(function(n){r.ctx=t.ctx,r.preventDefault=o,n.apply(t.intf,[r])}),e},t.getRatio=function(){return Math.min(t.attributes.maxPixelRatio,(window.devicePixelRatio||1)/(t.ctx.webkitBackingStorePixelRatio||t.ctx.mozBackingStorePixelRatio||t.ctx.msBackingStorePixelRatio||t.ctx.oBackingStorePixelRatio||t.ctx.backingStorePixelRatio||1))},t.refreshScrollCacheX=function(){var l=this,r=t.getSchema();t.scrollCache.x=[];var e=0,o=t.getCollapsedColumnGroups(),n=(function(i){var s=this;return _newArrowCheck(this,l),o.findIndex((function(d){return _newArrowCheck(this,s),i>=d.from&&i<=d.to}).bind(this))>=0}).bind(this);return r.reduce(function(i,s,d){var c=t.orders.columns[d],p=t.getColumnWidth(c);return r[c].hidden||n(d)||(i+=p),d<t.frozenColumn?(t.scrollCache.x[d]=i,e=i):t.scrollCache.x[d]=Math.max(e+p,i),i},0)||0},t.resize=function(l){if(t.canvas){var r,e,o={x:0,y:0,height:0,width:0,style:"vertical-scroll-bar"},n={x:0,y:0,height:0,width:0,style:"horizontal-scroll-bar"},i={x:0,y:0,height:0,width:0,style:"vertical-scroll-box"},s={x:0,y:0,height:0,width:0,style:"horizontal-scroll-box"},d={x:0,y:0,height:0,width:0,isCorner:!0,isScrollBoxCorner:!0,style:"scroll-box-corner"},c=2*t.style.scrollBarBoxMargin,p=2*t.style.scrollBarBorderWidth,h=.5*t.style.scrollBarBoxMargin,m=t.style.scrollBarWidth+2*t.style.scrollBarBorderWidth,u=t.getRatio(),g=t.style.gridBorderCollapse==="collapse"?1:2,w=t.style.cellBorderWidth*g,R=t.style.columnHeaderCellBorderWidth*g,T=0,I=0,F=(t.viewData||[]).length,D=t.getColumnHeaderCellHeight(),L=t.getRowHeaderCellWidth(),f=t.getColumnGroupAreaHeight(),b=t.getRowGroupAreaWidth(),x=t.style.cellHeight;for(I=t.refreshScrollCacheX(),t.scrollCache.y=[],r=0;r<F;r+=1)t.scrollCache.y[r]=T,T+=((t.sizes.rows[r]||x)+(t.sizes.trees[r]||0))*t.scale+(t.frozenRow>r&&t.sizes.trees[r]||0);if(F>1&&(t.scrollCache.y[r]=T),t.attributes.showNewRow&&(T+=x),t.attributes.snapToRow&&(T+=t.style.cellHeight),j(),t.isChildGrid?(t.width=t.parentNode.offsetWidth,t.height=t.parentNode.offsetHeight):t.height===t.canvas.offsetHeight&&t.width===t.canvas.offsetWidth||(t.height=t.canvas.offsetHeight,t.width=t.canvas.offsetWidth,t.canvasOffsetLeft=t.args.canvasOffsetLeft||0,t.canvasOffsetTop=t.args.canvasOffsetTop||0),t.scrollBox.top=D+f+R,t.scrollBox.left=L+b,B(),O(),t.scrollBox.horizontalBarVisible&&(t.style.height!=="auto"||t.isChildGrid||(t.height+=m),T+=m,j(),B(),O()),t.scrollBox.verticalBarVisible&&(t.style.width!=="auto"||t.isChildGrid||(t.width+=m),I+=m,j(),B(),O()),B(),t.scrollBox.scrollWidth=I-t.scrollBox.width,t.scrollBox.scrollHeight=T-t.scrollBox.height,t.frozenColumn>0?t.scrollBox.widthBoxRatio=(t.scrollBox.width-t.scrollCache.x[t.frozenColumn-1])/I:t.scrollBox.widthBoxRatio=t.scrollBox.width/I,t.scrollBox.scrollBoxWidth=t.scrollBox.width*t.scrollBox.widthBoxRatio-t.style.scrollBarWidth-p-h,t.scrollBox.heightBoxRatio=(t.scrollBox.height-D-f-t.scrollCache.y[t.frozenRow])/T,t.scrollBox.scrollBoxHeight=t.scrollBox.height*t.scrollBox.heightBoxRatio-t.style.scrollBarWidth-p-h,t.scrollBox.scrollBoxWidth=Math.max(t.scrollBox.scrollBoxWidth,t.style.scrollBarBoxMinSize),t.scrollBox.scrollBoxHeight=Math.max(t.scrollBox.scrollBoxHeight,t.style.scrollBarBoxMinSize),n.x+=L,n.y+=t.height-t.style.scrollBarWidth-h-f,n.width=t.width-t.style.scrollBarWidth-L-b-h-c,n.height=t.style.scrollBarWidth+t.style.scrollBarBorderWidth+h,s.y=n.y+t.style.scrollBarBoxMargin,s.width=t.scrollBox.scrollBoxWidth,s.height=t.style.scrollBarBoxWidth,o.x+=t.width-b-t.style.scrollBarWidth-t.style.scrollBarBorderWidth-h,o.y+=D+t.scrollCache.y[t.frozenRow],o.width=t.style.scrollBarWidth+t.style.scrollBarBorderWidth+h,o.height=t.height-D-f-t.style.scrollBarWidth-h-c,i.x=o.x+t.style.scrollBarBoxMargin,i.y+=t.scrollCache.y[t.frozenRow],i.width=t.style.scrollBarBoxWidth,i.height=t.scrollBox.scrollBoxHeight,d.x=n.x+n.width+c,d.y=o.y+o.height+c,d.width=t.style.scrollBarWidth+t.style.scrollBarBorderWidth,d.height=t.style.scrollBarWidth+t.style.scrollBarBorderWidth,t.scrollBox.entities={horizontalBar:n,horizontalBox:s,verticalBar:o,verticalBox:i,corner:d},t.scrollBox.bar={v:o,h:n},t.scrollBox.box={v:i,h:s},t.page=Math.max(1,t.visibleRows.length-3-t.attributes.pageUpDownOverlap),!t.isChildGrid){var P=t.width*u,A=t.height*u;t.canvas.width===P&&t.canvas.height===A||(t.canvas.width=P,t.canvas.height=A,t.ctx.scale(u,u))}return t.resizeEditInput(),t.scroll(!0),l&&t.draw(!0),t.dispatchEvent("resize",{}),!0}function O(){t.scrollBox.horizontalBarVisible=t.style.width!=="auto"&&I>t.scrollBox.width&&t.style.overflowX!=="hidden"||t.style.overflowX==="scroll",t.scrollBox.horizontalBoxVisible=I>t.scrollBox.width,t.scrollBox.verticalBarVisible=t.style.height!=="auto"&&T>t.scrollBox.height&&t.style.overflowY!=="hidden"||t.style.overflowY==="scroll",t.scrollBox.verticalBoxVisible=T>t.scrollBox.height}function B(){t.scrollBox.width=t.width-L-b,t.scrollBox.height=t.height-D-f}function j(){t.isChildGrid||(e={height:D+f+T+w+1,width:I+L+w+b},["width","height"].forEach(function(V){["auto",void 0].indexOf(t.style[V])!==-1&&["auto",void 0].indexOf(t.appliedInlineStyles[V])!==-1?t.parentNodeStyle[V]=e[V]+"px":["auto",void 0].indexOf(t.style[V])==-1&&["auto",void 0].indexOf(t.appliedInlineStyles[V])==-1&&(t.parentNodeStyle[V]=t.style[V],t.isComponent&&(t.canvas.style[V]=t.style[V]))}))}},t.scroll=function(l){var r=t.getSchema(),e=(t.viewData||[]).length,o=t.style.cellHeight;for(t.scrollIndexTop=Math.floor(e*(t.scrollBox.scrollTop/t.scrollBox.scrollHeight)-100),t.scrollIndexTop=Math.max(t.scrollIndexTop,0),t.scrollPixelTop=t.scrollCache.y[t.scrollIndexTop],t.scrollBox.scrollHeight===0&&(t.scrollIndexTop=0),t.scrollPixelTop=0,t.scrollIndexLeft=t.frozenColumn,t.scrollPixelLeft=0;t.scrollPixelTop<t.scrollBox.scrollTop&&t.scrollIndexTop<t.viewData.length;)t.scrollIndexTop+=1,t.scrollPixelTop=t.scrollCache.y[t.scrollIndexTop];for(;t.scrollPixelLeft<t.scrollBox.scrollLeft+1&&t.scrollIndexLeft<r.length;)t.scrollPixelLeft=t.scrollCache.x[t.scrollIndexLeft],t.scrollIndexLeft+=1;r.length>0&&(t.scrollIndexLeft=Math.max(t.scrollIndexLeft-1,0),t.scrollPixelLeft-=t.getColumnWidth(t.orders.columns[t.scrollIndexLeft])),(t.viewData||[]).length>0&&(t.scrollIndexTop=Math.max(t.scrollIndexTop-1,0),t.scrollPixelTop=Math.max(t.scrollPixelTop-(t.viewData[t.scrollIndexTop]?(t.sizes.rows[t.scrollIndexTop]||o)+(t.sizes.trees[t.scrollIndexTop]||0):o)*t.scale,0)),t.ellipsisCache={},l||t.draw(!0),requestAnimationFrame(t.resizeEditInput),t.dispatchEvent("scroll",{top:t.scrollBox.scrollTop,left:t.scrollBox.scrollLeft})},t.mousemove=function(l,r){if(!t.contextMenu&&!t.input){if(t.draggingItem&&l.which===0)return t.stopFreezeMove(l),void t.mouseup(l);t.mouse=r||t.getLayerPos(l);var e,o,n,i,s=(l.ctrlKey||l.metaKey||t.attributes.persistantSelectionMode)&&!t.attributes.singleSelectionMode,d=t.getSchema(),c=t.mouse.x,p=t.mouse.y,h=t.getCellAt(c,p),m=!1,u=!1,g={NativeEvent:l,cell:h,x:c,y:p},w=t.currentCell;if(clearTimeout(t.scrollTimer),t.isInGrid({x:c,y:p})||(t.hasFocus=!1),!t.dispatchEvent("mousemove",g)){if(h&&t.currentCell&&(t.rowBoundaryCrossed=t.currentCell.rowIndex!==h.rowIndex,t.columnBoundaryCrossed=t.currentCell.columnIndex!==h.columnIndex,t.cellBoundaryCrossed=t.rowBoundaryCrossed||t.columnBoundaryCrossed,["row","column","cell"].forEach(function(b){t[b+"BoundaryCrossed"]&&(g.cell=w,t.dispatchEvent(b+"mouseout",g),g.cell=h,t.dispatchEvent(b+"mouseover",g))})),t.currentCell=h,!t.draggingItem&&h&&(h.context==="cell"||h.context===t.cursorGrab)){var R=t.getUnhideIndicator(t.mouse.x,t.mouse.y);if(R)return t.cursor="pointer",t.hovers={unhideIndicator:R},void t.draw()}if(t.hovers={},!t.draggingItem&&h){if(t.dragItem=h,t.dragMode=h.dragContext,t.cursor=h.context,h.context==="cell"&&(t.cursor="default",t.hovers={rowIndex:h.rowIndex,columnIndex:h.columnIndex,onFilterButton:!1,onCellTreeIcon:!1},h.isFilterable&&c>h.x+h.width+t.canvasOffsetLeft-t.style.filterButtonWidth&&c<h.x+h.width+t.canvasOffsetLeft&&p>h.y+h.height+t.canvasOffsetTop-t.style.filterButtonHeight&&p<h.y+h.height+t.canvasOffsetTop&&(t.hovers.onFilterButton=!0,t.draw()),h.isRowTree||h.isColumnTree)){var T=h.isRowTree?t.cellTree.rows[h.rowIndex].parentCount:0,I=t.style.cellTreeIconWidth*t.scale,F=h.x+h.paddingLeft+t.canvasOffsetLeft+t.style.cellTreeIconMarginLeft+T*(I+h.paddingLeft),D=h.y+t.canvasOffsetTop+t.style.cellTreeIconMarginTop*t.scale;c>=F&&c<=F+I&&p>=D&&p<D+I&&(t.hovers.onCellTreeIcon=!0,t.draw())}if(t.selecting||t.reorderObject){if(i={x:Math.abs(t.dragStart.x-c),y:Math.abs(t.dragStart.y-p)},t.dragStartObject.columnIndex!==-1&&l.shiftKey&&(t.dragStartObject={rowIndex:t.activeCell.rowIndex,columnIndex:t.activeCell.columnIndex}),o={top:Math.min(t.dragStartObject.rowIndex,h.rowIndex),left:Math.min(t.dragStartObject.columnIndex,h.columnIndex),bottom:Math.max(t.dragStartObject.rowIndex,h.rowIndex),right:Math.max(t.dragStartObject.columnIndex,h.columnIndex)},t.dragStartObject.columnIndex===-1&&(n=t.getSelectionBounds(),o.left=-1,o.right=d.length-1,o.top=Math.min(n.top,h.rowIndex),o.bottom=Math.max(n.bottom,h.rowIndex),o.top<0&&(o.top=0)),t.dragStartObject.rowIndex===-1&&(n=t.getSelectionBounds(),o.left=h.columnIndex===void 0?n.left:Math.min(n.left,h.columnIndex),o.right=h.columnIndex===void 0?n.right:Math.max(n.right,h.columnIndex),o.top=-1,o.bottom=t.viewData.length-1,o.left<0&&(o.left=0),o.left!=o.right?t.isMultiColumnsSelected=!0:t.isMultiRowsSelected=!1),t.dragStartObject.rowIndex===h.rowIndex&&t.dragStartObject.columnIndex===h.columnIndex||(t.ignoreNextClick=!0),t.cellBoundaryCrossed||i.x===0&&i.y===0||t.attributes.selectionMode==="row")if(h.rowIndex===void 0||t.attributes.selectionMode!=="row"&&t.dragStartObject.columnIndex!==-1||!t.rowBoundaryCrossed)if(h.rowIndex===void 0||t.attributes.selectionMode!=="column"&&t.dragStartObject.rowIndex!==-1||!t.columnBoundaryCrossed){if(t.attributes.selectionMode!=="row"){if(h.hovered&&t.hovers.onFilterButton)return h.openedFilter?(h.openedFilter=!1,t.selectedFilterButton={columnIndex:-1,rowIndex:-1}):(t.selectedFilterButton.rowIndex=h.rowIndex,t.selectedFilterButton.columnIndex=h.columnIndex,t.contextmenuEvent(l,{x:h.x+h.width-t.style.filterButtonWidth,y:h.y+h.height,rect:{left:0,top:0}})),void t.draw();if(h.hovered&&t.hovers.onCellTreeIcon&&l.type=="mousedown")return void t.toggleCollapseTree(h.rowIndex,h.columnIndex);if(t.selectedFilterButton={columnIndex:-1,rowIndex:-1},t.hovers.onFilterButton||t.hovers.onCellTreeIcon)return;t.dragAddToSelection||h.rowIndex===void 0?t.isCellSelected(h)||t.selectCell(h):t.isCellSelected(h)&&t.unselectCell(h)}}else t.dragStartObject.columnIndex<h.columnIndex?(o.left=t.dragStartObject.columnIndex,o.right=h.columnIndex):(o.left=h.columnIndex,o.right=t.dragStartObject.columnIndex);else t.dragStartObject.rowIndex<h.rowIndex?(o.top=t.dragStartObject.rowIndex,o.bottom=h.rowIndex):(o.top=h.rowIndex,o.bottom=t.dragStartObject.rowIndex);if(!(t.selectionBounds&&o.top===t.selectionBounds.top&&o.left===t.selectionBounds.left&&o.bottom===t.selectionBounds.bottom&&o.right===t.selectionBounds.right||s))if(h.hovered&&t.hovers.onFilterButton||t.clearSelections(),o.top===-1&&(o.top=0),n=o,t.attributes.selectionMode==="row")for(e=n.top;e<=n.bottom;e+=1)t.selectRow(e,!0,null,!0);else t.selectArea(n,!0),t.activeCell.rowIndex=n.top,t.activeCell.columnIndex=n.left,n.left==-1&&n.top!==n.bottom&&(t.activeCell.columnIndex=0,t.isMultiRowsSelected=!0,t.isMultiColumnsSelected=!1)}else t.movingSelectionHandle&&(i={x:Math.abs(t.dragStart.x-c),y:Math.abs(t.dragStart.y-p)},t.fillOverlay.direction==="y"?u=!0:t.fillOverlay.direction==="x"&&(m=!0));if(i)if(t.attributes.autoScrollOnMousemove||m||u){var L=!m&&i.y>t.attributes.autoScrollMargin,f=!u&&i.x>t.attributes.autoScrollMargin;L&&!f?t.autoScrollZone(l,-1,p,s):f&&!L?t.autoScrollZone(l,c,-1,s):f&&L&&t.autoScrollZone(l,c,p,s)}else t.autoScrollZone(l,c,p,s)}t.getColumnGroupAt(t.mouse.x,t.mouse.y)&&(t.cursor="pointer"),t.getRowGroupAt(t.mouse.x,t.mouse.y)&&(t.cursor="pointer"),t.cellBoundaryCrossed=!1,t.rowBoundaryCrossed=!1,t.columnBoundaryCrossed=!1,t.draw(!0)}}},t.click=function(l,r){var e,o=JSON.stringify(t.getSelectionBounds()),n=(l.ctrlKey||l.metaKey||t.attributes.persistantSelectionMode)&&!t.attributes.singleSelectionMode,i=r||t.getLayerPos(l);if(t.currentCell=t.getCellAt(i.x,i.y),t.currentCell.grid===void 0){if(t.input&&t.endEdit(),t.ignoreNextClick)t.ignoreNextClick=!1;else if(e=t.currentCell,!t.dispatchEvent("click",{NativeEvent:l,cell:t.currentCell})){var s=t.getUnhideIndicator(i.x,i.y);if(s){var d=s.dir,c=s.orderIndex0,p=s.orderIndex1;d==="l"||d==="r"?t.unhideColumns(c,p):t.unhideRows(c,p)}else{var h=t.getColumnGroupAt(i.x,i.y);if(h||(h=t.getRowGroupAt(i.x,i.y)),h&&t.toggleGroup(h))return t.setStorageData(),void t.refresh();if(t.hasFocus){var m=t.getRowGroupAreaWidth(),u=t.getColumnGroupAreaHeight(),g=i.x-m,w=i.y-u;if(["rowHeaderCell","columnHeaderCell"].indexOf(t.currentCell.style)!==-1||n||t.hovers.onFilterButton||t.setActiveCell(e.columnIndex,e.rowIndex),t.currentCell.context==="cell"){if(t.currentCell.style==="cornerCell")return t.selectAll(),t.draw(),void R();if(t.currentCell.style==="columnHeaderCell"&&t.attributes.columnHeaderClickBehavior==="sort")return t.orderBy===e.header.name?t.orderDirection=t.orderDirection==="asc"?"desc":"asc":t.orderDirection="asc",t.order(e.header.name,t.orderDirection),void R();if((t.attributes.selectionMode==="row"||t.currentCell.style==="rowHeaderCell")&&t.currentCell.style==="rowHeaderCell"&&t.attributes.tree&&g>0&&g-t.currentCell.x<t.style.treeArrowWidth+t.style.treeArrowMarginLeft+t.style.treeArrowMarginRight+t.style.treeArrowClickRadius&&w-t.currentCell.y<t.style.treeArrowHeight+t.style.treeArrowMarginTop+t.style.treeArrowClickRadius&&w>0)return void t.toggleTree(e.rowIndex);l.shiftKey&&!n&&(t.selectionBounds=t.getSelectionBounds(),t.selectArea(void 0,!1))}R(),t.draw(!0)}}}}function R(){var T=t.getSelectionBounds();o!==JSON.stringify(T)&&t.dispatchEvent("selectionchanged",t.getContextOfSelectionEvent())}},t.dragResizeColumn=function(l){var r,e,o,n=t.dragMode==="ew-resize";if(r=t.getLayerPos(l),e=t.resizingStartingWidth+r.x-t.dragStart.x,o=t.resizingStartingHeight+r.y-t.dragStart.y,e<t.style.minColumnWidth&&(e=t.style.minColumnWidth),o<t.style.minRowHeight&&(o=t.style.minRowHeight),t.dispatchEvent(n?"resizecolumn":"resizerow",{x:e,y:o,width:e,height:o,columnIndex:n?t.draggingItem.columnIndex:void 0,rowIndex:n?void 0:t.draggingItem.rowIndex,draggingItem:t.draggingItem}))return!1;t.attributes.resizeAfterDragged?t.pendingDragResize={item:t.draggingItem,width:e,height:o,x:l.clientX,y:l.clientY}:t.dragResizeApply(t.draggingItem,e,o)},t.dragResizeApply=function(l,r,e){return t.scrollBox.scrollLeft>t.scrollBox.scrollWidth-t.attributes.resizeScrollZone&&t.dragMode==="ew-resize"&&t.resize(!0),t.dragMode==="ew-resize"?(t.sizes.columns[l.header.style==="rowHeaderCell"?"cornerCell":l.sortColumnIndex]=r,["rowHeaderCell","cornerCell"].indexOf(l.header.style)!==-1&&t.resize(!0),void t.resizeChildGrids()):t.dragMode==="ns-resize"?(l.rowOpen?t.sizes.trees[l.rowIndex]=e:t.attributes.globalRowResize?t.style.cellHeight=e:t.sizes.rows[l.rowIndex]=e,t.dispatchEvent("resizerow",{row:e}),void t.resizeChildGrids()):void(t.ellipsisCache={})},t.stopDragResize=function(l){var r=t.getLayerPos(l);if(t.attributes.resizeAfterDragged&&(t.dragResizeApply(t.pendingDragResize.item,t.pendingDragResize.width,t.pendingDragResize.height),t.pendingDragResize=void 0),t.dragMode==="ew-resize"){var e=!!(r.x-t.dragStart.x),o=t.isColumnSelected(t.dragItem.columnIndex);if(e&&o){var n=Math.max(t.resizingStartingWidth+r.x-t.dragStart.x,t.style.minColumnWidth);t.fitSelectedColumns(n)}}else if(t.dragMode==="ns-resize"){var i=!!(r.y-t.dragStart.y),s=t.isRowSelected(t.dragItem.rowIndex);if(i&&s){var d=Math.max(t.resizingStartingHeight+r.y-t.dragStart.y,t.style.minRowHeight);t.fitSelectedRows(d)}}t.resize(),window.removeEventListener("mousemove",t.dragResizeColumn,!1),window.removeEventListener("mouseup",t.stopDragResize,!1),t.setStorageData(),t.draw(!0),t.ignoreNextClick=!0},t.scrollGrid=function(l){var r=t.getLayerPos(l);return t.attributes.scrollPointerLock&&t.pointerLockPosition&&["horizontal-scroll-box","vertical-scroll-box"].indexOf(t.scrollStartMode)!==-1&&(t.pointerLockPosition.x+=l.movementX,t.pointerLockPosition.y+=l.movementY,t.pointerLockPosition.x=Math.min(t.width-t.style.scrollBarWidth,Math.max(0,t.pointerLockPosition.x)),t.pointerLockPosition.y=Math.min(t.height-t.style.scrollBarWidth,Math.max(0,t.pointerLockPosition.y)),r=t.pointerLockPosition),t.scrollMode=t.getCellAt(r.x,r.y).context,t.scrollMode==="horizontal-scroll-box"&&t.scrollStartMode!=="horizontal-scroll-box"?(t.scrollStartMode="horizontal-scroll-box",t.dragStart=r,t.scrollStart.left=t.scrollBox.scrollLeft,void clearTimeout(t.scrollTimer)):t.scrollMode==="vertical-scroll-box"&&t.scrollStartMode!=="vertical-scroll-box"?(t.scrollStartMode="vertical-scroll-box",t.dragStart=r,t.scrollStart.top=t.scrollBox.scrollTop,void clearTimeout(t.scrollTimer)):(t.scrollStartMode==="vertical-scroll-box"&&t.scrollMode!=="vertical-scroll-box"&&(t.scrollMode="vertical-scroll-box"),t.scrollStartMode==="horizontal-scroll-box"&&t.scrollMode!=="horizontal-scroll-box"&&(t.scrollMode="horizontal-scroll-box"),clearTimeout(t.scrollTimer),void(t.scrollModes.indexOf(t.scrollMode)!==-1&&(t.scrollMode==="vertical-scroll-box"?t.scrollBox.scrollTop=t.scrollStart.top+(r.y-t.dragStart.y)/t.scrollBox.heightBoxRatio:t.scrollMode==="vertical-scroll-top"?(t.scrollBox.scrollTop-=t.page*t.style.cellHeight,t.scrollTimer=setTimeout(t.scrollGrid,t.attributes.scrollRepeatRate,l)):t.scrollMode==="vertical-scroll-bottom"&&(t.scrollBox.scrollTop+=t.page*t.style.cellHeight,t.scrollTimer=setTimeout(t.scrollGrid,t.attributes.scrollRepeatRate,l)),t.scrollMode==="horizontal-scroll-box"?t.scrollBox.scrollLeft=t.scrollStart.left+(r.x-t.dragStart.x)/t.scrollBox.widthBoxRatio:t.scrollMode==="horizontal-scroll-right"?(t.scrollBox.scrollLeft+=t.attributes.selectionScrollIncrement,t.scrollTimer=setTimeout(t.scrollGrid,t.attributes.scrollRepeatRate,l)):t.scrollMode==="horizontal-scroll-left"&&(t.scrollBox.scrollLeft-=t.attributes.selectionScrollIncrement,t.scrollTimer=setTimeout(t.scrollGrid,t.attributes.scrollRepeatRate,l)))))},t.stopScrollGrid=function(){clearTimeout(t.scrollTimer),document.exitPointerLock&&document.exitPointerLock(),window.removeEventListener("mousemove",t.scrollGrid,!1)},t.dragReorder=function(l){var r,e,o,n=t.dragMode==="column-reorder",i=t.dragMode==="row-reorder";if(e=(r=t.getLayerPos(l)).x-t.dragStart.x,o=r.y-t.dragStart.y,(t.attributes.allowColumnReordering||!n)&&(t.attributes.allowRowReordering||!i)&&((l.ctrlKey||l.metaKey||l.shiftKey)&&t.reorderObject&&(t.dragMode!=="column-reorder"||t.isMultiColumnsSelected||t.selectColumn(t.draggingItem.header.index,!1,!1)),!t.dispatchEvent("reordering",{NativeEvent:l,source:t.dragStartObject,target:t.currentCell,dragMode:t.dragMode})&&(Math.abs(e)>t.attributes.reorderDeadZone||Math.abs(o)>t.attributes.reorderDeadZone))){if(t.reorderObject=t.draggingItem,t.isMultiRowsSelected&&(t.reorderObject=t.getVisibleCellByIndex(-1,t.activeCell.rowIndex)),t.isMultiColumnsSelected&&(t.reorderObject=t.getVisibleCellByIndex(t.activeCell.columnIndex,-1)),!t.reorderObject)return;t.reorderTarget=t.currentCell,t.reorderObject.dragOffset={x:e,y:o},t.autoScrollZone(l,n?r.x:-1,i?r.y:-1,!1)}},t.stopDragReorder=function(l){var r,e,o=this,n={"row-reorder":t.orders.rows,"column-reorder":t.orders.columns},i={"row-reorder":"rowIndex","column-reorder":"sortColumnIndex"}[t.dragMode];if(window.removeEventListener("mousemove",t.dragReorder,!1),window.removeEventListener("mouseup",t.stopDragReorder,!1),t.reorderObject&&t.reorderTarget&&(t.dragMode==="column-reorder"&&t.reorderTarget.sortColumnIndex>-1&&t.reorderTarget.sortColumnIndex<t.getSchema().length||t.dragMode==="row-reorder"&&t.reorderTarget.rowIndex>-1&&t.reorderTarget.rowIndex<t.viewData.length)&&t.reorderObject[i]!==t.reorderTarget[i]&&!t.dispatchEvent("reorder",{NativeEvent:l,source:t.reorderObject,target:t.reorderTarget,dragMode:t.dragMode})){if(t.ignoreNextClick=!0,r=n[t.dragMode].indexOf(t.reorderObject[i]),e=n[t.dragMode].indexOf(t.reorderTarget[i]),t.dragMode==="column-reorder"){var s=t.getRowSelectionStates(0),d=[],c=[];s&&(r=s[0],s.forEach(function(g){d.push(t.orders.columns[g])}));var p=d.length;if(e<r||e>r&&Math.abs(e-r)>=p){n[t.dragMode].splice(r,p),e>r&&(e-=p-1);for(var h=0;h<d.length;h++)h===0&&(t.activeCell.columnIndex=e),c.push(e+h),n[t.dragMode].splice(e+h,0,d[h]);t.orders.columns=n[t.dragMode],t.selectColumnViewIndexes(c)}}else{var m=t.getRowViewIndexesFromSelection().map((function(g){return _newArrowCheck(this,o),t.viewData[g]}).bind(this));if(e<r||e>r&&Math.abs(e-r)>=m.length){t.viewData.splice(r,m.length),e>r&&(e-=m.length-1),t.activeCell.rowIndex=e;for(var u=0;u<m.length;u++)t.viewData.splice(e+u,0,m[u]);t.moveSelection(0,e)}}t.resize(),t.setStorageData()}t.reorderObject=void 0,t.reorderTarget=void 0,t.draw(!0)},t.dragMove=function(l){if(!t.dispatchEvent("moving",{NativeEvent:l,cell:t.currentCell})){var r=t.getLayerPos(l);t.moveOffset={x:t.currentCell.columnIndex-t.dragStartObject.columnIndex,y:t.currentCell.rowIndex-t.dragStartObject.rowIndex},(Math.abs(r.x)>t.attributes.reorderDeadZone||Math.abs(r.y)>t.attributes.reorderDeadZone)&&setTimeout(function(){t.autoScrollZone(l,r.x,r.y,!1)},1)}},t.stopDragMove=function(l){window.removeEventListener("mousemove",t.dragMove,!1),window.removeEventListener("mouseup",t.stopDragMove,!1);var r=t.getSelectionBounds();if(t.dispatchEvent("endmove",{NativeEvent:l,cell:t.currentCell}))return t.movingSelection=void 0,t.moveOffset=void 0,void t.draw(!0);t.moveOffset&&(t.moveTo(t.movingSelection,r.left+t.moveOffset.x,r.top+t.moveOffset.y),t.moveSelection(t.moveOffset.x,t.moveOffset.y)),t.movingSelection=void 0,t.moveOffset=void 0,t.draw(!0)},t.freezeMove=function(l){if(!t.dispatchEvent("freezemoving",{NativeEvent:l,cell:t.currentCell})){var r=t.getLayerPos(l);t.ignoreNextClick=!0,t.freezeMarkerPosition=r,r.x-=t.getRowGroupAreaWidth(),r.y-=t.getColumnGroupAreaHeight(),(Math.abs(r.x)>t.attributes.reorderDeadZone||Math.abs(r.y)>t.attributes.reorderDeadZone)&&setTimeout(function(){t.autoScrollZone(l,r.x,r.y,!1)},1)}},t.stopFreezeMove=function(l){var r=t.getLayerPos(l),e=t.style.gridBorderCollapse==="collapse"?1:2,o=t.style.columnHeaderCellBorderWidth*e,n=t.getColumnHeaderCellHeight(),i=t.getRowHeaderCellWidth();if(r.x-=t.getRowGroupAreaWidth(),r.y-=t.getColumnGroupAreaHeight(),t.currentCell&&t.currentCell.rowIndex!==void 0&&t.dragMode==="frozen-row-marker"){t.scrollBox.scrollTop=0,t.frozenRow=t.currentCell.rowIndex+1,t.scrollBox.bar.v.y=n+o+t.scrollCache.y[t.frozenRow],t.scrollBox.box.v.y=n+o+t.scrollCache.y[t.frozenRow];var s=t.scrollCache.y[t.scrollCache.y.length-1];t.scrollBox.heightBoxRatio=(t.scrollBox.height-n-t.scrollCache.y[t.frozenRow])/s,t.scrollBox.scrollBoxHeight=t.scrollBox.height*t.scrollBox.heightBoxRatio-t.style.scrollBarWidth,t.scrollBox.scrollBoxHeight=Math.max(t.scrollBox.scrollBoxHeight,t.style.scrollBarBoxMinSize),t.scrollBox.box.v.height=t.scrollBox.scrollBoxHeight}if(t.currentCell&&t.currentCell.columnIndex!==void 0&&t.dragMode==="frozen-column-marker"){var d=t.refreshScrollCacheX();t.scrollBox.scrollLeft=0;var c=t.currentCell.x-t.style.frozenMarkerWidth-t.style.frozenMarkerBorderWidth;r.x>c+t.currentCell.width/2?t.frozenColumn=t.currentCell.columnIndex+1:t.currentCell.columnIndex>=0&&(t.frozenColumn=t.currentCell.columnIndex),t.scrollBox.bar.h.x=i+t.scrollCache.x[t.frozenColumn],t.scrollBox.widthBoxRatio=(t.scrollBox.width-t.scrollCache.x[t.frozenColumn])/d,t.scrollBox.scrollBoxWidth=t.scrollBox.width*t.scrollBox.widthBoxRatio-t.style.scrollBarWidth,t.scrollBox.scrollBoxWidth=Math.max(t.scrollBox.scrollBoxWidth,t.style.scrollBarBoxMinSize),t.scrollBox.box.h.width=t.scrollBox.scrollBoxWidth}if((Math.abs(r.x)>t.attributes.reorderDeadZone||Math.abs(r.y)>t.attributes.reorderDeadZone)&&setTimeout(function(){t.autoScrollZone(l,r.x,r.y,!1)},1),window.removeEventListener("mousemove",t.freezeMove,!1),window.removeEventListener("mouseup",t.stopFreezeMove,!1),t.freezeMarkerPosition=void 0,t.dispatchEvent("endfreezemove",{NativeEvent:l,cell:t.currentCell}))return t.frozenRow=t.startFreezeMove.x,t.frozenColumn=t.startFreezeMove.y,void t.draw(!0);t.draw(!0),t.resize()},t.mousedown=function(l,r){if(t.lastMouseDownTarget=l.target,!t.dispatchEvent("mousedown",{NativeEvent:l,cell:t.currentCell})&&t.hasFocus&&l.button!==2&&!t.input){var e=l.ctrlKey||l.metaKey,o=/-move/.test(t.dragMode),n=/frozen-row-marker|frozen-column-marker/.test(t.dragMode),i=/-resize/.test(t.dragMode),s=/selection-handle-br/.test(t.dragMode),d=t.hovers&&t.hovers.unhideIndicator;if(t.dragStart=r||t.getLayerPos(l),t.scrollStart={left:t.scrollBox.scrollLeft,top:t.scrollBox.scrollTop},t.dragStartObject=t.getCellAt(t.dragStart.x,t.dragStart.y),t.dragAddToSelection=!t.dragStartObject.selected,e||l.shiftKey||/(vertical|horizontal)-scroll-(bar|box)/.test(t.dragStartObject.context)||!t.currentCell||t.currentCell.isColumnHeader||o||n||i||s||t.dragMode=="row-reorder"&&t.isMultiRowsSelected||t.currentCell.hovered&&t.hovers.onFilterButton||t.clearSelections(),!t.dragStartObject.isGrid){if(t.scrollModes.indexOf(t.dragStartObject.context)!==-1&&!d)return t.scrollMode=t.dragStartObject.context,t.scrollStartMode=t.dragStartObject.context,t.scrollGrid(l),t.attributes.scrollPointerLock&&["horizontal-scroll-box","vertical-scroll-box"].indexOf(t.scrollStartMode)!==-1&&(t.pointerLockPosition={x:t.dragStart.x,y:t.dragStart.y},t.canvas.requestPointerLock()),window.addEventListener("mousemove",t.scrollGrid,!1),window.addEventListener("mouseup",t.stopScrollGrid,!1),void(t.ignoreNextClick=!0);if(t.dragMode!=="cell")return s?(t.movingSelectionHandle=!0,t.fillOverlay={handle:{x:t.dragStartObject.x+t.dragStartObject.width/2,y:t.dragStartObject.y+t.dragStartObject.height/2},snapTo:{x:-1,y:-1},selection:t.getSelectionBounds()},t.dispatchEvent("beginselectionhandlemove",{NativeEvent:l})?void 0:(window.addEventListener("mousemove",t.selectionHandleMove,!1),window.addEventListener("mouseup",t.stopSelectionHandleMove,!1),t.selectionHandleMove(l))):o?(t.draggingItem=t.dragItem,t.movingSelection=t.cloneSelections(),t.dragging=t.dragStartObject,t.dispatchEvent("beginmove",{NativeEvent:l,cell:t.currentCell})?void 0:(window.addEventListener("mousemove",t.dragMove,!1),window.addEventListener("mouseup",t.stopDragMove,!1),t.mousemove(l))):n?(t.draggingItem=t.dragItem,t.startFreezeMove={x:t.frozenRow,y:t.frozenColumn},t.dispatchEvent("beginfreezemove",{NativeEvent:l})?void 0:(t.freezeMarkerPosition=t.getLayerPos(l),t.freezeMarkerPosition.isGrab=!0,window.addEventListener("mousemove",t.freezeMove,!1),window.addEventListener("mouseup",t.stopFreezeMove,!1),t.mousemove(l))):i&&!d?(t.draggingItem=t.dragItem,t.draggingItem.rowOpen?t.resizingStartingHeight=t.sizes.trees[t.draggingItem.rowIndex]:t.resizingStartingHeight=t.sizes.rows[t.draggingItem.rowIndex]||t.style.cellHeight,t.resizingStartingWidth=t.sizes.columns[t.draggingItem.header.style==="rowHeaderCell"?"cornerCell":t.draggingItem.sortColumnIndex]||t.draggingItem.width,window.addEventListener("mousemove",t.dragResizeColumn,!1),void window.addEventListener("mouseup",t.stopDragResize,!1)):["row-reorder","column-reorder"].indexOf(t.dragMode)!==-1?(t.draggingItem=t.dragStartObject,t.dragMode!=="column-reorder"||t.isMultiColumnsSelected?t.dragMode!=="row-reorder"||t.isMultiRowsSelected||t.selectRow(t.dragStartObject.rowIndex,e,null):t.selectColumn(t.currentCell.header.index,e,l.shiftKey),window.addEventListener("mousemove",t.dragReorder,!1),void window.addEventListener("mouseup",t.stopDragReorder,!1)):void 0;if(t.selecting=!0,(t.attributes.selectionMode==="row"||t.dragStartObject.columnIndex===-1)&&t.dragStartObject.rowIndex>-1)t.selectRow(t.dragStartObject.rowIndex,e,null);else if((t.attributes.selectionMode==="column"||t.dragStartObject.rowIndex===-1)&&t.dragStartObject.columnIndex>-1)return void t.selectColumn(t.currentCell.header.index,e,l.shiftKey);t.attributes.selectionMode!=="row"&&t.mousemove(l)}}},t.mouseup=function(l){clearTimeout(t.scrollTimer),t.cellBoundaryCrossed=!0,t.rowBoundaryCrossed=!0,t.columnBoundaryCrossed=!0,t.selecting=void 0,t.draggingItem=void 0,t.dragStartObject=void 0,t.dispatchEvent("mouseup",{NativeEvent:l,cell:t.currentCell})||(t.hasFocus||l.target===t.canvas)&&(t.currentCell&&t.currentCell.grid!==void 0||t.contextMenu||t.input||(t.dragStart&&t.isInGrid(t.dragStart)&&t.controlInput.focus(),l.preventDefault()))},t.getAdjacentCells=function(){var l,r=t.getSchema(),e={};for(l=0;l<r.length;l+=1)r[t.orders.columns[l]].hidden||(e.first===void 0&&(e.first=l,e.left=l),e.last=l,l>t.activeCell.columnIndex&&e.right===void 0&&(e.right=l),l<t.activeCell.columnIndex&&(e.left=l));return e.right===void 0&&(e.right=e.last),e},t.keydown=function(l){var r=t.getAdjacentCells(),e=Math.max(t.activeCell.columnIndex,0),o=Math.max(t.activeCell.rowIndex,0),n=l.ctrlKey||l.metaKey,i=t.viewData.length-1,s=t.getSchema().length-1;if(!t.dispatchEvent("keydown",{NativeEvent:l,cell:t.currentCell})&&(t.attributes.keepFocusOnMouseOut||t.hasFocus)){if(isPrintableKeyEvent(l)&&!n)return t.beginEditAt(e,o,l,!0);if(t.attributes.showNewRow&&(i+=1),l.key==="Tab"&&l.preventDefault(),l.key==="Escape"?t.selectNone():n&&l.key==="a"?t.selectAll():["Backspace","Delete"].includes(l.key)?t.deleteSelectedData():l.key==="ArrowDown"?o+=1:l.key==="ArrowUp"?o-=1:l.key==="ArrowLeft"&&!n||l.shiftKey&&l.key==="Tab"?e=r.left:l.key==="ArrowRight"&&!n||!l.shiftKey&&l.key==="Tab"?e=r.right:l.key==="PageUp"?(o-=t.page,l.preventDefault()):l.key==="PageDown"?(o+=t.page,l.preventDefault()):l.key==="Home"||n&&l.key==="ArrowUp"?o=0:l.key==="End"||n&&l.key==="ArrowDown"?o=t.viewData.length-1:n&&l.key==="ArrowRight"?e=r.last:n&&l.key==="ArrowLeft"&&(e=r.first),l.key==="Enter")return l.preventDefault(),t.beginEditAt(e,o,l);(e<0||Number.isNaN(e))&&(e=r.first),o>i&&(o=i),(o<0||Number.isNaN(o))&&(o=0),e>s&&(e=r.last);var d=["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(l.key);l.shiftKey&&d&&t.shrinkOrExpandSelections({rowIndex:o,columnIndex:e},l,!0)&&t.draw(!0),e===t.activeCell.columnIndex&&o===t.activeCell.rowIndex||(t.scrollIntoView(e!==t.activeCell.columnIndex?e:void 0,o===t.activeCell.rowIndex||Number.isNaN(o)?void 0:o),t.setActiveCell(e,o),!l.shiftKey&&t.attributes.selectionFollowsActiveCell&&(n||t.clearSelections(),t.selectCell({rowIndex:o,viewColumnIndex:e})),t.draw(!0))}},t.keyup=function(l){t.dispatchEvent("keyup",{NativeEvent:l,cell:t.currentCell})||t.hasFocus},t.keypress=function(l){t.hasFocus&&t.dispatchEvent("keypress",{NativeEvent:l,cell:t.currentCell})},t.dblclick=function(l){t.dispatchEvent("dblclick",{NativeEvent:l,cell:t.currentCell})||t.hasFocus&&(t.currentCell.context==="ew-resize"&&t.currentCell.style==="columnHeaderCell"?t.isColumnSelected(t.currentCell.columnIndex)?t.fitSelectedColumns():t.fitColumnToValues(t.currentCell.header.name):t.currentCell.context==="ew-resize"&&t.currentCell.style==="cornerCell"?t.autosize():!["cell","activeCell"].includes(t.currentCell.style)||t.hovers.onFilterButton||t.hovers.onCellTreeIcon||(t.currentCell.isRowTree||t.currentCell.isColumnTree?(t.cellTreeExpandCollapse(t.currentCell.rowIndex,t.currentCell.columnIndex),t.draw()):t.beginEditAt(t.currentCell.columnIndex,t.currentCell.rowIndex)))},t.scrollWheel=function(l){var r,e,o=l,n=l.deltaX===void 0?l.NativeEvent.deltaX:l.deltaX,i=l.deltaY===void 0?l.NativeEvent.deltaY:l.deltaY,s=l.deltaMode===void 0?l.NativeEvent.deltaMode:l.deltaMode;l.NativeEvent&&(l=l.NativeEvent),a?o.preventDefault(l):t.dispatchEvent("wheel",{NativeEvent:l})||(t.touchHaltAnimation=!0,r=t.scrollBox.scrollLeft,e=t.scrollBox.scrollTop,t.hasFocus&&(s===1&&(i*=17),(t.scrollBox.scrollTop<t.scrollBox.scrollHeight&&i>0||t.scrollBox.scrollLeft<t.scrollBox.scrollWidth&&n>0||t.scrollBox.scrollTop>0&&i<0||t.scrollBox.scrollLeft>0&&n<0)&&o.preventDefault(l),a=setTimeout(function(){a=void 0,t.scrollBox.scrollTo(n+r,i+e)},1)))},t.pasteData=function(l,r,e,o){var n=this,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(r==="text/html"&&!isSupportedHtml(l))return console.warn("Unrecognized HTML format. HTML must be a simple table, e.g.: <table><tr><td>data</td></tr></table>."),void console.warn("Data with the mime type text/html not in this format will not be imported as row data.");var d=parseData(l,r),c=d[0].length;if(d.length===1&&c===1&&i<=1&&s<=1){var p=d[0][0].value.map((function(u){return _newArrowCheck(this,n),u.value}).bind(this)).join();t.forEachSelectedCell(function(u,g,w){u[g][w]=p})}else{var h=null;i>d.length&&s>c?h="both":i>d.length?h="vertical":s>c&&(h="horizontal"),t.insert({rows:d,startRowIndex:e,startColumnIndex:o,minRowsLength:i,minColumnsLength:s,reverseRows:!1,reverseColumns:!1,clearSelections:!0,alwaysFilling:!1,direction:h})}var m=[];return t.forEachSelectedCell((function(u,g,w,R){_newArrowCheck(this,n),m.push([g,R.viewColumnIndex,R.boundRowIndex,R.boundColumnIndex])}).bind(this)),t.dispatchEvent("afterpaste",{cells:m}),d.length},t.insert=function(l){var r=this,e=l.rows,o=e===void 0?[]:e,n=l.startRowIndex,i=n===void 0?0:n,s=l.startColumnIndex,d=s===void 0?0:s,c=l.minRowsLength,p=c===void 0?0:c,h=l.minColumnsLength,m=h===void 0?0:h,u=l.reverseRows,g=u!==void 0&&u,w=l.reverseColumns,R=w!==void 0&&w,T=l.clearSelections,I=T!==void 0&&T,F=l.alwaysFilling,D=F!==void 0&&F,L=l.direction,f=L===void 0?"both":L,b=t.getSchema(),x=Math.max(o.length,p),P=t.fillCellCallback,A=[];I&&(t.selections=[]);for(var O=0,B=0;O<x;O++,B++){B>=o.length&&(B=0);for(var j=O>=o.length,V=g?x-O-1:O,J=t.orders.rows[i+V],Z=o[B],W=Math.max(Z.length,m),k=t.viewData[J],lt=Object.assign({},k),rt=P?{rows:o,direction:f,rowData:lt,existingRowData:k,rowIndex:J,rowOffset:B,cells:Z,reversed:f==="horizontal"?R:g,isFillingRow:j||D,fillingRowPosition:D?O:j?O-o.length:-1,fillingRowLength:D?x:j?x-o.length:-1}:void 0,at=0,ut=0;at<W;at++,ut++){ut>=Z.length&&(ut=0);var wt=at>=Z.length,ht=d+(R?W-at-1:at),Ot=b[t.orders.columns[ht]];if(Ot){var X=Ot.name,vt=Z[ut];vt&&vt.value&&(vt=vt.value.map((function(Bt){return _newArrowCheck(this,r),Bt.value}).bind(this)).join(""));var K=k[X];lt[X]=P&&(wt||j||D)?P(_objectSpread2(_objectSpread2({},rt),{},{column:Ot,columnIndex:ht,columnOffset:ut,newCellData:vt,existingCellData:K,isFillingColumn:wt||D,fillingColumnPosition:D?at:wt?at-Z.length:-1,fillingColumnLength:D?W:wt?W-Z.length:-1})):vt??K,t.selectCell({rowIndex:J,viewColumnIndex:ht},!0),(D||j||wt)&&A.push([J,ht,t.getBoundRowIndexFromViewRowIndex(J),t.getBoundColumnIndexFromViewColumnIndex(ht)])}else console.warn("Paste data exceeded grid bounds. Skipping.")}t.originalData[t.boundRowIndexMap.get(J)]=lt,t.viewData[J]=lt}(A.length>0||D)&&t.dispatchEvent("afterfill",{filledCells:A})},t.getNextVisibleColumnIndex=function(l){var r,e=t.getVisibleSchema();for(r=0;r<e.length;r+=1)if(e[r].columnIndex===l)return e[r+1].columnIndex;return-1},t.getVisibleColumnIndexOf=function(l){var r,e=t.getVisibleSchema();for(r=0;r<e.length;r+=1)if(e[r].columnIndex===l)return r;return-1},t.getSelectionIndex=function(){var l=t.getSelectionBounds(!0);if(l){for(var r=l.top,e=l.bottom,o=r;o<=e;o++){var n=t.getRowSelectionStates(o);if(n){if(n[0]===void 0)break;return{row:o,column:n[0]<0?n[1]:n[0],rowLength:e-o+1,columnLength:n.length-(n[0]<0?1:0)}}}return null}},t.paste=function(l){var r=this;if(t.attributes.editable&&!t.dispatchEvent("beforepaste",{NativeEvent:l})){var e=new Map(Array.from(l.clipboardData.items).map((function(c){return _newArrowCheck(this,r),[c.type,c]}).bind(this))),o=["text/html","text/csv","text/plain"],n=o.map((function(c){return _newArrowCheck(this,r),e.get(c)}).bind(this)).filter((function(c){return _newArrowCheck(this,r),!!c}).bind(this));if(n.length!==0){var i=t.getSelectionIndex();if(i){var s=n[0],d=s.type;s.getAsString(function(c){t.pasteData(c,d,i.row,i.column,i.rowLength,i.columnLength),t.draw()})}}else console.warn("Cannot find supported clipboard data type. Supported types are:",o.join(", "))}},t.cut=function(l){var r=this;if(!t.dispatchEvent("cut",{NativeEvent:l})&&t.hasFocus&&l.clipboardData){t.copySelectedCellsToClipboard(l.clipboardData);var e=t.clearSelectedCells().map((function(o){return _newArrowCheck(this,r),[o.viewRowIndex,o.viewColumnIndex,o.boundRowIndex,o.boundColumnIndex]}).bind(this));t.dispatchEvent("aftercut",{cells:e}),requestAnimationFrame((function(){return _newArrowCheck(this,r),t.draw()}).bind(this)),l.preventDefault()}},t.copy=function(l){t.dispatchEvent("copy",{NativeEvent:l})||t.hasFocus&&l.clipboardData&&(t.copySelectedCellsToClipboard(l.clipboardData),l.preventDefault())},t.selectionHandleMove=function(l){if(t.movingSelectionHandle){var r=t.getClippingRect(l),e=t.currentCell.rowIndex,o=t.currentCell.columnIndex,n=e>=-1&&o>=-1&&t.fillOverlay.selection.left<=o&&t.fillOverlay.selection.right>=o&&t.fillOverlay.selection.top<=e&&t.fillOverlay.selection.bottom>=e;if(t.fillOverlay.minX=r.x,t.fillOverlay.minY=r.y,t.fillOverlay.x=Math.max(r.x,l.clientX),t.fillOverlay.y=Math.max(r.y,l.clientY),n)t.fillOverlay.lastInBoundsLocation={x:l.clientX,y:l.clientY};else if(t.fillOverlay.lastInBoundsLocation||!t.fillOverlay.direction){var i=t.fillOverlay.lastInBoundsLocation;t.fillOverlay.lastInBoundsLocation=void 0;var s=i?i.x:t.fillOverlay.handle.x,d=i?i.y:t.fillOverlay.handle.y,c=Math.abs(l.clientX-s),p=Math.abs(l.clientY-d);(c>5||p>5)&&(t.fillOverlay.direction=c>p?"x":"y")}e>=0&&(t.fillOverlay.rowIndex=e),o>=0&&(t.fillOverlay.columnIndex=o,e===-1&&t.visibleRows.length&&(t.fillOverlay.rowIndex=t.visibleRows[0])),t.fillOverlay.snap=e>=-1&&o>=-1?t.currentCell:void 0}},t.stopSelectionHandleMove=function(l){if(!t.fillOverlay.handle)return!1;t.ignoreNextClick=!0,window.removeEventListener("mousemove",t.selectionHandleMove,!1),window.removeEventListener("mouseup",t.stopSelectionHandleMove,!1);var r=t.fillOverlay,e=t.getSelectionIndex(),o=r.selection;if(e){if(t.movingSelectionHandle=void 0,t.fillOverlay={},r.rowIndex>=0&&r.columnIndex>=0){var n,i,s,d,c=_objectSpread2({},o),p=r.direction==="y",h=r.direction==="x",m=!1,u=!1;if(p?(r.rowIndex<o.top?(o.top=r.rowIndex,m=!0):r.rowIndex>o.bottom&&(o.bottom=r.rowIndex),n=o.top<c.top?o.top:c.bottom+1,i=o.top<c.top?c.top-o.top:o.bottom-c.bottom,s=e.column,d=e.columnLength):h&&(r.columnIndex<o.left?(o.left=r.columnIndex,u=!0):r.columnIndex>o.right&&(o.right=r.columnIndex),s=o.left<c.left?o.left:c.right+1,d=o.left<c.left?c.left-o.left:o.right-c.right,n=e.row,i=e.rowLength),o.left<=o.right&&o.top<=o.bottom&&(o.left<c.left||o.top<c.top||o.right>c.right||o.bottom>c.bottom)){for(var g=t.getSchema(),w=[],R=0;R<Math.min(i,e.rowLength);R++){var T=t.viewData[e.row+R];w[R]=[];for(var I=0;I<Math.min(d,e.columnLength);I++){var F=g[e.column+I];if(F){var D=T[F.name];w[R][I]=D}}}t.insert({rows:w,startRowIndex:n,startColumnIndex:s,minRowsLength:i,minColumnsLength:d,reverseRows:m,reverseColumns:u,clearSelections:!1,alwaysFilling:!0,direction:h?"horizontal":"vertical"}),t.draw()}}return!0}}}function touch(t){var a,l;t.scrollAnimation={},t.touchDelta={},t.touchAnimateTo={},t.animationFrames=0,t.getTouchPos=function(r,e){var o,n=e?r.touches[e]:r.touches[0],i=t.canvas.getBoundingClientRect();if(n)return o={x:n.clientX-i.left,y:n.clientY-i.top},t.isChildGrid&&(o.x-=t.canvasOffsetLeft,o.y-=t.canvasOffsetTop),{x:o.x,y:o.y,rect:i}},t.easingFunctions={linear:function(r){return r},easeInQuad:function(r){return r*r},easeOutQuad:function(r){return r*(2-r)},easeInOutQuad:function(r){return r<.5?2*r*r:(4-2*r)*r-1},easeInCubic:function(r){return r*r*r},easeOutCubic:function(r){return--r*r*r+1},easeInOutCubic:function(r){return r<.5?4*r*r*r:(r-1)*(2*r-2)*(2*r-2)+1},easeInQuart:function(r){return r*r*r*r},easeOutQuart:function(r){return 1- --r*r*r*r},easeInOutQuart:function(r){return r<.5?8*r*r*r*r:1-8*--r*r*r*r},easeInQuint:function(r){return r*r*r*r*r},easeOutQuint:function(r){return 1+--r*r*r*r*r},easeInOutQuint:function(r){return r<.5?16*r*r*r*r*r:1+16*--r*r*r*r*r}},t.easing=function(r,e,o,n){return o*t.easingFunctions[t.attributes.touchEasingMethod](r/n)+e},t.calculatePPSTimed=function(){t.xPPST=-(t.touchDelta.x-t.touchSigmaTimed.x)/(t.touchDelta.t-t.touchSigmaTimed.t),t.yPPST=-(t.touchDelta.y-t.touchSigmaTimed.y)/(t.touchDelta.t-t.touchSigmaTimed.t),t.touchSigmaTimed={x:t.touchDelta.x,y:t.touchDelta.y,t:performance.now()}},t.calculatePPS=function(){t.xPPS=-(t.touchDelta.x-t.touchSigma.x)/(t.touchDelta.t-t.touchSigma.t),t.yPPS=-(t.touchDelta.y-t.touchSigma.y)/(t.touchDelta.t-t.touchSigma.t),t.touchSigma={x:t.touchDelta.x,y:t.touchDelta.y,t:performance.now()}},t.touchEndAnimation=function(){if(!t.canvas||!t.scrollBox.scrollTo)return requestAnimationFrame(t.touchEndAnimation);var r,e=performance.now(),o=t.attributes.touchReleaseAnimationDurationMs;r=e-t.touchDelta.t,t.animationFrames+=1,t.scrollAnimation.x=t.easing(r,t.touchDelta.scrollLeft,t.touchAnimateTo.x,o),t.scrollAnimation.y=t.easing(r,t.touchDelta.scrollTop,t.touchAnimateTo.y,o),r>o||t.scrollAnimation.y===t.scrollBox.scrollTop&&t.scrollAnimation.x===t.scrollBox.scrollLeft||t.stopAnimation||(t.scrollBox.scrollTo(t.scrollAnimation.x,t.scrollAnimation.y),requestAnimationFrame(t.touchEndAnimation))},t.touchEditCell=function(r){t.beginEditAt(r.columnIndex,r.rowIndex)},t.touchstart=function(r){if(r.changedTouches[0]&&(t.touchStart=t.getTouchPos(r),t.startingCell=t.getCellAt(t.touchStart.x,t.touchStart.y,!0)),!t.dispatchEvent("touchstart",{NativeEvent:r,cell:t.startingCell})){if(t.disposeContextMenu(),clearInterval(t.calculatePPSTimer),clearTimeout(t.touchContextTimeout),t.touchStartEvent=r,t.stopAnimation=!0,t.animationFrames=0,t.stopPropagation(r),r.touches.length===1&&r.changedTouches[0]&&!t.zoomAltered){if(t.touchLength=1,t.touchStart=t.touchStart||t.touchStart1,t.touchScrollStart={x:t.scrollBox.scrollLeft,y:t.scrollBox.scrollTop,t:performance.now()},t.touchDelta={x:0,y:0,scrollLeft:t.scrollBox.scrollLeft,scrollTop:t.scrollBox.scrollTop,t:t.touchScrollStart.t},t.touchSigma={x:t.touchDelta.x,y:t.touchDelta.y,t:t.touchDelta.t},t.touchSigmaTimed={x:t.touchDelta.x,y:t.touchDelta.y,t:t.touchDelta.t},t.touchContextTimeout=setTimeout(function(){t.contextmenuEvent(r,t.touchStart)},t.attributes.touchContextMenuTimeMs),t.calculatePPSTimer=setInterval(t.calculatePPSTimed,50),t.startingCell&&(t.startingCell.isGrid||["tree","inherit"].indexOf(t.startingCell.context)!==-1))return void(t.hasFocus=!1);if(t.hasFocus=!0,t.startingCell.isHeader)return t.startingCell.isRowHeader?(t.selectArea({top:t.startingCell.rowIndex,bottom:t.startingCell.rowIndex,left:0,right:t.getVisibleSchema().length-1}),t.draw(!0)):t.startingCell.isColumnHeader&&(t.attributes.columnHeaderClickBehavior==="sort"&&(t.orderBy===t.startingCell.header.name?t.orderDirection=t.orderDirection==="asc"?"desc":"asc":t.orderDirection="asc",t.order(t.startingCell.header.name,t.orderDirection)),t.attributes.columnHeaderClickBehavior==="select"&&(t.selectArea({top:0,bottom:t.viewData.length-1,left:t.startingCell.columnIndex,right:t.startingCell.columnIndex}),t.draw(!0))),void t.touchEndEvents(r)}t.zoomAltered||(document.body.addEventListener("touchmove",t.touchmove,{passive:!1}),document.body.addEventListener("touchend",t.touchend,!1),document.body.addEventListener("touchcancel",t.touchcancel,!1),t.draw(!0))}},t.touchSelect=function(r,e){if(r.rowIndex!==void 0&&r.columnIndex!==void 0){t.touchSelecting=!0;var o=t.getSelectionBounds();e==="selection-handle-bl"&&r.rowIndex>=o.top&&r.columnIndex<=o.right?(o.bottom=r.rowIndex,o.left=r.columnIndex):e==="selection-handle-tl"&&r.rowIndex<=o.bottom&&r.columnIndex<=o.right?(o.top=r.rowIndex,o.left=r.columnIndex):e==="selection-handle-tr"&&r.rowIndex<=o.bottom&&r.columnIndex>=o.left?(o.top=r.rowIndex,o.right=r.columnIndex):e==="selection-handle-br"&&r.rowIndex>=o.top&&r.columnIndex>=o.left&&(o.bottom=r.rowIndex,o.right=r.columnIndex),t.attributes.selectionMode==="row"||r.rowIndex===-1?(o.left=0,o.right=t.getSchema().length-1):o.left=Math.max(0,o.left),t.selectArea(o),t.draw(!0)}},t.touchmove=function(r){a||requestAnimationFrame(function(){a=!0,function(e){var o,n,i,s,d,c,p,h,m;if(!t.dispatchEvent("beforetouchmove",{NativeEvent:e})){if(clearTimeout(l),e.changedTouches[0]&&(t.touchPosition=t.getTouchPos(e)),e.changedTouches[1]&&(t.touchPosition1=t.getTouchPos(e,1)),Math.abs(t.touchDelta.x)+Math.abs(t.touchDelta.y)>t.attributes.touchDeadZone&&clearTimeout(t.touchContextTimeout),e.touches.length===2&&t.touchPosition&&t.touchPosition1)return h=t.touchPosition.y,m=t.touchPosition1.y,t.zoomDeltaStart||(t.zoomDeltaStart=Math.abs(h-m),t.startScale=t.scale),t.touchLength=2,t.scaleDelta=t.zoomDeltaStart-Math.abs(h-m),t.scale=t.startScale-t.scaleDelta*t.attributes.touchZoomSensitivity,t.scale=Math.min(Math.max(t.scale,t.attributes.touchZoomMin),t.attributes.touchZoomMax),t.zoomAltered=!0,t.resize(!0),void t.resizeChildGrids();t.zoomAltered||(t.touchLength=1,t.touchPosition=t.touchPosition||t.touchPosition1,o=t.getColumnHeaderCellHeight(),n=t.getRowHeaderCellWidth(),i=t.width-t.style.scrollBarWidth-t.touchPosition.x<t.attributes.selectionScrollZone,s=t.touchPosition.x-n<t.attributes.selectionScrollZone,d=t.height-t.style.scrollBarWidth-t.touchPosition.y<t.attributes.selectionScrollZone,c=t.touchPosition.y-o<t.attributes.selectionScrollZone,p=t.style.scrollBarWidth,e.stopPropagation(),t.touchDelta={x:t.touchPosition.x-t.touchStart.x,y:t.touchPosition.y-t.touchStart.y,scrollLeft:t.scrollBox.scrollLeft,scrollTop:t.scrollBox.scrollTop,t:performance.now()},t.currentCell=t.getCellAt(t.touchPosition.x,t.touchPosition.y),t.dispatchEvent("touchmove",{NativeEvent:e,cell:t.currentCell}),t.calculatePPS(),t.touchDuration=performance.now()-t.touchScrollStart.t,t.stopAnimation=!0,t.animationFrames=0,t.touchSelecting&&(i||s||c||d)&&function u(){var g=t.scrollBox.scrollLeft,w=t.scrollBox.scrollTop;g+=i?t.attributes.selectionScrollIncrement:0,w+=d?t.attributes.selectionScrollIncrement:0,w-=c?t.attributes.selectionScrollIncrement:0,g-=s?t.attributes.selectionScrollIncrement:0,t.scrollBox.scrollTo(g,w),l=setTimeout(u,t.attributes.scrollRepeatRate)}(),/vertical-scroll-/.test(t.startingCell.style)?t.scrollBox.scrollTop=t.scrollBox.scrollHeight*((t.touchPosition.y-o-p)/(t.scrollBox.height-p-o)):/horizontal-scroll-/.test(t.startingCell.style)?t.scrollBox.scrollLeft=t.scrollBox.scrollWidth*((t.touchPosition.x-n-p)/(t.scrollBox.width-p-n)):/selection-handle-/.test(t.startingCell.style)?t.touchSelect(t.currentCell,t.startingCell.style):t.scrollBox.scrollTo(t.touchScrollStart.x-t.touchDelta.x,t.touchScrollStart.y-t.touchDelta.y))}}(r),a=!1})},t.touchEndEvents=function(r){t.zoomDeltaStart=void 0,t.touchSelecting=!1,clearInterval(t.touchScrollTimeout),clearInterval(t.touchContextTimeout),clearInterval(t.calculatePPSTimer),r.stopPropagation(),document.body.removeEventListener("touchmove",t.touchmove,{passive:!1}),document.body.removeEventListener("touchend",t.touchend,!1),document.body.removeEventListener("touchcancel",t.touchcancel,!1)},t.touchend=function(r){if(!t.dispatchEvent("touchend",{NativeEvent:r,cell:t.currentCell}))if(t.zoomDeltaStart=void 0,r.changedTouches[0]&&(t.touchPosition=void 0),r.changedTouches[1]&&(t.touchPosition1=void 0),t.zoomAltered)r.touches.length===0&&(t.zoomAltered=!1);else{var e=Math.abs(t.touchDelta.x)+Math.abs(t.touchDelta.y)<t.attributes.touchDeadZone;isNaN(t.xPPS)&&(t.xPPS=0),isNaN(t.yPPS)&&(t.yPPS=0),isNaN(t.xPPST)&&(t.xPPST=0),isNaN(t.yPPST)&&(t.yPPST=0),t.touchAnimateTo.x=t.xPPS*t.attributes.touchReleaseAcceleration,t.touchAnimateTo.y=t.yPPS*t.attributes.touchReleaseAcceleration,t.calculatePPSTimed(),e||t.animationFrames!==0||!(Math.abs(t.xPPST)>t.attributes.scrollAnimationPPSThreshold||Math.abs(t.yPPST)>t.attributes.scrollAnimationPPSThreshold)||/-scroll-/.test(t.startingCell.style)||e||(t.stopAnimation=!1,t.touchEndAnimation()),t.touchEndEvents(r)}},t.touchcancel=function(r){t.dispatchEvent("touchcancel",{NativeEvent:r,cell:t.currentCell})||t.touchEndEvents(r)}}function intf(t,a){function l(e,o){var n,i=[];for(n=e;n<=o;n+=1)i[n]=n;return i}var r;t.scale=1,t.orders={rows:[],columns:[]},t.appliedInlineStyles={},t.cellGridAttributes={},t.treeGridAttributes={},t.visibleRowHeights=[],t.hasFocus=!1,t.activeCell={columnIndex:0,rowIndex:0},t.innerHTML="",t.storageName="canvasDataGrid",t.invalidSearchExpClass="canvas-datagrid-invalid-search-regExp",t.localStyleLibraryStorageKey="canvas-datagrid-user-style-library",t.dataType="application/x-canvas-datagrid",t.orderBy=null,t.orderDirection="asc",t.orderings={columns:[],add:function(e,o,n){t.orderings.columns=t.orderings.columns.filter(function(i){return i.orderBy!==e}),t.orderings.columns.push({orderBy:e,orderDirection:o,sortFunction:n})},sort:function(){console.warn("grid.orderings.sort has been deprecated. Please use grid.refresh()."),t.orderings.columns.forEach(function(e){t.viewData.sort(e.sortFunction(e.orderBy,e.orderDirection))})}},t.columnFilters={},t.filters={},t.frozenRow=0,t.frozenColumn=0,t.ellipsisCache={},t.scrollCache={x:[],y:[]},t.scrollBox={},t.visibleRows=[],t.visibleCells=[],t.visibleUnhideIndicators=[],t.hiddenRowRanges=[],t.visibleGroups=[],t.sizes={rows:{},columns:{},trees:{}},t.fillOverlay={},t.filterable={rows:[],columns:[]},t.selectedFilterButton={columnIndex:-1,rowIndex:-1},t.cellTree={rows:[],columns:{},tempSchema:{},rowTreeColIndex:0,columnTreeRowStartIndex:0,columnTreeRowEndIndex:0,origin:{rows:[],columns:{}}},t.hovers={},t.attributes={},t.style={},t.formatters={},t.sorters={},t.parsers={},t.schemaHashes={},t.events={},t.changes=[],t.scrollIndexTop=0,t.scrollPixelTop=0,t.scrollIndexLeft=0,t.scrollPixelLeft=0,t.childGrids={},t.openChildren={},t.groupedColumns=[],t.groupedRows=[],t.scrollModes=["vertical-scroll-box","vertical-scroll-top","vertical-scroll-bottom","horizontal-scroll-box","horizontal-scroll-right","horizontal-scroll-left"],t.componentL1Events={},t.eventNames=["afterdraw","afterrendercell","afterrenderfilterbutton","aftercreategroup","attributechanged","beforebeginedit","beforecreatecellgrid","beforedraw","beforeendedit","beforerendercell","beforerendercellgrid","beforerenderfilterbutton","beginedit","cellmouseout","cellmouseover","click","collapsetree","columnhide","columnunhide","contextmenu","copy","datachanged","dblclick","endedit","expandtree","formatcellvalue","keydown","keypress","keyup","mousedown","mousemove","mouseup","newrow","ordercolumn","rendercell","rendercellgrid","renderorderbyarrow","rendertext","rendertreearrow","reorder","reordering","resize","resizecolumn","resizerow","schemachanged","scroll","selectionchanged","stylechanged","touchcancel","touchend","touchmove","touchstart","wheel"],t.mouse={x:0,y:0},t.getBoundRowIndexFromViewRowIndex=function(e){if(t.boundRowIndexMap&&t.boundRowIndexMap.has(e))return t.boundRowIndexMap.get(e)},t.getBoundColumnIndexFromViewColumnIndex=function(e){return t.orders.columns[e]},t.getColumnGroupAreaHeight=function(){if(!t.attributes.allowGroupingColumns)return 0;var e=t.groupedColumns.length;return t.style.columnGroupRowHeight*t.scale*e},t.getRowGroupAreaWidth=function(){if(!t.attributes.allowGroupingRows)return 0;var e=t.groupedRows.length;return t.style.rowGroupColumnWidth*t.scale*e},t.getCollapsedColumnGroups=function(){for(var e=[],o=0;o<t.groupedColumns.length;o++)for(var n=t.groupedColumns[o],i=0;i<n.length;i++){var s=n[i];s.collapsed&&e.push(s)}return e},t.getCollapsedRowGroups=function(){for(var e=[],o=0;o<t.groupedRows.length;o++)for(var n=t.groupedRows[o],i=0;i<n.length;i++){var s=n[i];s.collapsed&&e.push(s)}return e},t.toggleGroup=function(e){if(e.type==="c"){for(var o,n=e.from,i=e.to,s=t.groupedColumns,d=0;d<s.length;d++){for(var c=s[d],p=0;p<c.length;p++){var h=c[p];if(h.from===n&&h.to===i){o=h;break}}if(o)break}if(!o)return;var m=!o.collapsed;return o.collapsed=m,!0}if(e.type==="r"){for(var u,g=e.from,w=e.to,R=t.groupedRows,T=0;T<R.length;T++){for(var I=R[T],F=0;F<I.length;F++){var D=I[F];if(D.from===g&&D.to===w){u=D;break}}if(u)break}if(!u)return;var L=!u.collapsed;return u.collapsed=L,!0}return!1},t.isNewGroupRangeValid=function(e,o,n){for(var i=0;i<e.length;i++)for(var s=e[i],d=0;d<s.length;d++){var c=s[d];if(o===c.to+1)return!1;if(!(o>c.to)){if(o===c.from){if(n===c.to)return!1;if(n>c.to)return!0;break}if(o>c.from){if(n>c.to)return!1;break}return!(n<c.to)}}return!0},t.getColumnHeaderCellHeight=function(){return t.attributes.showColumnHeaders?(t.sizes.rows[-1]||t.style.columnHeaderCellHeight)*t.scale:0},t.getRowHeaderCellWidth=function(){return t.attributes.showRowHeaders?(t.sizes.columns[-1]||t.style.rowHeaderCellWidth)*t.scale:0},t.setStorageData=function(){if(t.attributes.saveAppearance&&t.attributes.name){var e={};t.getSchema().forEach(function(o){e[o.name]=!o.hidden}),localStorage.setItem(t.storageName+"-"+t.attributes.name,JSON.stringify({sizes:{rows:t.sizes.rows,columns:t.sizes.columns},orders:{rows:t.orders.rows,columns:t.orders.columns},orderBy:t.orderBy,orderDirection:t.orderDirection,visibility:e}))}},t.getSchema=function(){return t.schema||t.tempSchema||[]},t.createColumnOrders=function(){var e=t.getSchema();t.orders.columns=l(0,e.length-1)},t.createRowOrders=function(){t.orders.rows=l(0,t.originalData.length-1)},t.getVisibleSchema=function(){return t.getSchema().filter(function(e){return!e.hidden})},t.applyDefaultValue=function(e,o,n){var i=o.defaultValue||"";typeof i=="function"&&(i=i.apply(t.intf,[o,n])),e[o.name]=i},t.createNewRowData=function(){t.newRow={},t.getSchema().forEach(function(e){t.applyDefaultValue(t.newRow,e,void 0)})},t.getSchemaNameHash=function(e){for(var o=0;t.schemaHashes[e];)e+=o+=1;return e},t.filter=function(e){var o=t.filters[e];return o||e===void 0||(console.warn("Cannot find filter for type %s, falling back to substring match.",e),o=t.filters.string),o},t.hasActiveFilters=function(){return t.columnFilters&&Object.keys(t.columnFilters).length>0},t.hasCollapsedRowGroup=function(){for(var e=0;e<t.groupedRows.length;e++)for(var o=t.groupedRows[e],n=0;n<o.length;n++)if(o[n].collapsed)return!0;return!1},t.getFilteredAndSortedViewData=function(e){var o=this,n=e.map((function(W,k){return _newArrowCheck(this,o),[W,k]}).bind(this));if(t.hiddenRowRanges.length>0)for(var i=t.hiddenRowRanges.sort((function(W,k){return _newArrowCheck(this,o),k[1]-W[1]}).bind(this)),s=0;s<i.length;s++){var d=_slicedToArray(i[s],2),c=d[0],p=d[1]-c+1;n.splice(c,p)}for(var h=function(){var W=_slicedToArray(u[m],2),k=W[0],lt=W[1],rt=t.getHeaderByName(k);if(!rt)return"continue";var at=rt.filter||t.filter(rt.type||"string");n=n.filter(function(ut){var wt=_slicedToArray(ut,2),ht=wt[0],Ot=wt[1];return!!(t.attributes.allowFreezingRows&&!t.attributes.filterFrozenRows&&Ot<t.frozenRow)||at(ht[k],lt)})},m=0,u=Object.entries(t.columnFilters);m<u.length;m++)h();for(var g=[],w=0;w<t.groupedRows.length;w++)for(var R=t.groupedRows[w],T=0;T<R.length;T++){var I=R[T];I.collapsed&&g.push([I.from,I.to])}if(g.length>0){g.sort((function(W,k){return _newArrowCheck(this,o),W[0]-k[0]}).bind(this));for(var F=0,D=g.length,L=0;L<D;L++){var f=g[L];if(L===D-1){g[F++]=f;break}var b=f[1],x=_slicedToArray(g[L+1],2),P=x[0],A=x[1];P>b+1?g[F++]=f:(g[L+1]=f,A>b&&(g[L+1][1]=A))}for(var O=(g=g.slice(0,F)).shift(),B=0;B<n.length;B++)if(!(n[B][1]<O[0])){for(var j=B+1;j<n.length&&!(n[j][1]>O[1]);j++);if(n.splice(B,j-B),!(O=g.shift()))break;B--}}var V,J=_createForOfIteratorHelper(t.orderings.columns);try{var Z=function(){var W=this,k=V.value,lt=k.sortFunction(k.orderBy,k.orderDirection);n.sort((function(rt,at){_newArrowCheck(this,W);var ut=_slicedToArray(rt,1)[0],wt=_slicedToArray(at,2),ht=wt[0],Ot=wt[1];return t.attributes.allowFreezingRows&&!t.attributes.sortFrozenRows&&Ot<t.frozenRow?0:lt(ut,ht)}).bind(this))};for(J.s();!(V=J.n()).done;)Z()}catch(W){J.e(W)}finally{J.f()}return{viewData:n.map((function(W){return _newArrowCheck(this,o),_slicedToArray(W,1)[0]}).bind(this)),boundRowIndexMap:new Map(n.map((function(W,k){_newArrowCheck(this,o);var lt=_slicedToArray(W,2);return lt[0],[k,lt[1]]}).bind(this)))}},t.refresh=function(){var e=t.getFilteredAndSortedViewData(t.originalData),o=e.viewData,n=e.boundRowIndexMap;t.viewData=o,t.boundRowIndexMap=n,t.resize(),t.draw(!0)},t.getBestGuessDataType=function(e,o){var n,i,s=o.length;for(i=0;i<s;i+=1)if(o[i]!==void 0&&o[i]!==null&&[null,void 0].indexOf(o[i][e])!==-1)return(n=_typeof(o[i]))==="object"?"string":n;return"string"},t.drawChildGrids=function(){Object.keys(t.childGrids).forEach(function(e){t.childGrids[e].draw()})},t.resizeChildGrids=function(){Object.keys(t.childGrids).forEach(function(e){t.childGrids[e].resize()})},t.autoScrollZone=function(e,o,n,i){var s,d=t.getRowHeaderCellWidth(),c=t.getColumnHeaderCellHeight();o!==-1&&(o>t.width-t.attributes.selectionScrollZone&&(t.scrollBox.scrollLeft+=t.attributes.selectionScrollIncrement,s=!0),o-t.attributes.selectionScrollZone-d<0&&(t.scrollBox.scrollLeft-=t.attributes.selectionScrollIncrement,s=!0)),n!==-1&&(n>t.height-t.attributes.selectionScrollZone&&(t.scrollBox.scrollTop+=t.attributes.selectionScrollIncrement,s=!0),n-t.attributes.selectionScrollZone-c<0&&(t.scrollBox.scrollTop-=t.attributes.selectionScrollIncrement,s=!0)),s&&!i&&t.currentCell&&t.currentCell.columnIndex!==-1&&(t.scrollTimer=setTimeout(t.mousemove,t.attributes.scrollRepeatRate,e))},t.validateColumn=function(e,o){if(!e.name)throw new Error("A column must contain at least a name.");if(o.filter(function(n){return n.name===e.name}).length>0)throw new Error("A column with the name "+e.name+" already exists and cannot be added again.");return!0},t.setDefaults=function(e,o,n,i){e[n]=o[n]===void 0?i:o[n]},t.setAttributes=function(){t.defaults.attributes.forEach(function(e){t.setDefaults(t.attributes,t.args,e[0],e[1])})},t.setStyle=function(){t.defaults.styles.forEach(function(e){t.setDefaults(t.style,t.args.style||{},e[0],e[1])})},t.autosize=function(e){t.getVisibleSchema().forEach(function(o,n){o.name!==e&&e!==void 0||(t.sizes.columns[n]=Math.max(t.findColumnMaxTextLength(o.name),t.style.minColumnWidth))}),t.sizes.columns[-1]=t.findColumnMaxTextLength("cornerCell")},t.dispose=function(){!t.isChildGrid&&t.canvas&&t.canvas.parentNode&&t.canvas.parentNode.removeChild(t.canvas),t.isChildGrid||document.body.removeChild(t.controlInput),t.eventParent.removeEventListener("mousedown",t.mousedown,!1),t.eventParent.removeEventListener("dblclick",t.dblclick,!1),t.eventParent.removeEventListener("click",t.click,!1),t.eventParent.removeEventListener("mousemove",t.mousemove),t.eventParent.removeEventListener("wheel",t.scrollWheel,!1),t.canvas.removeEventListener("contextmenu",t.contextmenuEvent,!1),t.canvas.removeEventListener("copy",t.copy),t.controlInput.removeEventListener("copy",t.copy),t.controlInput.removeEventListener("cut",t.cut),t.controlInput.removeEventListener("paste",t.paste),t.controlInput.removeEventListener("keypress",t.keypress,!1),t.controlInput.removeEventListener("keyup",t.keyup,!1),t.controlInput.removeEventListener("keydown",t.keydown,!1),window.removeEventListener("mouseup",t.mouseup,!1),window.removeEventListener("mousemove",t.mousemove),window.removeEventListener("resize",t.resize),t.observer&&t.observer.disconnect&&t.observer.disconnect()},t.tryLoadStoredSettings=function(){var e;t.reloadStoredValues(),t.storedSettings&&_typeof(t.storedSettings.orders)==="object"&&t.storedSettings.orders!==null&&(t.storedSettings.orders.rows.length>=(t.viewData||[]).length&&(t.orders.rows=t.storedSettings.orders.rows),e=t.getSchema(),t.storedSettings.orders.columns.length===e.length&&(t.orders.columns=t.storedSettings.orders.columns),t.orderBy=t.storedSettings.orderBy===void 0?e[0].name:t.storedSettings.orderBy,t.orderDirection=t.storedSettings.orderDirection===void 0?"asc":t.storedSettings.orderDirection,t.storedSettings.orderBy!==void 0&&t.getHeaderByName(t.orderBy)&&t.orderDirection&&t.order(t.orderBy,t.orderDirection))},t.toggleCollapseTree=function(e,o,n){var i=this,s=[],d=0;if(o==t.cellTree.rowTreeColIndex&&(e>0||e==0&&t.cellTree.rows[0].icon)){var c=t.cellTree.rows;switch(n){case"Expand":c[e].expand=!0,t.cellTree.origin.rows[c[e].index].expand=!0;break;case"Collapse":c[e].expand=!1,t.cellTree.origin.rows[c[e].index].expand=!1;break;default:c[e].expand=!c[e].expand,t.cellTree.origin.rows[c[e].index].expand=c[e].expand}for(var p=c[e].index+1;p<=c[e].lastchild;p++){var h=t.cellTree.origin.rows[p];c[e].expand?(h.hide=!1,h.icon&&!h.expand&&(p=h.lastchild)):h.hide=!0}}else if(t.cellTree.columns[e]){var m=t.cellTree.columns[e];switch(n){case"Expand":m[o].expand=!0;break;case"Collapse":m[o].expand=!1;break;default:m[o].expand=!m[o].expand}for(var u=m[o].index+1;u<=m[o].lastchild;u++)m[o].expand?t.cellTree.tempSchema[u].hidden=!1:t.cellTree.tempSchema[u].hidden=!0;var g,w=0;if(m[o].expand)for(;w<m[o].child;){g=e+w+1;for(var R=m[o].index;R<=m[o].lastchild;R++)if(t.cellTree.origin.columns[g]&&t.cellTree.origin.columns[g][R].icon&&!t.cellTree.origin.columns[g][R].expand)for(var T=R+1;T<=t.cellTree.origin.columns[g][R].lastchild;T++)t.cellTree.tempSchema[T].hidden=!0;w++}}var I,F={},D=[];for(var L in t.cellTree.rows=[],t.cellTree.columns={},t.cellTree.origin.rows){var f=[],b=t.cellTree.origin.rows[L];if(b.hide){for(var x=0;x<t.cellTree.rowTreeColIndex;x++)f.push(t.viewData[L][x]);F[L]=f,D.push(Array(t.viewData[0].length).fill("")),d++}else{var P=[],A=0;if(L<t.cellTree.columnTreeRowStartIndex)s.push(t.originalData[L]);else if(L>t.cellTree.columnTreeRowEndIndex)F[L]=t.viewData[L],d++;else{for(var O=0;O<t.originalData[L].length;O++)t.cellTree.tempSchema[O].hidden?A++:(O<t.cellTree.rowTreeColIndex&&(Object.prototype.hasOwnProperty.call(F,L)||(F[L]=[]),F[L].push(t.viewData[L][O])),f.push(t.originalData[L][O]),Object.prototype.hasOwnProperty.call(t.cellTree.origin.columns,L)&&P.push(t.cellTree.origin.columns[L][O]));f.push.apply(f,_toConsumableArray(Array(A).fill(""))),P.length&&(P.push.apply(P,_toConsumableArray(Array(A).fill().map((function(){return _newArrowCheck(this,i),{}}).bind(this)))),t.cellTree.columns[L]=P),s.push(f)}t.cellTree.rows.push(b)}}d&&((I=t.cellTree.rows).push.apply(I,_toConsumableArray(Array(d).fill().map((function(V,J){return _newArrowCheck(this,i),{index:t.cellTree.rows.length+J}}).bind(this)))),s.push.apply(s,D));for(var B in F)if(B>t.cellTree.columnTreeRowEndIndex)s[B]=F[B];else for(var j in F[B])s[B][j]=F[B][j];t.viewData=s},t.cellTreeExpandCollapse=function(e,o,n){if(o==t.cellTree.rowTreeColIndex&&(e>0||e==0&&t.cellTree.rows[0].icon)){var i=t.cellTree.rows;switch(n){case"Expand":i[e].expand=!0;break;case"Collapse":i[e].expand=!1;break;default:i[e].expand=!i[e].expand}for(var s=e+1;s<=i[e].lastchild;s++)i[e].expand?(i[s].hide=!1,i[s].icon&&!i[s].expand&&(s=i[s].lastchild)):i[s].hide=!0}else if(t.cellTree.columns[e]){var d=t.cellTree.columns[e];switch(n){case"Expand":d[o].expand=!0;break;case"Collapse":d[o].expand=!1;break;default:d[o].expand=!d[o].expand}for(var c=o+1;c<=d[o].lastchild;c++)d[o].expand?t.tempSchema[c].hidden=!1:t.tempSchema[c].hidden=!0;var p,h=0;if(d[o].expand)for(;h<d[o].child;){p=e+h+1;for(var m=o;m<=d[o].lastchild;m++)if(t.cellTree.columns[p]&&t.cellTree.columns[p][m].icon&&!t.cellTree.columns[p][m].expand)for(var u=m+1;u<=t.cellTree.columns[p][m].lastchild;u++)t.tempSchema[u].hidden=!0;h++}}},t.initCellTreeSettings=function(){var e=this;if(t.viewData!==void 0){if(t.attributes.rowTree.length>0&&t.viewData.length>0){t.cellTree.rows=Array(t.viewData.length).fill().map((function(R,T){return _newArrowCheck(this,e),{index:T}}).bind(this)),t.cellTree.rowTreeColIndex=t.attributes.rowTreeColIndex;var o,n=!1,i=_createForOfIteratorHelper(t.attributes.rowTree);try{for(i.s();!(o=i.n()).done;){var s=o.value;if(t.cellTree.rows.length<=s.end){n=!0;break}for(var d=s.begin;d<=s.end;d++)d==s.begin?(t.cellTree.rows[d].icon=!0,t.cellTree.rows[d].lastchild=s.end,t.cellTree.rows[d].expand=!0,t.cellTree.rows[d].parentCount||(t.cellTree.rows[d].parentCount=0)):(t.cellTree.rows[d].hide=!1,t.cellTree.rows[d].parentIndex=s.begin,t.cellTree.rows[d]&&t.cellTree.rows[d].parentCount?t.cellTree.rows[d].parentCount+=1:t.cellTree.rows[d].parentCount=1)}}catch(R){i.e(R)}finally{i.f()}n&&(t.cellTree.rows={})}if(t.attributes.columnTree.length>0&&t.viewData.length>0){t.cellTree.columnTreeRowStartIndex=t.attributes.columnTreeRowStartIndex,t.cellTree.columnTreeRowEndIndex=t.attributes.columnTreeRowEndIndex;var c,p=Object.keys(t.viewData[0]).length,h=!1,m=_createForOfIteratorHelper(t.attributes.columnTree);try{for(m.s();!(c=m.n()).done;){var u=c.value;if(p<=u.end){h=!0;break}t.cellTree.columns[u.row]||(t.cellTree.columns[u.row]=Array(p).fill().map((function(R,T){return _newArrowCheck(this,e),{index:T}}).bind(this)));for(var g=u.begin;g<=u.end;g++){var w=t.cellTree.columns[u.row][g];g==u.begin&&(w.icon=!0,w.lastchild=u.end,w.length=u.end-u.begin,w.expand=!0,u.child?w.child=u.child:w.child=0)}}}catch(R){m.e(R)}finally{m.f()}t.cellTree.tempSchema=Array(p).fill().map(function(){return{hidden:!1}}),h&&(t.cellTree.columns={})}t.cellTree.origin={rows:t.cellTree.rows,columns:t.cellTree.columns}}},t.getDomRoot=function(){return t.shadowRoot?t.shadowRoot.host:t.parentNode},t.getFontName=function(e){return e.replace(/\d+\.?\d*px/,"")},t.getFontHeight=function(e){return parseFloat(e)},t.parseStyleValue=function(e){if(/Font/.test(e))return t.style[e+"Height"]=t.getFontHeight(t.style[e]),void(t.style[e+"Name"]=t.getFontName(t.style[e]));e==="moveOverlayBorderSegments"&&typeof t.style[e]=="string"&&(t.style[e]=t.style[e].split(",").map(function(o){return parseInt(o,10)}))},t.initProp=function(e){t.args[e]&&Object.keys(t.args[e]).forEach(function(o){t[e][o]=t.args[e][o]})},t.getStyleProperty=function(e){return t.styleKeys.indexOf(e)===-1?t.parentNodeStyle[e]:t.style[e]},t.setStyleProperty=function(e,o,n){var i=["height","width","minHeight","minWidth","maxHeight","maxWidth"].indexOf(e)!==-1;t.styleKeys.indexOf(e)===-1?t.parentNodeStyle[e]=o:(/-/.test(e)&&(e=t.dehyphenateProperty(e)),t.style[e]=o,t.parseStyleValue(e)),i&&t.resize(),n||(t.draw(!0),t.dispatchEvent("stylechanged",{name:"style",value:o}))},t.reloadStoredValues=function(){if(t.attributes.name&&t.attributes.saveAppearance){try{t.storedSettings=localStorage.getItem(t.storageName+"-"+t.attributes.name)}catch(e){console.warn("Error loading stored values. "+e.message),t.storedSettings=void 0}if(t.storedSettings)try{t.storedSettings=JSON.parse(t.storedSettings)}catch(e){console.warn("could not read settings from localStore",e),t.storedSettings=void 0}t.storedSettings&&(_typeof(t.storedSettings.sizes)==="object"&&t.storedSettings.sizes!==null&&(t.sizes.rows=t.storedSettings.sizes.rows,t.sizes.columns=t.storedSettings.sizes.columns,["trees","columns","rows"].forEach(function(e){t.sizes[e]||(t.sizes[e]={})})),_typeof(t.storedSettings.visibility)==="object"&&t.getSchema().forEach(function(e){t.storedSettings.visibility&&t.storedSettings.visibility[e.name]!==void 0&&(e.hidden=!t.storedSettings.visibility[e.name])}))}},t.init=function(){if(!t.initialized){var e={};return t.setAttributes(),t.setStyle(),t.initScrollBox(),t.setDom(),t.nodeType="canvas-datagrid",t.ie=/Trident/.test(window.navigator.userAgent),t.edge=/Edge/.test(window.navigator.userAgent),t.webKit=/WebKit/.test(window.navigator.userAgent),t.moz=/Gecko/.test(window.navigator.userAgent),t.mobile=/Mobile/i.test(window.navigator.userAgent),t.blankValues=[void 0,null,""],t.cursorGrab="grab",t.cursorGrabing="grabbing",t.cursorGrab=t.webKit?"-webkit-grab":t.cursorGrab,t.cursorGrabing=t.moz?"-webkit-grabbing":t.cursorGrabbing,t.pointerLockPosition={x:0,y:0},Object.keys(t.style).forEach(t.parseStyleValue),t.intf.moveSelection=t.moveSelection,t.intf.deleteSelectedData=t.deleteSelectedData,t.intf.moveTo=t.moveTo,t.intf.addEventListener=t.addEventListener,t.intf.removeEventListener=t.removeEventListener,t.intf.dispatchEvent=t.dispatchEvent,t.intf.dispose=t.dispose,t.intf.appendTo=t.appendTo,t.intf.getVisibleCellByIndex=t.getVisibleCellByIndex,t.intf.filters=t.filters,t.intf.sorters=t.sorters,t.intf.autosize=t.autosize,t.intf.beginEditAt=t.beginEditAt,t.intf.endEdit=t.endEdit,t.intf.setActiveCell=t.setActiveCell,t.intf.forEachSelectedCell=t.forEachSelectedCell,t.intf.scrollIntoView=t.scrollIntoView,t.intf.clearChangeLog=t.clearChangeLog,t.intf.gotoCell=t.gotoCell,t.intf.gotoRow=t.gotoRow,t.intf.addButton=t.addButton,t.intf.toggleCellCollapseTree=t.toggleCellCollapseTree,t.intf.expandCollapseCellTree=t.expandCollapseCellTree,t.intf.getHeaderByName=t.getHeaderByName,t.intf.findColumnScrollLeft=t.findColumnScrollLeft,t.intf.findRowScrollTop=t.findRowScrollTop,t.intf.fitColumnToValues=t.fitColumnToValues,t.intf.findColumnMaxTextLength=t.findColumnMaxTextLength,t.intf.disposeContextMenu=t.disposeContextMenu,t.intf.getCellAt=t.getCellAt,t.intf.groupColumns=t.groupColumns,t.intf.groupRows=t.groupRows,t.intf.removeGroupColumns=t.removeGroupColumns,t.intf.removeGroupRows=t.removeGroupRows,t.intf.toggleGroupColumns=t.toggleGroupColumns,t.intf.toggleGroupRows=t.toggleGroupRows,t.intf.getGroupsColumnBelongsTo=t.getGroupsColumnBelongsTo,t.intf.getGroupsRowBelongsTo=t.getGroupsRowBelongsTo,t.intf.isCellVisible=t.isCellVisible,t.intf.isRowVisible=t.isRowVisible,t.intf.isColumnVisible=t.isColumnVisible,t.intf.order=t.order,t.intf.draw=t.draw,t.intf.refresh=t.refresh,t.intf.isComponent=t.isComponent,t.intf.selectArea=t.selectArea,t.intf.clipElement=t.clipElement,t.intf.getSchemaFromData=t.getSchemaFromData,t.intf.setFilter=t.setFilter,t.intf.parentGrid=t.parentGrid,t.intf.toggleTree=t.toggleTree,t.intf.expandTree=t.expandTree,t.intf.collapseTree=t.collapseTree,t.intf.canvas=t.canvas,t.intf.context=t.ctx,t.intf.insertRow=t.insertRow,t.intf.deleteRow=t.deleteRow,t.intf.addRow=t.addRow,t.intf.insertColumn=t.insertColumn,t.intf.deleteColumn=t.deleteColumn,t.intf.addColumn=t.addColumn,t.intf.getClippingRect=t.getClippingRect,t.intf.setRowHeight=t.setRowHeight,t.intf.setColumnWidth=t.setColumnWidth,t.intf.resetColumnWidths=t.resetColumnWidths,t.intf.resetRowHeights=t.resetRowHeights,t.intf.resize=t.resize,t.intf.selectColumn=t.selectColumn,t.intf.selectRow=t.selectRow,t.intf.selectAll=t.selectAll,t.intf.selectNone=t.selectNone,t.intf.drawChildGrids=t.drawChildGrids,t.intf.assertPxColor=t.assertPxColor,t.intf.clearPxColorAssertions=t.clearPxColorAssertions,t.intf.integerToAlpha=t.integerToAlpha,t.intf.copy=t.copy,t.intf.cut=t.cut,t.intf.paste=t.paste,t.intf.setStyleProperty=t.setStyleProperty,t.intf.hideColumns=t.hideColumns,t.intf.unhideColumns=t.unhideColumns,t.intf.hideRows=t.hideRows,t.intf.unhideRows=t.unhideRows,Object.defineProperty(t.intf,"defaults",{get:function(){return{styles:t.defaults.styles.reduce(function(n,i){return n[i[0]]=i[1],n},{}),attributes:t.defaults.attributes.reduce(function(n,i){return n[i[0]]=i[1],n},{})}}}),t.styleKeys=Object.keys(t.intf.defaults.styles),t.styleKeys.map(function(n){return t.hyphenateProperty(n,!1)}).forEach(o),t.styleKeys.map(function(n){return t.hyphenateProperty(n,!0)}).forEach(o),t.DOMStyles=window.getComputedStyle(document.body,null),t.styleKeys.concat(Object.keys(t.DOMStyles)).forEach(function(n){e[n]=void 0,Object.defineProperty(e,n,{get:function(){return t.getStyleProperty(n)},set:function(i){t.initialized&&(t.appliedInlineStyles[n]=i),t.setStyleProperty(n,i)}})}),Object.defineProperty(t.intf,"shadowRoot",{get:function(){return t.shadowRoot}}),Object.defineProperty(t.intf,"activeCell",{get:function(){return t.activeCell}}),Object.defineProperty(t.intf,"hasFocus",{get:function(){return t.hasFocus}}),Object.defineProperty(t.intf,"hasActiveFilters",{get:function(){return t.hasActiveFilters()}}),Object.defineProperty(t.intf,"style",{get:function(){return e},set:function(n){Object.keys(n).forEach(function(i){t.setStyleProperty(i,n[i],!0)}),t.draw(!0),t.dispatchEvent("stylechanged",{name:"style",value:n})}}),Object.defineProperty(t.intf,"attributes",{value:{}}),Object.keys(t.attributes).forEach(function(n){Object.defineProperty(t.intf.attributes,n,{get:function(){return t.attributes[n]},set:function(i){t.attributes[n]=i,n==="name"&&t.tryLoadStoredSettings(),n!=="rowTree"&&n!=="columnTree"&&n!=="columnTreeRowEndIndex"||t.initCellTreeSettings(),t.draw(!0),t.dispatchEvent("attributechanged",{name:n,value:i[n]})}})}),t.filters.string=function(n,i){if(i===t.attributes.blanksText)return t.blankValues.includes(n==null?n:String(n).trim());n=String(n);var s,d=/\/(i|g|m)*$/.exec(i),c=d?d[0].substring(1):"",p=c.length;if(t.invalidFilterRegEx=void 0,i.substring(0,1)==="/"&&d){try{s=new RegExp(i.substring(1,i.length-(p+1)),c)}catch(h){return void(t.invalidFilterRegEx=h)}return s.test(n)}return!!n.toString&&n.toString().toLocaleUpperCase().indexOf(i.toLocaleUpperCase())!==-1},t.filters.number=function(n,i){return i===t.attributes.blanksText?t.blankValues.includes(n==null?n:String(n).trim()):!i||n===i},["formatters","filters","sorters"].forEach(t.initProp),t.applyComponentStyle(!1,t.intf),t.reloadStoredValues(),t.args.data&&(t.intf.data=t.args.data),(t.intf.innerText||t.intf.textContent)&&(t.intf.dataType==="application/x-canvas-datagrid"&&(t.intf.dataType="application/json+x-canvas-datagrid"),t.intf.data=t.intf.innerText||t.intf.textContent),t.args.schema&&(t.intf.schema=t.args.schema),t.isChildGrid||!t.isComponent?requestAnimationFrame(function(){t.resize(!0)}):t.resize(!0),t.initialized=!0,t}function o(n){t.styleKeys.indexOf(n)===-1&&t.styleKeys.push(n)}},t.intf.blur=function(e){t.hasFocus=!1},t.intf.focus=function(){t.hasFocus=!0,t.controlInput.focus()},(t.shadowRoot||t.isChildGrid)&&(Object.defineProperty(t.intf,"height",{get:function(){return t.shadowRoot?t.shadowRoot.height:t.parentNode.height},set:function(e){t.shadowRoot?t.shadowRoot.height=e:t.parentNode.height=e,t.resize(!0)}}),Object.defineProperty(t.intf,"width",{get:function(){return t.shadowRoot?t.shadowRoot.width:t.parentNode.width},set:function(e){t.shadowRoot?t.shadowRoot.width=e:t.parentNode.width=e,t.resize(!0)}}),Object.defineProperty(t.intf,"parentNode",{get:function(){return t.parentNode},set:function(e){if(!t.isChildGrid)throw new TypeError("Cannot set property parentNode which has only a getter");t.parentNode=e}})),Object.defineProperty(t.intf,"visibleRowHeights",{get:function(){return t.visibleRowHeights}}),Object.defineProperty(t.intf,"openChildren",{get:function(){return t.openChildren}}),Object.defineProperty(t.intf,"childGrids",{get:function(){return Object.keys(t.childGrids).map(function(e){return t.childGrids[e]})}}),Object.defineProperty(t.intf,"isChildGrid",{get:function(){return t.isChildGrid}}),Object.defineProperty(t,"cursor",{get:function(){return t.parentNodeStyle.cursor},set:function(e){e==="cell"&&(e="default"),t.currentCursor!==e&&(t.parentNodeStyle.cursor=e,t.currentCursor=e)}}),Object.defineProperty(t.intf,"orderDirection",{get:function(){return t.orderDirection},set:function(e){e!=="desc"&&(e="asc"),t.orderDirection=e,t.order(t.orderBy,t.orderDirection)}}),Object.defineProperty(t.intf,"orderBy",{get:function(){return t.orderBy},set:function(e){if(t.getSchema().find(function(o){return o.name===e})===void 0)throw new Error("Cannot sort by unknown column name.");t.orderBy=e,t.order(t.orderBy,t.orderDirection)}}),t.isComponent&&(Object.defineProperty(t.intf,"offsetHeight",{get:function(){return t.canvas.offsetHeight}}),Object.defineProperty(t.intf,"offsetWidth",{get:function(){return t.canvas.offsetWidth}})),Object.defineProperty(t.intf,"scrollHeight",{get:function(){return t.scrollBox.scrollHeight}}),Object.defineProperty(t.intf,"scrollWidth",{get:function(){return t.scrollBox.scrollWidth}}),Object.defineProperty(t.intf,"scrollTop",{get:function(){return t.scrollBox.scrollTop},set:function(e){t.scrollBox.scrollTop=e}}),Object.defineProperty(t.intf,"scrollLeft",{get:function(){return t.scrollBox.scrollLeft},set:function(e){t.scrollBox.scrollLeft=e}}),Object.defineProperty(t.intf,"sizes",{get:function(){return t.sizes}}),Object.defineProperty(t.intf,"parentDOMNode",{get:function(){return t.parentDOMNode}}),Object.defineProperty(t.intf,"input",{get:function(){return t.input}}),Object.defineProperty(t.intf,"controlInput",{get:function(){return t.controlInput}}),Object.defineProperty(t.intf,"currentCell",{get:function(){return t.currentCell}}),Object.defineProperty(t.intf,"visibleCells",{get:function(){return t.visibleCells}}),Object.defineProperty(t.intf,"visibleRows",{get:function(){return t.visibleRows}}),Object.defineProperty(t.intf,"selections",{get:function(){return r||(console.warn("DeprecationWarning: The property 'selections' is deprecated due to performance issue. And it will be removed in the future.Please use new property 'selectionList' instead. Visit this link to get more information: https://github.com/TonyGermaneri/canvas-datagrid/pull/498"),r=!0),t.getObsoleteSelectionMatrix()}}),Object.defineProperty(t.intf,"selectionList",{get:function(){return t.selections}}),Object.defineProperty(t.intf,"dragMode",{get:function(){return t.dragMode}}),Object.defineProperty(t.intf,"changes",{get:function(){return t.changes}}),t.intf.formatters=t.formatters,Object.defineProperty(t.intf,"dataType",{get:function(){return t.dataType},set:function(e){if(!t.parsers[e])throw new Error("No parser for MIME type "+e);t.dataType=e}}),t.eventNames.forEach(function(e){Object.defineProperty(t.intf,"on"+e,{get:function(){return t.componentL1Events[e]},set:function(o){t.events[e]=[],t.componentL1Events[e]=o,o&&t.addEventListener(e,o)}})}),Object.defineProperty(t.intf,"frozenRow",{get:function(){return t.frozenRow},set:function(e){if(isNaN(e))throw new TypeError("Expected value for frozenRow to be a number.");if(t.visibleRows.length<e)throw new RangeError("Cannot set a value larger than the number of visible rows.");t.frozenRow=e}}),Object.defineProperty(t.intf,"frozenColumn",{get:function(){return t.frozenColumn},set:function(e){if(isNaN(e))throw new TypeError("Expected value for frozenRow to be a number.");if(t.getVisibleSchema().length<e)throw new RangeError("Cannot set a value larger than the number of visible columns.");t.frozenColumn=e}}),Object.defineProperty(t.intf,"scrollIndexRect",{get:function(){return{top:t.scrollIndexTop,right:t.scrollIndexRight,bottom:t.scrollIndexBottom,left:t.scrollIndexLeft}}}),Object.defineProperty(t.intf,"scrollPixelRect",{get:function(){return{top:t.scrollPixelTop,right:t.scrollPixelRight,bottom:t.scrollPixelBottom,left:t.scrollPixelLeft}}}),Object.defineProperty(t.intf,"rowOrder",{get:function(){return t.orders.rows},set:function(e){if(!Array.isArray(e))throw new TypeError("Value must be an array.");if(!t.originalData||e.length<t.originalData.length)throw new RangeError("Array length must be equal to or greater than number of rows.");t.orders.rows=e}}),Object.defineProperty(t.intf,"columnOrder",{get:function(){return t.orders.columns},set:function(e){if(!Array.isArray(e))throw new TypeError("Value must be an array.");if(e.length<t.getSchema().length)throw new RangeError("Array length must be equal to or greater than number of columns.");t.orders.columns=e}}),Object.defineProperty(t.intf,"selectionBounds",{get:function(){return t.getSelectionBounds()}}),Object.defineProperty(t.intf,"selectedRows",{get:function(){return t.getSelectedData(!0)}}),Object.defineProperty(t.intf,"selectedCells",{get:function(){return t.getSelectedData()}}),Object.defineProperty(t.intf,"visibleSchema",{get:function(){return t.getVisibleSchema().map(function(e){return e})}}),Object.defineProperty(t.intf,"treeGridAttributes",{get:function(){return t.treeGridAttributes},set:function(e){t.treeGridAttributes=e}}),Object.defineProperty(t.intf,"cellGridAttributes",{get:function(){return t.cellGridAttributes},set:function(e){t.cellGridAttributes=e}}),Object.defineProperty(t.intf,"fillCellCallback",{get:function(){return t.fillCellCallback},set:function(e){t.fillCellCallback=e}}),Object.defineProperty(t.intf,"ctx",{get:function(){return t.ctx}}),Object.defineProperty(t.intf,"schema",{get:function(){return t.getSchema()},set:function(e){if(e===void 0)return t.schema=void 0,t.tempSchema=void 0,void t.dispatchEvent("schemachanged",{schema:void 0});if(!Array.isArray(e)||_typeof(e[0])!=="object")throw new Error("Schema must be an array of objects.");if(e[0].name===void 0)throw new Error("Expected schema to contain an object with at least a name property.");t.schema=e.map(function(o,n){return o.width=o.width||t.style.cellWidth,o.filter=o.filter||t.filter(o.type),o.type=o.type||"string",o.index=n,o.columnIndex=n,o.rowIndex=-1,o}),t.tempSchema=void 0,t.createNewRowData(),t.createColumnOrders(),t.tryLoadStoredSettings(),t.storedSettings&&_typeof(t.storedSettings.visibility)==="object"&&t.schema.forEach(function(o,n){t.storedSettings&&t.storedSettings.visibility[o.name]!==void 0&&(o.hidden=!t.storedSettings.visibility[o.name])}),t.resize(!0),t.dispatchEvent("schemachanged",{schema:t.schema})}}),t.intf.getTypes=function(){return Object.keys(t.parsers)},t.parseInnerHtml=function(e){if(!e||/^ +$/.test(e))return[];try{e=JSON.parse(e)}catch(o){console.warn(Error("Cannot parse application/json+x-canvas-datagrid formated data. "+o.message+`  
Note: canvas-datagrid.innerHTML is for string data only.  Use the canvas-datagrid.data property to set object data.`))}return e},t.parsers["application/json+x-canvas-datagrid"]=function(e,o){t.parsers["application/x-canvas-datagrid"](t.parseInnerHtml(e),function(n,i){return o(n,i)})},t.parsers["application/x-canvas-datagrid"]=function(e,o){return o(e)},t.intf.parsers=t.parsers,t.etl=function(e,o){if(!t.intf.parsers[t.dataType])throw new Error("Unsupported data type.");t.intf.parsers[t.dataType](e,function(n,i){t.originalData=n,t.viewData=Array.from(t.originalData),Array.isArray(i)&&(t.schema=i),t.attributes.autoGenerateSchema&&(t.schema=t.getSchemaFromData(n)),t.schema||(t.tempSchema=t.getSchemaFromData(n)),t.getSchema()&&t.createColumnOrders(),t.refresh(),t.schema||(t.originalData||[]).length!==0||(t.tempSchema=[{name:""}]),t.fitColumnToValues("cornerCell",!0),(t.tempSchema&&!t.schema||t.attributes.autoGenerateSchema)&&(t.createColumnOrders(),t.dispatchEvent("schemachanged",{schema:t.tempSchema})),o()})},Object.defineProperty(t.intf,"viewData",{get:function(){return t.viewData}}),Object.defineProperty(t.intf,"boundData",{get:function(){return t.originalData}}),Object.defineProperty(t.intf,"data",{get:function(){return t.originalData},set:function(e){t.etl(e,function(){t.changes=[],t.createNewRowData(),t.attributes.autoResizeColumns&&t.originalData.length>0&&t.storedSettings===void 0&&t.autosize(),t.fitColumnToValues("cornerCell",!0),t.createRowOrders(),t.tryLoadStoredSettings(),t.dispatchEvent("datachanged",{data:t.originalData}),t.initCellTreeSettings(),t.resize(!0)})}}),t.initScrollBox=function(){var e=0,o=0,n=0,i=0,s=0,d=0,c=20,p=20;function h(u,g){if(isNaN(u))throw new Error("ScrollTop value must be a number");u<0&&(u=0),u>s&&(u=s),s<0&&(u=0),n=u,g||t.scroll(),t.button&&t.moveButtonPos()}function m(u,g){if(isNaN(u))throw new Error("ScrollLeft value must be a number");u<0&&(u=0),u>d&&(u=d),d<0&&(u=0),i=u,g||t.scroll(),t.button&&t.moveButtonPos()}t.scrollBox.toString=function(){return'{"width": '+d.toFixed(2)+', "height": '+s.toFixed(2)+', "left": '+i.toFixed(2)+', "top": '+n.toFixed(2)+', "widthRatio": '+t.scrollBox.widthBoxRatio.toFixed(5)+', "heightRatio": '+t.scrollBox.heightBoxRatio.toFixed(5)+"}"},t.scrollBox.scrollTo=function(u,g,w){m(u,!0),h(g,w)},Object.defineProperty(t.scrollBox,"scrollBoxHeight",{get:function(){return c},set:function(u){c=u}}),Object.defineProperty(t.scrollBox,"scrollBoxWidth",{get:function(){return p},set:function(u){p=u}}),Object.defineProperty(t.scrollBox,"height",{get:function(){return e},set:function(u){e=u}}),Object.defineProperty(t.scrollBox,"width",{get:function(){return o},set:function(u){o=u}}),Object.defineProperty(t.scrollBox,"scrollTop",{get:function(){return n},set:h}),Object.defineProperty(t.scrollBox,"scrollLeft",{get:function(){return i},set:m}),Object.defineProperty(t.scrollBox,"scrollHeight",{get:function(){return s},set:function(u){n>u&&(n=Math.max(u,0)),s=u}}),Object.defineProperty(t.scrollBox,"scrollWidth",{get:function(){return d},set:function(u){i>u&&(i=Math.max(u,0)),d=u}})}}function selections(t){var a=this;function l(e,o,n){if(o){var i=o.top,s=o.bottom,d=o.left,c=o.right,p=s-i+1,h=c-d+1,m=getSelectionStateFromCells(t.selections,{startRow:i,endRow:s,startColumn:d,endColumn:c});if(m!==!1)for(var u=r(d,h),g=i,w=i+p;g<w;g++){var R=t.viewData[g]||{},T=m===!0||m[g-i];if(T){for(var I=d,F=d+h;I<F;I++)if(T===!0||T[I-d]){var D=u[I];D&&(!D.hidden||n)&&e({value:R[D.name],header:D,columnName:D.name,boundRowIndex:t.getBoundRowIndexFromViewRowIndex(g),boundColumnIndex:t.orders.columns[I],viewRowIndex:g,viewColumnIndex:I})}}}}}function r(e,o){for(var n=t.getSchema(),i=[],s=e,d=e+o;s<d;s++){var c=n[t.orders.columns[s]];i[s]=c}return i}t.selections=[],t.selectionCache=[],t.selectionCacheWidth=0,t.selectionCacheHeight=0,t.getObsoleteSelectionMatrix=(function(e){var o=this;_newArrowCheck(this,a);var n=t.getSelectionBounds(!0,e);if(!n)return[];var i=n.top,s=n.bottom,d=n.left,c=n.right,p=s-i+1,h=c-d+1,m=getSelectionStateFromCells(t.selections,{startRow:i,endRow:s,startColumn:d,endColumn:c});if(m===!1)return[];for(var u=[],g=i,w=i+p;g<w;g++)if(m!==!0){var R=m[g-i];if(R){u[g]=[];for(var T=d,I=d+h;T<I;T++)(R===!0||R[T-d])&&u[g].push(T)}}else u[g]=new Array(h).fill(0).map((function(f,b){return _newArrowCheck(this,o),d+b}).bind(this));for(var F=0;F<t.selections.length;F++){var D=t.selections[F];if(D.type===SelectionType.Rows)for(var L=D.startRow;L<=D.endRow;L++)u[L]?u[L][0]!==-1&&u[L].unshift(-1):u[L]=[-1]}return u}).bind(this),t.getSelectedContiguousColumns=function(e){var o=this;e||(e=t.getSchema());var n=getSelectedContiguousColumns(t.selections,!1);if(Array.isArray(n)){var i=t.orders.columns;return n.map((function(s){_newArrowCheck(this,o);var d=i[s],c=e[d];return Object.assign({},c,{orderIndex:s})}).bind(this))}},t.getSelectedContiguousRows=function(e){var o=getSelectedContiguousRows(t.selections,!1);if(Array.isArray(o)&&(e||o[0]!==o[1]))return o},t.canSelectionsBeCopied=function(){return t.selections.length>0&&!areSelectionsComplex(t.selections)},t.getSelectedRowsHeight=function(){var e=getSelectedContiguousRows(t.selections,!0);if(!e)return 0;for(var o=0,n=e[0];n<=e[1];n++)o+=t.getRowHeight(n);return o},t.getSelectedColumnsWidth=function(){var e=getSelectedContiguousColumns(t.selections,!0);if(!e)return 0;for(var o=0,n=e[0];n<=e[1];n++)o+=t.getColumnWidth(t.orders.columns[n]);return o},t.isCellSelected=(function(e){return _newArrowCheck(this,a),isCellSelected(t.selections,e.rowIndex,e.viewColumnIndex)}).bind(this),t.isColumnSelected=(function(e){return _newArrowCheck(this,a),typeof e=="number"&&isColumnSelected(t.selections,e)}).bind(this),t.isRowSelected=(function(e){return _newArrowCheck(this,a),typeof e=="number"&&isRowSelected(t.selections,e)}).bind(this),t.clearSelections=(function(e){_newArrowCheck(this,a),t.selections=[],e&&t.dispatchSelectionChangedEvent()}).bind(this),t.selectNone=(function(e){_newArrowCheck(this,a),t.clearSelections(!0),e||t.draw()}).bind(this),t.selectAll=function(e){_addIntoSelections(t.selections,{type:SelectionType.Columns,startColumn:0,endColumn:t.getSchema().length-1})&&!e&&t.draw()},t.unselectCell=(function(e,o){_newArrowCheck(this,a);var n=_removeFromSelections(t.selections,normalizeSelection({type:SelectionType.Cells,startRow:e.rowIndex,startColumn:e.viewColumnIndex}));return n&&!o&&t.dispatchSelectionChangedEvent(),n}).bind(this),t.unselectRows=(function(e,o,n){_newArrowCheck(this,a);var i=_removeFromSelections(t.selections,normalizeSelection({type:SelectionType.Rows,startRow:e,endRow:o}));return i&&!n&&t.dispatchSelectionChangedEvent(),i}).bind(this),t.selectCell=(function(e,o){_newArrowCheck(this,a);var n=_addIntoSelections(t.selections,normalizeSelection({type:SelectionType.Cells,startRow:e.rowIndex,startColumn:e.viewColumnIndex}));return n&&!o&&t.dispatchSelectionChangedEvent(),n}).bind(this),t.moveSelection=function(e,o){moveSelections(t.selections,e,o)},t.dispatchSelectionChangedEvent=(function(){_newArrowCheck(this,a),t.dispatchEvent("selectionchanged",t.getContextOfSelectionEvent())}).bind(this),t.getContextOfSelectionEvent=(function(){_newArrowCheck(this,a);var e={selectionList:t.cloneSelections()};return Object.defineProperty(e,"selections",{get:function(){return t.getObsoleteSelectionMatrix()}}),Object.defineProperty(e,"selectedData",{get:function(){return t.getSelectedData()}}),Object.defineProperty(e,"selectedCells",{get:function(){return t.getSelectedCells()}}),Object.defineProperty(e,"selectionBounds",{get:function(){return t.getSelectionBounds()}}),e}).bind(this),t.cloneSelections=(function(){return _newArrowCheck(this,a),cloneSelections(t.selections)}).bind(this),t.getSelectionBounds=(function(e,o){_newArrowCheck(this,a);var n=getSelectionBounds(o||t.selections);if(e){if(n.top>n.bottom||n.left>n.right)return null;t.sanitizeSelectionBounds(n)}return n}).bind(this),t.sanitizeSelectionBounds=(function(e){if(_newArrowCheck(this,a),!e)return e;e.top<0&&(e.top=0),e.left<0&&(e.left=0);var o=t.viewData.length;e.bottom>o&&(e.bottom=o-1);var n=t.getSchema().length;return e.right>n&&(e.right=n-1),e}).bind(this),t.getSelectedData=(function(e){_newArrowCheck(this,a);var o=t.getSelectionBounds(!0);if(!o)return[];var n=[],i=o.top,s=o.bottom,d=o.left,c=o.right,p=s-i+1,h=c-d+1,m=getSelectionStateFromCells(t.selections,{startRow:i,endRow:s,startColumn:d,endColumn:c});if(m===!1)return[];for(var u=r(d,h),g=i,w=i+p;g<w;g++){var R=t.viewData[g]||{},T={},I=!1,F=m===!0||m[g-i];if(F){for(var D=d,L=d+h;D<L;D++)if(m===!0||F[D-d]){var f=u[D];if(f&&!f.hidden){if(I=!0,e)break;T[f.name]=R[f.name]}}I&&(n[g]=e?Object.assign({},R):T)}}return n}).bind(this),t.getSelectedCells=(function(e){var o=this;_newArrowCheck(this,a);var n=[],i=t.getSelectionBounds(!0);return l((function(s){return _newArrowCheck(this,o),n.push(s)}).bind(this),i,e),n}).bind(this),t.clearSelectedCells=(function(){var e=this;_newArrowCheck(this,a);var o=[],n=t.getSelectionBounds(!0);return l((function(i){_newArrowCheck(this,e),o.push(i),t.viewData[i.viewRowIndex][i.columnName]=""}).bind(this),n,!1),o}).bind(this),t.deleteSelectedData=(function(e){var o=this;_newArrowCheck(this,a);var n=t.clearSelectedCells().map((function(i){return _newArrowCheck(this,o),[i.viewRowIndex,i.viewColumnIndex,i.boundRowIndex,i.boundColumnIndex]}).bind(this));t.dispatchEvent("afterdelete",{cells:n}),e||requestAnimationFrame((function(){return _newArrowCheck(this,o),t.draw()}).bind(this))}).bind(this),t.forEachSelectedCell=function(e,o){var n=this,i=t.getSelectionBounds(!0);l((function(s){return _newArrowCheck(this,n),e(t.viewData,s.viewRowIndex,s.columnName,s)}).bind(this),i,o)},t.copySelectedCellsToClipboard=(function(e){var o=this;_newArrowCheck(this,a);var n=areSelectionsNeat(t.selections),i=t.getSelectedData().filter((function(g){return _newArrowCheck(this,o),g!=null}).bind(this));if(i.length>0)for(var s=createTextString(i,n),d={"text/plain":s,"text/html":createHTMLString(i,n),"text/csv":s,"application/json":JSON.stringify(i)},c=0,p=Object.entries(d);c<p.length;c++){var h=_slicedToArray(p[c],2),m=h[0],u=h[1];e.setData(m,u)}}).bind(this),t.fitSelectedColumns=(function(e){var o=this;_newArrowCheck(this,a);var n=t.getSelectionBounds(!0);if(n){var i=typeof e=="number"&&e>0;n.bottom=n.top,l((function(s){_newArrowCheck(this,o);var d=s.columnName,c=s.viewColumnIndex;i?(t.sizes.columns[c]=e,t.dispatchEvent("resizecolumn",{x:e,y:t.resizingStartingHeight,width:e,height:t.resizingStartingHeight,columnIndex:c,draggingItem:t.currentCell})):t.fitColumnToValues(d)}).bind(this),n,!1)}}).bind(this),t.fitSelectedRows=(function(e){_newArrowCheck(this,a);var o=t.getSelectionBounds(!0);if(o)for(var n=o.top;n<=o.bottom;n++)t.isRowSelected(n)&&(t.sizes.rows[n]=e,t.dispatchEvent("resizerow",{width:t.resizingStartingWidth,height:e,rowIndex:n,draggingItem:t.currentCell}))}).bind(this),t.selectColumn=(function(e,o,n,i){if(_newArrowCheck(this,a),t.isMultiRowsSelected=!1,t.isMultiColumnsSelected=!1,n){if(!t.activeCell)return;var s=Math.min(t.activeCell.columnIndex,e),d=Math.max(t.activeCell.columnIndex,e);_addIntoSelections(t.selections,normalizeSelection({type:SelectionType.Columns,startColumn:s,endColumn:d-1})),s!=d&&(t.isMultiColumnsSelected=!0)}var c;o||n||(t.selections=[],t.activeCell.columnIndex=e,t.activeCell.rowIndex=t.scrollIndexTop),o&&t.isColumnSelected(e)?(c=e,_removeFromSelections(t.selections,normalizeSelection({type:SelectionType.Columns,startColumn:c}))):function(p){_addIntoSelections(t.selections,normalizeSelection({type:SelectionType.Columns,startColumn:p}))}(e),i||t.dispatchSelectionChangedEvent()}).bind(this),t.selectRow=(function(e,o,n,i){function s(){i||t.dispatchSelectionChangedEvent()}if(_newArrowCheck(this,a),t.isMultiRowsSelected=!1,(t.dragAddToSelection===!1||t.dragObject===void 0)&&isRowSelected(t.selections,e)&&o)return _removeFromSelections(t.selections,normalizeSelection({type:SelectionType.Rows,startRow:e})),void s();if(t.dragAddToSelection===!0||t.dragObject===void 0)if(n&&t.dragObject===void 0){if(!t.activeCell)return;var d=Math.min(t.activeCell.rowIndex,e),c=Math.max(t.activeCell.rowIndex,e);_addIntoSelections(t.selections,normalizeSelection({type:SelectionType.Rows,startRow:d,endRow:c}))}else p=e,_addIntoSelections(t.selections,normalizeSelection({type:SelectionType.Rows,startRow:p}));var p;s()}).bind(this),t.selectArea=function(e,o){var n=t.getSchema().length;if(e){if(e.right<0&&(e.right=Math.max(n-1,e.left,0)),e.top>e.bottom||e.left>e.right)throw new Error("Impossible selection area");t.selectionBounds=t.sanitizeSelectionBounds(e)}var i=t.selectionBounds,s=i.top,d=i.bottom,c=i.left,p=i.right;if(o||(t.selections=[]),d>=t.viewData.length&&(d=Math.max(t.viewData.length-1,s)),s<-1||c<-1||p>n)throw new Error("Impossible selection area");var h={rows:t.viewData.length,columns:n},m=!1;if(s===-1){var u=Math.max(c,0),g=c===-1?n-1:Math.min(p,n-1);m=_addIntoSelections(t.selections,normalizeSelection({type:SelectionType.Columns,startColumn:u,endColumn:g}),h)}else if(c===-1){var w=Math.max(s,0),R=Math.min(d,t.viewData.length-1);m=_addIntoSelections(t.selections,normalizeSelection({type:SelectionType.Rows,startRow:w,endRow:R}),h)}else m=_addIntoSelections(t.selections,normalizeSelection({type:SelectionType.Cells,startRow:s,endRow:d,startColumn:c,endColumn:p}),h);m&&t.dispatchSelectionChangedEvent()},t.getRowSelectionStates=(function(e){var o=this;_newArrowCheck(this,a),(typeof e!="number"||e<0)&&(e=0);var n=t.getSchema().length-1,i=n-0+1,s=getSelectionStateFromCells(t.selections,{startRow:e,startColumn:0,endRow:e,endColumn:n});if(s!==!1){if(s===!0)return new Array(i).fill(!0).map((function(h,m){return _newArrowCheck(this,o),m}).bind(this));var d=s[0];if(d){for(var c=[],p=0;p<d.length;p++)d[p]&&c.push(p);return c}}}).bind(this),t.replaceAllSelections=(function(e){_newArrowCheck(this,a),cleanupSelections(e),t.selections=e}).bind(this),t.selectColumnViewIndexes=(function(e){var o=this;_newArrowCheck(this,a);var n=e.map((function(i){return _newArrowCheck(this,o),{type:SelectionType.Columns,startColumn:i,endRow:i}}).bind(this));t.replaceAllSelections(n)}).bind(this),t.getRowViewIndexesFromSelection=(function(){if(_newArrowCheck(this,a),t.selections.length===0)return[];for(var e=getSelectionBounds(t.selections,!0),o=[],n=e.top;n<=e.bottom;n++)o.push(n);return o}).bind(this),t.shrinkOrExpandSelections=(function(e,o,n){_newArrowCheck(this,a);var i=shrinkOrExpandSelections(t.selections,e,o,{columns:t.getSchema().length,rows:t.viewData.length});return i&&!n&&t.dispatchSelectionChangedEvent(),i}).bind(this)}function contextMenu(t){var a,l,r;function e(i){t.createInlineStyle(i,"canvas-datagrid-context-menu-item"+(t.mobile?"-mobile":"")),i.addEventListener("mouseover",function(){t.createInlineStyle(i,"canvas-datagrid-context-menu-item:hover")}),i.addEventListener("mouseout",function(){t.createInlineStyle(i,"canvas-datagrid-context-menu-item")})}function o(i,s,d,c){var p,h,m,u=document.createElement("div"),g=document.createElement("div"),w=document.createElement("div"),R=[],T=-1,I={};if(!Array.isArray(d))throw new Error("createContextMenu expects an array.");function F(){u.scrollTop>0?t.parentDOMNode.appendChild(g):g.parentNode&&g.parentNode.removeChild(g),u.scrollTop>=u.scrollHeight-u.offsetHeight&&w.parentNode?w.parentNode.removeChild(w):u.scrollHeight-u.offsetHeight>0&&!(u.scrollTop>=u.scrollHeight-u.offsetHeight)&&t.parentDOMNode.appendChild(w)}function D(f){return function b(){var x=t.attributes.contextHoverScrollAmount;f==="up"&&u.scrollTop===0||f==="down"&&u.scrollTop===u.scrollHeight||(u.scrollTop+=f==="up"?-x:x,l=setTimeout(b,t.attributes.contextHoverScrollRateMs,f))}}function L(f){return function(){clearTimeout(l)}}return I.parentGrid=t.intf,I.parentContextMenu=c,I.container=u,h={},m=t.scrollOffset(t.canvas),a===void 0&&(a=t.style.contextMenuZIndex),d.forEach(function(f){var b,x=document.createElement("div");function P(B){B.relatedTarget===u||f.contextMenu.container===B.relatedTarget||b===B.relatedTarget||x===B.relatedTarget||f.contextMenu.container.contains(B.relatedTarget)||(f.contextMenu.dispose(),R.splice(R.indexOf(f.contextMenu),1),f.contextMenu=void 0,x.removeEventListener("mouseout",P),u.removeEventListener("mouseout",P),x.setAttribute("contextOpen","0"),x.setAttribute("opening","0"))}function A(B){if(x.getAttribute("opening")==="1"&&x.getAttribute("contextOpen")!=="1"){var j=x.getBoundingClientRect();j={left:j.left+t.style.childContextMenuMarginLeft+u.offsetWidth,top:j.top+t.style.childContextMenuMarginTop,bottom:j.bottom,right:j.right},f.contextMenu=o(i,j,B,I),x.setAttribute("contextOpen","1"),x.addEventListener("mouseout",P),u.addEventListener("mouseout",P),R.push(f.contextMenu)}}function O(){var B;if(x.getAttribute("contextOpen")!=="1"){if(x.setAttribute("opening","1"),typeof f.items=="function")return B=f.items.apply(I,[function(j){A(j)}]),void(B!==void 0&&Array.isArray(B)&&A(B));A(f.items)}}(function(B){(function j(V){if(V!==null)return typeof V=="function"?j(V(i)):void(_typeof(V)!=="object"?(e(x),x.innerHTML=V):x.appendChild(V))})(B.title),B.contextItemContainer=x,(B.items&&B.items.length>0||typeof B.items=="function")&&(b=document.createElement("div"),t.createInlineStyle(b,"canvas-datagrid-context-child-arrow"),b.innerHTML=t.style.childContextMenuArrowHTML,x.appendChild(b),x.addEventListener("mouseover",O),x.addEventListener("mouseout",function(){x.setAttribute("opening","0")})),B.click&&x.addEventListener("click",function(j){B.click.apply(t,[j])})})(f),u.appendChild(x)}),t.createInlineStyle(u,"canvas-datagrid-context-menu"+(t.mobile?"-mobile":"")),h.x=s.left-m.left,h.y=s.top-m.top,h.height=0,a+=1,u.style.opacity=0,u.style.position="absolute",g.style.color=t.style.contextMenuArrowColor,w.style.color=t.style.contextMenuArrowColor,[g,w].forEach(function(f){f.style.textAlign="center",f.style.position="absolute",f.style.zIndex=a+1}),u.style.zIndex=a,c&&c.inputDropdown&&(u.style.maxHeight=window.innerHeight-h.y-t.style.autocompleteBottomMargin+"px",u.style.minWidth=s.width+"px",h.y+=s.height),t.mobile&&(u.style.width=s.width+"px"),u.style.left=h.x+"px",u.style.top=h.y+"px",u.addEventListener("scroll",F),u.addEventListener("wheel",function(f){t.hasFocus&&(u.scrollTop+=f.deltaY,u.scrollLeft+=f.deltaX),F()}),g.innerHTML=t.style.contextMenuArrowUpHTML,w.innerHTML=t.style.contextMenuArrowDownHTML,u.appendChild(g),document.body.appendChild(w),document.body.appendChild(u),function(f){var b=.1;f.style.display="block";var x=setInterval(function(){b>=1&&clearInterval(x),f.style.opacity=b,f.style.filter="alpha(opacity="+100*b+")",b+=.1*b},.1*t.attributes.animationDurationShowContextMenu)}(u),(p=u.getBoundingClientRect()).bottom>window.innerHeight&&(c&&c.inputDropdown||(h.y-=p.bottom+t.style.contextMenuWindowMargin-window.innerHeight),h.y<0&&(h.y=t.style.contextMenuWindowMargin),u.offsetHeight>window.innerHeight-t.style.contextMenuWindowMargin&&(u.style.height=window.innerHeight-2*t.style.contextMenuWindowMargin+"px")),p.right>window.innerWidth&&(h.x-=p.right-window.innerWidth+t.style.contextMenuWindowMargin),h.x<0&&(h.x=t.style.contextMenuWindowMargin),h.y<0&&(h.y=t.style.contextMenuWindowMargin),u.style.left=h.x+"px",u.style.top=h.y+"px",p=u.getBoundingClientRect(),g.style.top=p.top+"px",w.style.top=p.top+p.height-w.offsetHeight+"px",g.style.left=p.left+"px",w.style.left=p.left+"px",w.style.width=u.offsetWidth+"px",g.style.width=u.offsetWidth+"px",w.addEventListener("mouseover",D("down")),w.addEventListener("mouseout",L()),g.addEventListener("mouseover",D("up")),g.addEventListener("mouseout",L()),F(),I.clickIndex=function(f){d[f].contextItemContainer.dispatchEvent(new Event("click"))},I.rect=p,I.items=d,I.upArrow=g,I.downArrow=w,I.dispose=function(){clearTimeout(l),R.forEach(function(f){f.dispose()}),[w,g,u].forEach(function(f){var b,x,P;b=f,x=1,P=setInterval(function(){x<=.1&&(clearInterval(P),b.style.display="none",b.parentNode&&b.parentNode.removeChild(b)),b.style.opacity=x,b.style.filter="alpha(opacity="+100*x+")",x-=.1*x},.1*t.attributes.animationDurationHideContextMenu)})},Object.defineProperty(I,"selectedIndex",{get:function(){return T},set:function(f){if(typeof f!="number"||isNaN(f)||!isFinite(f))throw new Error("Context menu selected index must be a sane number.");(T=f)>d.length-1&&(T=d.length-1),T<0&&(T=0),d.forEach(function(b,x){if(x===T)return t.createInlineStyle(b.contextItemContainer,"canvas-datagrid-context-menu-item:hover");t.createInlineStyle(b.contextItemContainer,"canvas-datagrid-context-menu-item")})}}),I}function n(i){var s,d=document.createElement("div"),c=document.createElement("div"),p=document.createElement("button"),h=document.createElement("input"),m=i.cell&&i.cell.header?i.cell.header.title||i.cell.header.name:"";function u(){h.style.background=t.style.contextFilterInputBackground,h.style.color=t.style.contextFilterInputColor,t.invalidFilterRegEx&&(h.style.background=t.style.contextFilterInvalidRegExpBackground,h.style.color=t.style.contextFilterInvalidRegExpColor)}function g(w){if(!w||!["ArrowDown","ArrowUp","Enter","Tab"].includes(w.key)){var R,T,I,F=(R=0,T={},I=[],t.viewData.forEach(function(D){var L=D[i.cell.header.name]==null?D[i.cell.header.name]:String(D[i.cell.header.name]).trim(),f=t.blankValues.includes(L)?t.attributes.blanksText:L;T[f]||R>t.attributes.maxAutoCompleteItems||(R+=1,T[f]={title:t.formatters[i.cell.header.type||"string"]({cell:{value:f}}),click:function(b){h.value=f,b.stopPropagation(),h.dispatchEvent(new Event("keyup")),t.disposeAutocomplete()}})}),Object.keys(T).indexOf(t.attributes.blanksText)!==-1&&(I.push(T[t.attributes.blanksText]),delete T[t.attributes.blanksText]),I.concat(Object.keys(T).map(function(D){return T[D]})));s=h.getBoundingClientRect(),r&&(r.dispose(),r=void 0),(r=o(i,{left:s.left,top:s.top,right:s.right,bottom:s.bottom,height:s.height,width:s.width},F,{inputDropdown:!0})).selectedIndex=0}}t.createInlineStyle(c,"canvas-datagrid-context-menu-label"),t.createInlineStyle(p,"canvas-datagrid-context-menu-filter-button"),t.createInlineStyle(h,"canvas-datagrid-context-menu-filter-input"),u(),h.onclick=t.disposeAutocomplete,h.addEventListener("keydown",function(w){w.key==="ArrowDown"&&(r.selectedIndex+=1),w.key==="ArrowUp"&&(r.selectedIndex-=1),w.key==="Enter"&&(r.clickIndex(r.selectedIndex),t.disposeContextMenu()),w.key==="Tab"&&(r.clickIndex(r.selectedIndex),w.preventDefault()),w.key==="Escape"&&t.disposeContextMenu()}),h.addEventListener("keyup",function(){t.setFilter(i.cell.header.name,h.value)}),h.addEventListener("keyup",g),["focus","blur","keydown","keyup","change"].forEach(function(w){h.addEventListener(w,u)}),h.value=i.cell.header&&t.columnFilters[i.cell.header.name]||"",c.innerHTML=t.attributes.filterOptionText.replace(/%s/g,m),p.onclick=function(){if(r)return t.disposeAutocomplete();g()},p.innerHTML=t.style.contextFilterButtonHTML,d.addEventListener("click",function(w){return w.stopPropagation()}),d.appendChild(c),d.appendChild(h),d.appendChild(p),i.items.push({title:d}),Object.keys(t.columnFilters).length&&Object.keys(t.columnFilters).forEach(function(w){var R=t.getHeaderByName(w);i.items.push({title:t.attributes.removeFilterOptionText.replace(/%s/g,R.title||R.name),click:function(T){T.preventDefault(),t.setFilter(w,""),t.controlInput.focus()}})})}t.disposeAutocomplete=function(){r&&(r.dispose(),r=void 0)},t.disposeContextMenu=function(i){document.removeEventListener("click",t.disposeContextMenu),a=t.style.contextMenuZIndex,t.disposeAutocomplete(),t.contextMenu&&t.contextMenu.dispose(),t.contextMenu=void 0,i&&(t.canvas.focus(),t.mousedown(i),t.mouseup(i))},t.contextmenuEvent=function(i,s){var d=this;if(t.hasFocus||i.target===t.canvas){for(var c=Object.keys(t.childGrids),p=0;p<c.length;p++){var h=t.childGrids[c[p]],m=h&&h.parentNode;if(m){var u=m.offsetLeft,g=m.offsetWidth,w=m.offsetTop,R=m.offsetHeight;if(i.x>=u&&i.x<=u+g&&i.y>=w&&i.y<=w+R)return}}if(t.isChildGrid&&t.parentNode){var T=t.parentGrid&&t.parentGrid.childGrids;if(!T||!Array.isArray(T)||!T.find((function(k){_newArrowCheck(this,d);var lt=k.parentNode,rt=t.parentNode;return lt.offsetTop==rt.offsetTop&&lt.offsetLeft===rt.offsetLeft}).bind(this)))return;for(var I=t.parentNode.offsetLeft,F=t.parentNode.offsetLeft+t.parentNode.offsetWidth,D=t.parentNode.offsetTop,L=t.parentNode.offsetTop+t.parentNode.offsetHeight,f=t.parentNode.parentNode;f;){var b=f,x=b.offsetLeft,P=b.offsetWidth,A=b.offsetTop;x>I&&(I=x),A>D&&(D=A);var O=x+P,B=A+b.offsetHeight;if(O<F&&(F=O),B<L&&(L=B),f.nodeType!=="canvas-datagrid-tree")break;f=f.parentNode}if(!(i.x>=I&&i.x<=F&&i.y>=D&&i.y<=L))return}var j,V=[],J=s||t.getLayerPos(i),Z={NativeEvent:i,cell:t.getCellAt(J.x,J.y),pos:J,items:V};Z.cell.isGrid||function(k){var lt,rt=this,at=t.getSchema(),ut=(function(){var M=this;return _newArrowCheck(this,rt),lt||(lt=new Map(at.map((function(N){return _newArrowCheck(this,M),[N.columnIndex,N]}).bind(this)))),lt}).bind(this),wt=t.orderings.columns&&t.orderings.columns.length>0,ht=!(k.cell.isBackground||k.cell.isColumnHeaderCellCap||k.cell.isScrollBar||k.cell.isCorner||k.cell.isRowHeader)&&k.cell.header;if(t.attributes.showFilter&&ht&&n(k),t.attributes.showCopy&&t.canSelectionsBeCopied()&&k.items.push({title:t.attributes.copyText,click:function(){document.execCommand("copy"),t.disposeContextMenu(),t.controlInput.focus()}}),t.attributes.showPaste&&t.clipBoardData&&k.items.push({title:t.attributes.pasteText,click:function(){t.paste(t.clipBoardData),t.draw()}}),t.attributes.showColumnSelector&&(k.items.push({title:t.attributes.columnSelectorText,items:function(){var M=[];return t.getSchema().forEach(function(N){function v(H){N.hidden=!N.hidden,t.dispatchEvent("togglecolumn",{column:N,hidden:N.hidden}),H.preventDefault(),t.stopPropagation(H),t.disposeContextMenu(),t.resize(!0),t.setStorageData()}var Y=document.createElement("div");e(Y),Y.addEventListener("touchstart",v),Y.addEventListener("click",v),Y.innerHTML=(N.hidden?t.attributes.columnSelectorHiddenText:t.attributes.columnSelectorVisibleText)+(N.title||N.name),M.push({title:Y})}),M}}),k.cell&&k.cell.header&&k.cell.columnIndex>-1)){var Ot=k.cell.columnIndex,X=t.orders.columns[Ot],vt=t.getSelectedContiguousColumns(at),K="";if(vt)K=vt.map((function(M){return _newArrowCheck(this,rt),M.title||M.name}).bind(this)).join("-");else{var Bt=at[X];Bt&&(K=Bt.title||Bt.name)}k.items.push({title:t.attributes.hideColumnText.replace(/%s/gi,K),click:function(M){M.preventDefault(),t.stopPropagation(M),t.disposeContextMenu(),vt?t.hideColumns(vt[0].orderIndex,vt[1].orderIndex):t.hideColumns(Ot)}})}if(t.attributes.saveAppearance&&t.attributes.showClearSettingsOption&&(Object.keys(t.sizes.rows).length>0||Object.keys(t.sizes.columns).length>0)&&k.items.push({title:t.attributes.clearSettingsOptionText,click:function(M){M.preventDefault(),t.sizes.rows={},t.sizes.columns={},t.createRowOrders(),t.createColumnOrders(),t.storedSettings=void 0,t.dispatchEvent("resizecolumn",{columnWidth:t.style.cellWidth}),t.dispatchEvent("resizerow",{cellHeight:t.style.cellHeight}),t.setStorageData(),t.resize(!0),t.disposeContextMenu(),t.controlInput.focus()}}),t.attributes.allowSorting&&t.attributes.showOrderByOption&&ht&&(k.items.push({title:t.attributes.showOrderByOptionTextAsc.replace("%s",k.cell.header.title||k.cell.header.name),click:function(M){M.preventDefault(),t.order(k.cell.header.name,"asc"),t.controlInput.focus()}}),k.items.push({title:t.attributes.showOrderByOptionTextDesc.replace("%s",k.cell.header.title||k.cell.header.name),click:function(M){M.preventDefault(),t.order(k.cell.header.name,"desc"),t.disposeContextMenu(),t.controlInput.focus()}})),!wt&&k.cell.isRowHeader&&k.cell.header){var ce=t.getSelectedContiguousRows(!0);if(ce){var Ht,Ft=ce.map((function(M){return _newArrowCheck(this,rt),t.getBoundRowIndexFromViewRowIndex(M)}).bind(this));Ft.length===1?(Ht=typeof Ft[0]=="number"?Ft[0]+1:ce[0]+1,Ht=t.attributes.showHideRow.replace("%s",Ht),k.items.push({title:Ht,click:function(M){M.preventDefault(),t.hideRows(Ft[0],Ft[0])}})):Ft[0]<=Ft[1]&&(Ht=Ft.map((function(M,N){return _newArrowCheck(this,rt),typeof M=="number"?M+1:ce[N]+1}).bind(this)).join("-"),Ht=t.attributes.showHideRows.replace("%s",Ht),k.items.push({title:Ht,click:function(M){M.preventDefault(),t.hideRows(Ft[0],Ft[1])}}))}}var de=t.getColumnGroupAreaHeight(),ye=t.getRowGroupAreaWidth(),ue=(function(M,N){if(_newArrowCheck(this,rt),M.length!==0){for(var v=0;v<M.length;v++)for(var Y=M[v],H=0;H<Y.length;H++)Y[H].collapsed=N;t.refresh()}}).bind(this);k.pos&&k.pos.y<de&&(k.items.push({title:t.attributes.showRemoveAllGroupColumns,click:function(M){M.preventDefault(),t.groupedColumns=[],t.refresh()}}),k.items.push({title:t.attributes.showExpandAllGroupColumns,click:function(M){M.preventDefault(),ue(t.groupedColumns,!1)}}),k.items.push({title:t.attributes.showCollapseAllGroupColumns,click:function(M){M.preventDefault(),ue(t.groupedColumns,!0)}})),k.pos&&k.pos.x<ye&&(k.items.push({title:t.attributes.showRemoveAllGroupRows,click:function(M){M.preventDefault(),t.groupedRows=[],t.refresh()}}),k.items.push({title:t.attributes.showExpandAllGroupRows,click:function(M){M.preventDefault(),ue(t.groupedRows,!1)}}),k.items.push({title:t.attributes.showCollapseAllGroupRows,click:function(M){M.preventDefault(),ue(t.groupedRows,!0)}}));var Be=t.attributes.allowGroupingColumns&&k.cell.isColumnHeader&&k.cell.header&&k.cell.header.index>0,ee=t.attributes.allowGroupingColumns&&k.cell.isColumnHeader,kt=!wt&&t.attributes.allowGroupingRows&&k.cell.isRowHeader&&k.cell.header,xe=t.attributes.allowGroupingRows&&k.cell.isRowHeader;if(Be){for(var Dt=[],Wt=k.cell.header.index,Gt=Wt;Gt>=0&&t.isColumnSelected(Gt);Gt--)Dt[0]=Gt;for(Gt=Wt;t.isColumnSelected(Gt);Gt++)Dt[1]=Gt;if(Gt!==Wt&&Dt.length===2&&Dt[1]>Dt[0]&&t.isNewGroupRangeValid(t.groupedColumns,Dt[0],Dt[1])){for(var qt=ut(),Ce=[],ae=[],Et=0;Et<Dt.length;Et++){var pe=Dt[Et],Xt=qt.get(pe);Xt&&(ae.push(Xt.name),Ce.push(Xt.title||Xt.name||Xt.index))}ae[0]&&ae[1]&&k.items.push({title:t.attributes.showGroupColumns.replace("%s",Ce[0]+"-"+Ce[1]),click:function(M){M.preventDefault(),t.groupColumns(ae[0],ae[1]),t.controlInput.focus()}})}}if(ee)for(var we=k.cell.columnIndex,be=t.getGroupsColumnBelongsTo(we),re=ut(),Te=function(M){var N=be[M],v=N.from,Y=N.to,H=re.get(v),nt=re.get(Y);if(H&&nt){var Ct=(H.title||H.name||H.index)+"-"+(nt.title||nt.name||nt.index);k.items.push({title:t.attributes.showRemoveGroupColumns.replace("%s",Ct),click:function(st){st.preventDefault(),t.removeGroupColumns(H.name,nt.name),t.controlInput.focus()}})}else console.warn("Cannot find column ".concat(v," or column ").concat(Y))},y=0;y<be.length;y++)Te(y);if(kt){var S=t.getSelectedContiguousRows(!1)||[],G=S.map((function(M){_newArrowCheck(this,rt);var N=t.getBoundRowIndexFromViewRowIndex(M);return typeof N=="number"?N+1:M+1}).bind(this)).join("-");S.length===2&&t.isNewGroupRangeValid(t.groupedRows,S[0],S[1])&&k.items.push({title:t.attributes.showGroupRows.replace("%s",G),click:function(M){M.preventDefault(),t.groupRows(S[0],S[1])}})}if(xe)for(var ot=k.cell.rowIndex,z=t.getGroupsRowBelongsTo(ot),_=function(M){var N=this,v=z[M],Y=v.from,H=v.to,nt=[Y,H].map((function(Ct){_newArrowCheck(this,N);var st=t.getBoundRowIndexFromViewRowIndex(Ct);return typeof st=="number"?st+1:Ct+1}).bind(this)).join("-");k.items.push({title:t.attributes.showRemoveGroupRows.replace("%s",nt),click:function(Ct){Ct.preventDefault(),t.removeGroupRows(Y,H),t.controlInput.focus()}})},E=0;E<z.length;E++)_(E)}(Z),i.type!=="mousedown"&&t.dispatchEvent("contextmenu",Z)||Z.cell.isGrid||(t.contextMenu&&t.disposeContextMenu(),j={left:J.x+J.rect.left+t.style.contextMenuMarginLeft+t.canvasOffsetLeft,top:J.y+J.rect.top+t.style.contextMenuMarginTop+t.canvasOffsetTop,right:Z.cell.width+Z.cell.x+J.rect.left,bottom:Z.cell.height+Z.cell.y+J.rect.top,height:Z.cell.height,width:Z.cell.width},t.mobile&&(j.left=t.style.mobileContextMenuMargin+"px",j.width=t.width-2*t.style.mobileContextMenuMargin+"px"),i.type=="mousedown"&&(j.top+=t.style.filterButtonMenuOffsetTop),t.contextMenu=o(Z,j,V),i.type=="mousedown"?window.addEventListener("mouseup",W):W(),i.preventDefault())}function W(){requestAnimationFrame(function(){document.addEventListener("click",t.disposeContextMenu),window.removeEventListener("mouseup",W)})}}}function button(t){var a;function l(e,o,n){var i=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div"),c={};if(!Array.isArray(o))throw new Error("createButton expects an array.");return c.wrapper=i,c.items=o,function(){var p={},h=t.scrollOffset(t.canvas);if(a===void 0&&(a=t.style.buttonZIndex),function(u){t.createInlineStyle(u,"canvas-datagrid-button-wrapper"),u.addEventListener("mouseover",function(){t.buttonMenu||t.createInlineStyle(u,"canvas-datagrid-button-wrapper:hover")}),u.addEventListener("mouseout",function(){t.buttonMenu||t.createInlineStyle(u,"canvas-datagrid-button-wrapper")})}(i),t.createInlineStyle(d,"canvas-datagrid-button-icon"),t.createInlineStyle(s,"canvas-datagrid-button-arrow"),p.x=e.left-h.left,p.y=e.top-h.top,p.height=0,a+=1,i.style.position="absolute",i.style.zIndex=a,i.style.left=p.x+"px",i.style.top=p.y+"px",i.left=e.left+t.scrollBox.scrollLeft,i.top=e.top+t.scrollBox.scrollTop,s.innerHTML=t.style.buttonArrowDownHTML,n){var m=document.createElement("img");m.setAttribute("src",n),m.style.maxWidth="100%",m.style.height="100%",d.appendChild(m)}i.appendChild(d),i.appendChild(s),document.body.appendChild(i),i.addEventListener("click",r)}(),c.dispose=function(){i.parentNode&&i.parentNode.removeChild(i)},c}function r(){if(t.buttonMenu)t.disposeButtonMenu();else{var e={left:t.button.wrapper.left-t.scrollBox.scrollLeft,top:t.button.wrapper.top+t.button.wrapper.offsetHeight-t.scrollBox.scrollTop};t.buttonMenu=function(o,n){var i,s=document.createElement("div"),d=-1,c={};function p(){function u(I,F){function D(L){L!==null&&(_typeof(L)!=="object"?(function(f){t.createInlineStyle(f,"canvas-datagrid-button-menu-item"+(t.mobile?"-mobile":"")),f.addEventListener("mouseover",function(){t.createInlineStyle(f,"canvas-datagrid-button-menu-item:hover")}),f.addEventListener("mouseout",function(){t.createInlineStyle(f,"canvas-datagrid-button-menu-item")})}(F),F.innerHTML=L):F.appendChild(L))}D(I.title),I.buttonMenuItemContainer=F,I.click&&F.addEventListener("click",function(L){I.click.apply(t,[L]),t.disposeButton()})}var g,w=_createForOfIteratorHelper(n);try{for(w.s();!(g=w.n()).done;){var R=g.value,T=document.createElement("div");u(R,T),s.appendChild(T)}}catch(I){w.e(I)}finally{w.f()}}function h(u){n[u].buttonMenuItemContainer.dispatchEvent(new Event("click"))}function m(){var u={},g=t.scrollOffset(t.canvas);a===void 0&&(a=t.style.buttonZIndex),p(),t.createInlineStyle(s,"canvas-datagrid-button-menu"+(t.mobile?"-mobile":"")),u.x=o.left-g.left,u.y=o.top-g.top,u.height=0,a+=1,s.style.position="absolute",s.style.zIndex=a,s.style.left=u.x+"px",s.style.top=u.y+"px",document.body.appendChild(s),(i=s.getBoundingClientRect()).bottom>window.innerHeight&&(u.y=t.button.wrapper.top-s.offsetHeight-t.scrollBox.scrollTop,u.y<0&&(u.y=t.style.buttonMenuWindowMargin),s.offsetHeight>window.innerHeight-t.style.buttonMenuWindowMargin&&(s.style.height=window.innerHeight-2*t.style.buttonMenuWindowMargin+"px")),i.right>window.innerWidth&&(u.x-=i.right-window.innerWidth+t.style.buttonMenuWindowMargin),u.x<0&&(u.x=t.style.buttonMenuWindowMargin),u.y<0&&(u.y=t.style.buttonMenuWindowMargin),s.style.left=u.x+"px",s.style.top=u.y+"px"}return c.buttonMenu=s,m(),c.clickIndex=h,c.rect=i,c.items=n,c.dispose=function(){s.parentNode&&s.parentNode.removeChild(s)},Object.defineProperty(c,"selectedIndex",{get:function(){return d},set:function(u){if(typeof u!="number"||isNaN(u)||!isFinite(u))throw new Error("Button menu selected index must be a sane number.");(d=u)>n.length-1&&(d=n.length-1),d<0&&(d=0),n.forEach(function(g,w){if(w===d)return t.createInlineStyle(g.buttonMenuItemContainer,"canvas-datagrid-button-menu-item:hover");t.createInlineStyle(g.buttonMenuItemContainer,"canvas-datagrid-button-menu-item")})}}),c}(e,t.button.items),t.createInlineStyle(t.button.wrapper,"canvas-datagrid-button-wrapper:active"),requestAnimationFrame(function(){document.addEventListener("click",t.disposeButtonMenu)})}}t.disposeButtonMenu=function(){t.buttonMenu&&(document.removeEventListener("click",t.disposeButtonMenu),t.buttonMenu.dispose(),t.buttonMenu=void 0,t.createInlineStyle(t.button.wrapper,"canvas-datagrid-button-wrapper:hover"))},t.disposeButton=function(e){e&&e.keyCode!==27||(document.removeEventListener("keydown",t.disposeButton),a=t.style.buttonZIndex,t.disposeButtonMenu(),t.button&&t.button.dispose(),t.button=void 0)},t.moveButtonPos=function(){t.button.wrapper.style.left=t.button.wrapper.left-t.scrollBox.scrollLeft+"px",t.button.wrapper.style.top=t.button.wrapper.top-t.scrollBox.scrollTop+"px",t.disposeButtonMenu()},t.attachButton=function(e,o,n){t.button&&t.disposeButton(),t.button=l(e,o,n),requestAnimationFrame(function(){document.addEventListener("keydown",t.disposeButton)})}}function dom(t){t.getClippingRect=function(a){var l=t.position(t.parentNode),r=t.position(a),e=t.scrollOffset(t.canvas),o={x:0,y:0,h:0,w:0},n={x:-1/0,y:-1/0,h:1/0,w:1/0},i=t.getColumnHeaderCellHeight(),s=t.getRowHeaderCellWidth();return l.top-=e.top,l.left-=e.left,r.top-=e.top,r.left-=e.left,o.h=l.top+l.height-a.offsetTop-t.style.scrollBarWidth,o.w=l.left+l.width-a.offsetLeft-t.style.scrollBarWidth,o.x=l.left+-1*r.left+s,o.y=l.top+-1*r.top+i,{x:o.x>n.x?o.x:n.x,y:o.y>n.y?o.y:n.y,h:o.h<n.h?o.h:n.h,w:o.w<n.w?o.w:n.w}},t.clipElement=function(a){var l=t.getClippingRect(a);l.w<0&&(l.w=0),l.h<0&&(l.h=0),a.style.clip="rect("+l.y+"px,"+l.w+"px,"+l.h+"px,"+l.x+"px)"},t.scrollOffset=function(a){for(var l=0,r=0,e=document.scrollingElement||{scrollLeft:0,scrollTop:0};a.parentNode&&a.nodeName!=="CANVAS-DATAGRID"&&a!==t.intf;)a.nodeType!=="canvas-datagrid-tree"&&a.nodeType!=="canvas-datagrid-cell"&&(l-=a.scrollLeft,r-=a.scrollTop),a=a.parentNode;return{left:l-e.scrollLeft,top:r-e.scrollTop}},t.resizeEditInput=function(){if(t.input&&t.input.editCell){var a=t.canvas.getBoundingClientRect(),l=t.scrollOffset(t.intf),r=t.style.gridBorderCollapse==="collapse"?1:2,e=t.style.cellBorderWidth*r,o=t.getVisibleCellByIndex(t.input.editCell.columnIndex,t.input.editCell.rowIndex)||{x:-100,y:-100,height:0,width:0};if(t.mobile)return t.input.style.left="0",t.input.style.top=t.height-t.style.mobileEditInputHeight-e-1+"px",t.input.style.height=t.style.mobileEditInputHeight+"px",void(t.input.style.width=t.width-e-1+"px");var n=t.getColumnGroupAreaHeight(),i=t.getRowGroupAreaWidth();if(t.parentNode){var s=t.parentNode,d=s.columnGroupsAreaHeight,c=s.rowGroupsAreaWidth;d&&(n+=d),c&&(i+=c)}t.input.style.left=a.left+o.x+t.canvasOffsetLeft-l.left+i+"px",t.input.style.top=a.top+o.y-t.style.cellBorderWidth+t.canvasOffsetTop-l.top+n+"px",t.input.style.height=o.height-e+"px",t.input.style.width=o.width-t.style.cellPaddingLeft+"px",t.clipElement(t.input)}},t.position=function(a,l){for(var r,e,o=0,n=0,i=a,s=!1;a.offsetParent&&a.nodeName!=="CANVAS-DATAGRID";){var d=a.nodeType==="canvas-datagrid-tree";d&&s||(o+=a.offsetLeft,n+=a.offsetTop,r=a.offsetHeight,e=a.offsetWidth),d&&(s=!0),a=a.offsetParent}return l?{left:o,top:n,height:r,width:e}:(a=i,{left:o+(i=t.scrollOffset(a)).left,top:n+i.top,height:r,width:e})},t.getLayerPos=function(a){var l=t.canvas.getBoundingClientRect(),r={x:a.clientX-l.left,y:a.clientY-l.top};return t.isChildGrid&&(r.x-=t.canvasOffsetLeft,r.y-=t.canvasOffsetTop,t.parentNode.rowGroupsAreaWidth&&(r.x-=t.parentNode.rowGroupsAreaWidth),t.parentNode.columnGroupsAreaHeight&&(r.y-=t.parentNode.columnGroupsAreaHeight)),{x:r.x,y:r.y,rect:l}},t.endEdit=function(a){var l=t.input.editCell,r=l.rowIndex;if(t.dispatchEvent("beforeendedit",{cell:l,newValue:t.input.value,oldValue:l.value,abort:function(){a=!0},input:t.input}))return!1;if(t.input.value!==l.value&&!a){if(t.changes[r]=t.changes[r]||{},t.changes[r][l.header.name]=t.input.value,l.data||(t.originalData[l.boundRowIndex]={},l.data=t.originalData[l.boundRowIndex]),l.data[l.header.name]=t.input.value,r===t.viewData.length){if(t.dispatchEvent("newrow",{value:t.input.value,defaultValue:l.value,aborted:a,cell:l,input:t.input}))return!1;t.addRow(l.data),t.createNewRowData()}t.draw(!0)}return t.input.parentNode&&t.input.parentNode.removeChild(t.input),t.intf.focus(),t.dispatchEvent("endedit",{cell:l,value:t.input.value,aborted:a,input:t.input}),t.input=void 0,!0},t.beginEditAt=function(a,l,r){var e=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.attributes.editable){t.input&&t.endEdit();var o,n,i,s,d,c=t.getVisibleCellByIndex(a,l);if(t.getSchema(),c&&c.header){if(i=c.header.enum,t.dispatchEvent("beforebeginedit",{cell:c,NativeEvent:r}))return!1;if(t.scrollIntoView(a,l),t.setActiveCell(a,l),o=t.getAdjacentCells(),t.input=i?document.createElement("select"):document.createElement(t.attributes.multiLine?"textarea":"input"),c=t.getVisibleCellByIndex(a,l)){i&&(typeof i=="function"?n=i.apply(t.intf,[{cell:c}]):Array.isArray(i)&&(n=i),n.forEach(function(m){var u,g,w=document.createElement("option");Array.isArray(m)?(u=m[0],g=m[1]):(u=m,g=m),u===c.value&&(d=!0),w.value=u,w.innerHTML=g,t.input.appendChild(w)}),d||((s=document.createElement("option")).value=c.value,s.innerHTML=c.value,t.input.appendChild(s)),t.input.addEventListener("change",function(){t.endEdit(),t.draw(!0)})),t.dispatchEvent("appendeditinput",{cell:c,input:t.input})||document.body.appendChild(t.input),t.createInlineStyle(t.input,t.mobile?"canvas-datagrid-edit-mobile-input":"canvas-datagrid-edit-input"),t.input.style.position="absolute",t.input.editCell=c,t.resizeEditInput(),t.input.style.zIndex=t.style.editCellZIndex,t.input.style.fontSize=parseInt(t.style.editCellFontSize,10)*t.scale+"px";var p=[null,void 0].indexOf(c.value)!==-1||e;t.input.value=p?"":c.value;var h=Math.round(t.input.value.length*parseInt(t.style.editCellFontSize,10)*.7*t.scale);h+t.style.cellPaddingLeft<c.width?h=c.width-t.style.cellPaddingLeft:h>t.width-c.x-t.style.scrollBarWidth&&(h=t.width-c.x-t.style.scrollBarWidth,t.input.style.height="auto"),t.input.style.width=h+"px",t.input.focus(),t.input.addEventListener("click",t.stopPropagation),t.input.addEventListener("dblclick",t.stopPropagation),t.input.addEventListener("mouseup",t.stopPropagation),t.input.addEventListener("mousedown",t.stopPropagation),t.input.addEventListener("keydown",function(m){var u=c.columnIndex,g=c.rowIndex;if(m.key==="Escape")t.endEdit(!0),t.draw(!0);else if(m.key==="Enter"&&t.attributes.multiLine&&m.altKey)t.input.value=t.input.value+`
`,t.input.scrollTop=t.input.scrollHeight;else if(m.key==="Enter"){t.endEdit();var w=m.shiftKey?Math.max(0,g-1):Math.min(g+1,t.viewData.length-1);w!==g&&(t.scrollIntoView(u,w),t.setActiveCell(u,w)),t.draw(!0)}else if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(m.key)&&e){switch(m.key){case"ArrowUp":g=Math.max(0,g-1);break;case"ArrowDown":g=Math.min(g+1,t.viewData.length-1);break;case"ArrowLeft":u=Math.max(u-1,0);break;case"ArrowRight":u=o.right}t.endEdit(),t.scrollIntoView(u,g),t.setActiveCell(u,g),t.draw(!0)}else if(m.key==="Tab"){if(m.preventDefault(),!t.endEdit())return;u=m.shiftKey?o.left:o.right,o.left===a&&m.shiftKey&&(u=o.last,g-=1),o.right!==a||m.shiftKey||(u=o.first,g+=1),g<0&&(g=t.viewData.length-1),g>t.viewData.length-1&&(g=0),t.scrollIntoView(u,g),t.beginEditAt(u,g,m)}else{var R=Math.round(t.input.value.length*parseInt(t.style.editCellFontSize,10)*.7*t.scale);R+t.style.cellPaddingLeft<c.width?R=c.width-t.style.cellPaddingLeft:R>t.width-c.x-t.style.scrollBarWidth&&(R=t.width-c.x-t.style.scrollBarWidth,t.input.style.height="auto"),t.input.style.width=R+"px"}}),t.dispatchEvent("beginedit",{cell:c,input:t.input})}}}},t.createInlineStyle=function(a,l){var r={"canvas-datagrid-button-wrapper":{display:"inline-block",padding:t.style.buttonPadding,borderWidth:"1px",borderStyle:"solid",borderColor:t.style.buttonBorderColor,cursor:"pointer",background:t.style.buttonBackgroundColor,userSelect:"none"},"canvas-datagrid-button-wrapper:hover":{borderColor:t.style.buttonBorderColor,background:t.style.buttonHoverBackgroundColor},"canvas-datagrid-button-wrapper:active":{borderColor:t.style.buttonActiveBorderColor,background:t.style.buttonActiveBackgroundColor},"canvas-datagrid-button-icon":{width:"18px",height:"18px",display:"inline-block",verticalAlign:"middle"},"canvas-datagrid-button-arrow":{display:"inline-block",color:t.style.buttonArrowColor,fontSize:"9px"},"canvas-datagrid-button-menu-item-mobile":{lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,color:"inherit",background:"inherit",margin:t.style.contextMenuItemMargin,borderRadius:t.style.contextMenuItemBorderRadius,verticalAlign:"middle"},"canvas-datagrid-button-menu-item":{lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,color:"inherit",background:"inherit",margin:t.style.contextMenuItemMargin,borderRadius:t.style.contextMenuItemBorderRadius,verticalAlign:"middle"},"canvas-datagrid-button-menu-item:hover":{background:t.style.contextMenuHoverBackground,color:t.style.contextMenuHoverColor},"canvas-datagrid-button-menu-label":{margin:t.style.contextMenuLabelMargin,display:t.style.contextMenuLabelDisplay,minWidth:t.style.contextMenuLabelMinWidth,maxWidth:t.style.contextMenuLabelMaxWidth},"canvas-datagrid-button-menu-mobile":{lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,background:t.style.contextMenuBackground,color:t.style.contextMenuColor,border:t.style.contextMenuBorder,padding:t.style.contextMenuPadding,borderRadius:t.style.contextMenuBorderRadius,opacity:t.style.contextMenuOpacity,overflow:"hidden",whiteSpace:"nowrap"},"canvas-datagrid-button-menu":{lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,background:t.style.contextMenuBackground,color:t.style.contextMenuColor,border:t.style.contextMenuBorder,padding:t.style.contextMenuPadding,borderRadius:t.style.contextMenuBorderRadius,opacity:t.style.contextMenuOpacity,overflow:"hidden",whiteSpace:"nowrap",cursor:t.style.contextMenuCursor},"canvas-datagrid-context-menu-filter-input":{height:"19px",verticalAlign:"bottom",marginLeft:"2px",padding:"0",background:t.style.contextFilterInputBackground,color:t.style.contextFilterInputColor,border:t.style.contextFilterInputBorder,borderRadius:t.style.contextFilterInputBorderRadius,lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextFilterInputFontFamily,fontSize:t.style.contextFilterInputFontSize},"canvas-datagrid-context-menu-filter-button":{height:"19px",verticalAlign:"bottom",marginLeft:"2px",padding:"0",background:t.style.contextMenuBackground,color:t.style.contextMenuColor,border:t.style.contextFilterButtonBorder,borderRadius:t.style.contextFilterButtonBorderRadius,lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFilterButtonFontFamily,fontSize:t.style.contextMenuFilterButtonFontSize},"canvas-datagrid-context-child-arrow":{cssFloat:"right",color:t.style.childContextMenuArrowColor,fontSize:t.style.contextMenuChildArrowFontSize,fontFamily:t.style.contextMenuFontFamily,verticalAlign:"middle"},"canvas-datagrid-autocomplete":{fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,background:t.style.contextMenuBackground,color:t.style.contextMenuColor,border:t.style.contextMenuBorder,padding:t.style.contextMenuPadding,borderRadius:t.style.contextMenuBorderRadius,opacity:t.style.contextMenuOpacity,position:"absolute",zIndex:9999,overflow:"hidden"},"canvas-datagrid-autocomplete-item":{background:t.style.contextMenuBackground,color:t.style.contextMenuColor},"canvas-datagrid-autocomplete-item:hover":{background:t.style.contextMenuHoverBackground,color:t.style.contextMenuHoverColor},"canvas-datagrid-canvas":{position:"absolute",zIndex:"-1"},"canvas-datagrid":{display:"block"},"canvas-datagrid-control-input":{position:"fixed",top:"-5px",left:"-5px",border:"none",opacity:"0",cursor:"pointer",width:"1px",height:"1px",lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize},"canvas-datagrid-edit-mobile-input":{boxSizing:"content-box",outline:"none",margin:"0",padding:"0 0 0 0",lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.mobileEditFontFamily,fontSize:t.style.mobileEditFontSize,border:t.style.editCellBorder,color:t.style.editCellColor,background:t.style.editCellBackgroundColor,appearance:"none",webkitAppearance:"none",mozAppearance:"none",borderRadius:"0"},"canvas-datagrid-edit-input":{boxSizing:"content-box",outline:"none",margin:"0",padding:"0 0 0 "+t.style.editCellPaddingLeft+"px",lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.editCellFontFamily,fontSize:t.style.editCellFontSize,boxShadow:t.style.editCellBoxShadow,border:t.style.editCellBorder,color:t.style.editCellColor,background:t.style.editCellBackgroundColor,appearance:"none",webkitAppearance:"none",mozAppearance:"none",borderRadius:"0"},"canvas-datagrid-context-menu-item-mobile":{lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,color:"inherit",background:"inherit",margin:t.style.contextMenuItemMargin,borderRadius:t.style.contextMenuItemBorderRadius,verticalAlign:"middle"},"canvas-datagrid-context-menu-item":{lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,color:"inherit",background:"inherit",margin:t.style.contextMenuItemMargin,borderRadius:t.style.contextMenuItemBorderRadius,verticalAlign:"middle"},"canvas-datagrid-context-menu-item:hover":{background:t.style.contextMenuHoverBackground,color:t.style.contextMenuHoverColor},"canvas-datagrid-context-menu-label":{margin:t.style.contextMenuLabelMargin,display:t.style.contextMenuLabelDisplay,minWidth:t.style.contextMenuLabelMinWidth,maxWidth:t.style.contextMenuLabelMaxWidth},"canvas-datagrid-context-menu-mobile":{lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,background:t.style.contextMenuBackground,color:t.style.contextMenuColor,border:t.style.contextMenuBorder,padding:t.style.contextMenuPadding,borderRadius:t.style.contextMenuBorderRadius,opacity:t.style.contextMenuOpacity,overflow:"hidden",whiteSpace:"nowrap"},"canvas-datagrid-context-menu":{lineHeight:"normal",fontWeight:"normal",fontFamily:t.style.contextMenuFontFamily,fontSize:t.style.contextMenuFontSize,background:t.style.contextMenuBackground,color:t.style.contextMenuColor,border:t.style.contextMenuBorder,padding:t.style.contextMenuPadding,borderRadius:t.style.contextMenuBorderRadius,opacity:t.style.contextMenuOpacity,overflow:"hidden",whiteSpace:"nowrap",cursor:t.style.contextMenuCursor},"canvas-datagrid-invalid-search-regExp":{background:t.style.contextMenuFilterInvalidExpresion}};r[l]&&(Object.keys(r[l]).map(function(e){a.style[e]=r[l][e]}),a.className=l)},t.appendTo=function(a){t.parentNode=a,t.setDom()},t.setDom=function(){t.isChildGrid?(t.parentGrid=t.parentNode.parentGrid,t.ctx=t.parentGrid.context,t.canvas=t.parentGrid.canvas,t.controlInput=t.parentGrid.controlInput,t.eventParent=t.canvas):(t.controlInput=t.controlInput||document.createElement("input"),t.controlInput.onblur=t.intf.blur,t.createInlineStyle(t.controlInput,"canvas-datagrid-control-input"),t.isChildGrid=!1,t.parentDOMNode=t.parentNode,t.parentIsCanvas=/^canvas$/i.test(t.parentDOMNode.tagName),t.parentIsCanvas?t.canvas=t.parentDOMNode:(t.canvas=document.createElement("canvas"),t.parentDOMNode.appendChild(t.canvas)),document.body.appendChild(t.controlInput),t.createInlineStyle(t.canvas,"canvas-datagrid"),t.ctx=t.canvas.getContext("2d"),t.ctx.textBaseline="alphabetic",t.eventParent=t.canvas),t.parentNodeStyle=t.canvas.style,t.controlInput.setAttribute("readonly",!0),t.controlInput.addEventListener("blur",function(a){a.target!==t.canvas&&(t.hasFocus=!1)}),t.eventParent.addEventListener("scroll",t.resize,!1),t.eventParent.addEventListener("touchstart",t.touchstart,!1),t.eventParent.addEventListener("mousedown",t.mousedown,!1),t.eventParent.addEventListener("dblclick",t.dblclick,!1),t.eventParent.addEventListener("click",t.click,!1),t.eventParent.addEventListener("mouseup",t.mouseup,!1),window.addEventListener("mousemove",t.mousemove),t[t.isChildGrid?"parentGrid":"eventParent"].addEventListener("wheel",t.scrollWheel,!1),t.canvas.addEventListener("contextmenu",t.contextmenuEvent,!1),t.controlInput.addEventListener("copy",t.copy),t.controlInput.addEventListener("cut",t.cut),t.controlInput.addEventListener("paste",t.paste),t.controlInput.addEventListener("keypress",t.keypress,!1),t.controlInput.addEventListener("keyup",t.keyup,!1),t.controlInput.addEventListener("keydown",t.keydown,!1),window.addEventListener("resize",t.resize)}}var mergeHiddenRowRanges=function(t,a){var l=this,r=_slicedToArray(a,2),e=r[0],o=r[1];if(o<e)return!1;for(var n=!1,i=0;i<t.length;i++){var s=t[i];if(!(e>s[1]+1)){if(e<=s[0]&&o>=s[0]){t[i]=[e,Math.max(o,s[1])],n=!0;break}if(e>=s[0]){t[i]=[s[0],Math.max(o,s[1])],n=!0;break}}}n||t.push([e,o]),t.sort((function(h,m){return _newArrowCheck(this,l),h[0]-m[0]}).bind(this));for(var d=0;d<t.length-1;d++){var c=t[d],p=t[d+1];p[0]<=c[1]+1&&(t[d]=[c[0],Math.max(c[1],p[1])],t.splice(d+1,1),d--)}return!0};function publicMethods(t){function a(r,e,o){for(var n=!1,i=r==="rows"?t.groupedRows:t.groupedColumns,s=i.length-1;s>=0;s--){var d=i[s],c=d[0].from,p=d[d.length-1].to;if(e<=c&&o>=p){if(e===c&&o===p&&d.length===1)return}else{for(var h=0;h<d.length;h++){var m=d[h];if(!(e>m.to)){if(e>=m.from){if(o>m.to){if(e===m.from)return i.splice(s,0,[{from:e,to:o,collapsed:!1}]),void t.refresh();throw new Error("Can't group these ".concat(r))}if(o===m.to&&e===m.from)return;n=!0;break}if(o>=m.from){if(o<m.to)throw new Error("Can't group these ".concat(r));i.splice(s,0,[{from:e,to:o,collapsed:!1}])}else d.splice(h,0,{from:e,to:o,collapsed:!1});return void t.refresh()}}if(!n)return d.push({from:e,to:o,collapsed:!1}),void t.refresh()}}n?i.push([{from:e,to:o,collapsed:!1}]):i.unshift([{from:e,to:o,collapsed:!1}]),t.refresh()}function l(r,e,o){for(var n=0;n<r.length;n++)for(var i=r[n],s=0;s<i.length;s++){var d=i[s];if(d.from===e&&d.to===o)return i.length<=1?r.splice(n,1):i.splice(s,1),void t.refresh()}}t.integerToAlpha=function(r){for(var e=97,o=122-e+1,n="";r>=0;)n=String.fromCharCode(r%o+e)+n,r=Math.floor(r/o)-1;return n},t.insertColumn=function(r,e){var o=t.getSchema();if(o.length<e)throw new Error("Index is beyond the length of the schema.");t.validateColumn(r,o),o.splice(e,0,r),t.originalData.forEach(function(n,i){t.applyDefaultValue(n,r,i)}),t.intf.schema=o,t.refresh()},t.deleteColumn=function(r){var e=t.getSchema();t.originalData.forEach(function(o){delete o[e[r].name]}),e.splice(r,1),t.intf.schema=e,t.refresh()},t.addColumn=function(r){var e=t.getSchema();t.validateColumn(r,e),e.push(r),t.originalData.forEach(function(o,n){t.applyDefaultValue(o,r,n)}),t.intf.schema=e,t.refresh()},t.deleteRow=function(r){t.originalData.splice(r,1),t.setFilter(),t.resize(!0)},t.insertRow=function(r,e){if(t.originalData.length<e)throw new Error("Index is beyond the length of the dataset.");t.originalData.splice(e,0,r),t.getSchema().forEach(function(o){r[o.name]===void 0&&t.applyDefaultValue(t.originalData[e],o,e)}),t.setFilter(),t.resize(!0)},t.addRow=function(r){t.originalData.push(r),t.getSchema().forEach(function(e){r[e.name]===void 0&&t.applyDefaultValue(t.originalData[t.originalData.length-1],e,t.originalData.length-1)}),t.setFilter(),t.resize(!0)},t.setRowHeight=function(r,e){t.sizes.rows[r]=e,t.draw(!0)},t.setColumnWidth=function(r,e){t.sizes.columns[r]=e,t.draw(!0)},t.resetColumnWidths=function(){t.sizes.columns={},t.draw(!0)},t.resetRowHeights=function(){t.sizes.rows={},t.draw(!0)},t.setFilter=function(r,e){r===void 0&&e===void 0?t.columnFilters={}:!r||e!==""&&e!==void 0?(t.columnFilters[r]=e,t.attributes.showFilterInCell&&(t.filterable.rows.push(0),t.orders.columns.forEach(function(o,n){t.filterable.columns.push(n)}))):delete t.columnFilters[r],Object.keys(t.columnFilters).length||(t.filterable={rows:[],columns:[]}),t.refresh()},t.findRowScrollTop=function(r){if(t.scrollCache.y[r]===void 0)throw new RangeError("Row index ".concat(r," out of range: ").concat(t.scrollCache.y.length,"."));return t.scrollCache.y[r]},t.findColumnScrollLeft=function(r){var e=Math.max(r-1,0);if(t.scrollCache.x[e]===void 0)throw new Error("Column index out of range.");return t.scrollCache.x[e]-t.getColumnWidth(t.orders.columns[r])},t.gotoCell=function(r,e,o,n){var i,s=r===void 0?void 0:t.findColumnScrollLeft(r),d=e===void 0?void 0:t.findRowScrollTop(e),c=t.scrollBox.width-(t.scrollBox.verticalBarVisible?t.style.scrollBarWidth:0),p=t.scrollBox.height-(t.scrollBox.horizontalBarVisible?t.style.scrollBarWidth:0);s-=c*(o=o===void 0?0:o),d-=p*(n=n===void 0?0:n),r!==void 0&&e!==void 0?(t.scrollBox.scrollTo(s,d),requestAnimationFrame(function(){(i=t.getVisibleCellByIndex(r,e))&&(s+=i.width*o,d+=i.height*n,t.scrollBox.scrollTo(s,d))})):r!==void 0?t.scrollBox.scrollLeft=s:e!==void 0&&(t.scrollBox.scrollTop=d)},t.gotoRow=function(r){t.gotoCell(0,r)},t.addButton=function(r,e,o,n,i){var s=t.visibleCells.filter(function(d){return d.sortColumnIndex===r&&d.sortRowIndex===e});t.attachButton({top:s[0].y+s[0].height+o.y,left:s[0].x+s[0].width+o.x},n,i)},t.toggleCellCollapseTree=function(r){for(var e in r){var o,n=_createForOfIteratorHelper(r[e]);try{for(n.s();!(o=n.n()).done;){var i=o.value;i.length>0&&t.toggleCollapseTree(i[0],i[1],e)}}catch(s){n.e(s)}finally{n.f()}}t.draw()},t.expandCollapseCellTree=function(r){for(var e in r){var o,n=_createForOfIteratorHelper(r[e]);try{for(n.s();!(o=n.n()).done;){var i=o.value;i.length>0&&t.cellTreeExpandCollapse(i[0],i[1],e)}}catch(s){n.e(s)}finally{n.f()}}t.draw()},t.scrollIntoView=function(r,e,o,n){var i=t.visibleCells.filter(function(s){return(s.rowIndex===e||e===void 0)&&(s.columnIndex===r||r===void 0)&&s.x>0&&s.y>0&&s.x+s.width<t.width&&s.y+s.height<t.height});i.length===1&&r!==void 0&&e!==void 0&&(i[0].x<t.getRowHeaderCellWidth()||i[0].y<t.getColumnHeaderCellHeight())&&(i.length=0),i.length===0&&t.gotoCell(r,e,o,n)},t.setActiveCell=function(r,e){r!==void 0&&(r<0&&(r=0),e<0&&(e=0),t.activeCell={rowIndex:e,columnIndex:r})},t.collapseTree=function(r){t.dispatchEvent("collapsetree",{childGrid:t.childGrids[r],data:t.viewData[r],rowIndex:r}),t.openChildren[r].blur(),t.openChildren[r].dispose(),delete t.openChildren[r],delete t.sizes.trees[r],delete t.childGrids[r],t.dispatchEvent("resizerow",{cellHeight:t.style.cellHeight}),t.resize(!0),t.draw(!0)},t.expandTree=function(r){var e,o=t.args.treeGridAttributes||{},n=t.getColumnHeaderCellHeight(),i=t.sizes.columns.cornerCell||t.style.rowHeaderCellWidth,s=t.sizes.trees[r]||t.style.treeGridHeight;t.childGrids[r]||(o.debug=t.attributes.debug,o.name=t.attributes.saveAppearance?t.attributes.name+"tree"+r:void 0,o.style=o.style||t.style,o.parentNode={parentGrid:t.intf,nodeType:"canvas-datagrid-tree",offsetHeight:s,offsetWidth:t.width-i,header:{width:t.width-i},offsetLeft:i,offsetTop:n,offsetParent:t.intf.parentNode,parentNode:t.intf.parentNode,style:"tree",data:t.viewData[r]},e=t.createGrid(o),t.childGrids[r]=e),(e=t.childGrids[r]).visible=!0,t.dispatchEvent("expandtree",{treeGrid:e,data:t.viewData[r],rowIndex:r}),t.openChildren[r]=e,t.sizes.trees[r]=s,t.dispatchEvent("resizerow",{height:t.style.cellHeight}),t.resize(!0)},t.toggleTree=function(r){if(t.openChildren[r])return t.collapseTree(r);t.expandTree(r)},t.getHeaderByName=function(r){var e,o=t.getSchema();for(e=0;e<o.length;e+=1)if(o[e].name===r)return o[e]},t.hideColumns=function(r,e){var o=t.getSchema(),n=t.orders.columns,i=[];typeof e!="number"&&(e=r);for(var s=r;s<=e;s++){var d=n[s];d>=0&&!o[d].hidden&&(i.push(d),o[d].hidden=!0,t.dispatchEvent("columnhide",{columnIndex:d}))}i.length>0&&(t.setStorageData(),setTimeout(function(){t.resize(!0)},10)),t.dispatchEvent("hidecolumns",{hiddenColumns:i})},t.unhideColumns=function(r,e){for(var o=t.orders.columns,n=t.getSchema(),i=r;i<=e;i++){var s=o[i],d=n[s];d&&d.hidden&&(d.hidden=!1,t.dispatchEvent("columnunhide",{columnIndex:s}))}t.refresh()},t.hideRows=function(r,e){mergeHiddenRowRanges(t.hiddenRowRanges,[r,e])&&t.refresh()},t.unhideRows=function(r,e){var o=this;t.hiddenRowRanges=t.hiddenRowRanges.filter((function(n){return _newArrowCheck(this,o),n[0]!==r||n[1]!==e}).bind(this)),t.refresh()},t.fitColumnToValues=function(r,e){if(t.canvas){var o=r==="cornerCell"?-1:t.getHeaderByName(r).index,n=Math.max(t.findColumnMaxTextLength(r),t.style.minColumnWidth);t.sizes.columns[o]=n,t.dispatchEvent("resizecolumn",{x:n,y:t.resizingStartingHeight,draggingItem:t.currentCell}),e||(t.resize(),t.draw(!0))}},t.isCellVisible=function(r,e){if(e!==void 0)return t.visibleCells.filter(function(i){return i.columnIndex===r&&i.rowIndex===e}).length>0;var o,n=t.visibleCells.length;for(o=0;o<n;o+=1)if(r.x===t.visibleCells[o].x&&r.y===t.visibleCells[o].y)return!0;return!1},t.order=function(r,e,o,n){if(t.attributes.allowSorting){var i,s=t.getSchema().filter(function(d){return d.name===r});if(!t.dispatchEvent("beforesortcolumn",{name:r,direction:e})&&(t.orderBy=r,t.orderDirection=e,t.viewData&&t.viewData.length!==0)){if(s.length===0)throw new Error("Cannot sort.  No such column name");(i=o||s[0].sorter||t.sorters[s[0].type])||s[0].type===void 0||console.warn('Cannot sort type "%s" falling back to string sort.',s[0].type),t.orderings.add(r,e,typeof i=="function"?i:t.sorters.string),t.refresh(),t.dispatchEvent("sortcolumn",{name:r,direction:e}),n||t.setStorageData()}}else t.refresh()},t.groupColumns=function(r,e){for(var o,n,i=t.getSchema(),s=0;s<i.length;s++){var d=i[s];if(o&&n)break;d.name!==r?d.name!==e||(n=d):o=d}if(!o)throw new Error("No such column name for first column");if(!n)throw new Error("No such column name for last column");if(!(n.columnIndex>o.columnIndex))throw new Error("Can't group these columns");var c=o.columnIndex,p=n.columnIndex,h={group:{type:"columns",from:c,to:p}};try{a("columns",c,p)}catch(m){h.error=m}t.dispatchEvent("aftercreategroup",h)},t.groupRows=function(r,e){if(!Number.isInteger(r)||r<0)throw new Error("No such row for the beginning of the group");var o=t.viewData.length;if(!Number.isInteger(r)||e<=r||e>=o)throw new Error("No such row for the end of the group");var n={group:{type:"rows",from:r,to:e}};try{a("rows",r,e)}catch(i){n.error=i}t.dispatchEvent("aftercreategroup",n)},t.removeGroupColumns=function(r,e){for(var o,n,i=t.getSchema(),s=0;s<i.length;s++){var d=i[s];if(o&&n)break;d.name!==r?d.name!==e||(n=d):o=d}if(!o)throw new Error("No such column name for first column");if(!n)throw new Error("No such column name for last column");var c=o.columnIndex,p=n.columnIndex;l(t.groupedColumns,c,p)},t.removeGroupRows=function(r,e){l(t.groupedRows,r,e)},t.toggleGroupColumns=function(r,e){for(var o,n,i=t.getSchema(),s=0;s<i.length;s++){var d=i[s];if(o&&n)break;d.name!==r?d.name!==e||(n=d):o=d}if(o&&n){var c=o.columnIndex,p=n.columnIndex;t.toggleGroup({type:"c",from:c,to:p})&&(t.disposeContextMenu(),t.setStorageData(),t.refresh())}},t.toggleGroupRows=function(r,e){t.toggleGroup({type:"r",from:r,to:e})&&(t.disposeContextMenu(),t.setStorageData(),t.refresh())},t.isInGrid=function(r){return!(r.x<0||r.x>t.width||r.y<0||r.y>t.height)},t.moveTo=function(r,e,o){r=t.getObsoleteSelectionMatrix(r);var n,i=t.getSelectedData(),s=t.getVisibleSchema(),d=r.length,c=-1/0,p=1/0,h=o-1;r.forEach(function(m,u){u!==d&&m.length!==0&&(p=Math.min(t.getVisibleColumnIndexOf(e),p),c=Math.max(c,m.length),m.forEach(function(g){g=t.getVisibleColumnIndexOf(g),s[g]&&(t.data||(t.data={}),t.data[u]||(t.data[u]={}),t.data[u][s[g].name]=null)}))}),r.forEach(function(m,u){var g;h+=1,n=t.getVisibleColumnIndexOf(e),m.forEach(function(w,R){w=t.getVisibleColumnIndexOf(w),R>0&&(n+=w-g),g=w,w===-1||!s[n]||!s[w]||t.data.length-1<h||h<0||(t.data[h]||(t.data[h]={}),t.data[h][s[n].name]=i[u][s[w].name])})})},t.getGroupsColumnBelongsTo=function(r){if(!t.attributes.allowGroupingColumns)return[];for(var e=[],o=0;o<t.groupedColumns.length;o++)for(var n=t.groupedColumns[o],i=0;i<n.length;i++){var s=n[i];if(r>=s.from&&r<=s.to){e.push(s);break}}return e},t.getGroupsRowBelongsTo=function(r){if(!t.attributes.allowGroupingRows)return[];for(var e=[],o=0;o<t.groupedRows.length;o++)for(var n=t.groupedRows[o],i=0;i<n.length;i++){var s=n[i];if(r>=s.from&&r<=s.to){e.push(s);break}}return e},t.isColumnVisible=function(r){return t.visibleCells.filter(function(e){return e.columnIndex===r}).length>0},t.isRowVisible=function(r){return t.visibleCells.filter(function(e){return e.rowIndex===r}).length>0},t.getVisibleCellByIndex=function(r,e){return t.visibleCells.filter(function(o){return o.columnIndex===r&&o.rowIndex===e})[0]},t.getUnhideIndicator=function(r,e){var o=t.visibleUnhideIndicators;if(!(o.length<=0))for(var n=0;n<o.length;n++){var i=o[n];if(r>=i.x&&e>=i.y&&r<=i.x2&&e<=i.y2)return i}},t.getColumnGroupAt=function(r,e){if(!(t.groupedColumns.length<=0)&&!(e>=t.getColumnGroupAreaHeight()))for(var o=0;o<t.visibleGroups.length;o++){var n=t.visibleGroups[o];if(n.type==="c"&&r>=n.x&&e>=n.y&&r<=n.x2&&e<=n.y2)return n}},t.getRowGroupAt=function(r,e){if(!(t.groupedRows.length<=0)&&!(r>=t.getRowGroupAreaWidth()))for(var o=0;o<t.visibleGroups.length;o++){var n=t.visibleGroups[o];if(n.type==="r"&&r>=n.x&&e>=n.y&&r<=n.x2&&e<=n.y2)return n}},t.getCellAt=function(r,e,o){function n(R){return R.x+R.width-.4*t.attributes.borderResizeZone<r&&R.x+R.width+.6*t.attributes.borderResizeZone>r?"r":R.x-.4*t.attributes.borderResizeZone<r&&R.x+.6*t.attributes.borderResizeZone>r?"l":R.y+R.height-.4*t.attributes.borderResizeZone<e&&R.y+R.height+.6*t.attributes.borderResizeZone>e?"b":R.y-.4*t.attributes.borderResizeZone<e&&R.y+.6*t.attributes.borderResizeZone>e?"t":void 0}if(t.visibleCells){r-=t.getRowGroupAreaWidth(),e-=t.getColumnGroupAreaHeight(),t.dragStartObject!==void 0&&(r<=0&&(r=1),r>=t.width&&(r=t.width-1),e<=0&&(e=1),e>=t.height&&(e=t.height-1));var i,s,d,c,p,h=o?t.attributes.touchScrollZone:0,m=t.attributes.borderDragBehavior==="move",u=t.visibleCells.length,g=m?t.cursorGrab:"ew-resize",w=m?t.cursorGrab:"ns-resize";if(t.visibleCells&&t.visibleCells.length){if(t.hasFocus=!0,!(e<t.height&&e>0&&r<t.width&&r>0))return t.hasFocus=!1,{dragContext:"inherit",context:"inherit"};for(s=0;s<u;s+=1)if(p={x:(c=t.visibleCells[s]).x,y:c.y,height:c.height,width:c.width},o&&/(vertical|horizontal)-scroll-/.test(c.style)&&(p.x-=h,p.y-=h,p.height+=h,p.width+=h),p.x-t.style.cellBorderWidth<r&&p.x+p.width+t.style.cellBorderWidth>r&&p.y-t.style.cellBorderWidth<e&&p.y+p.height+t.style.cellBorderWidth>e){if(/frozen-row-marker/.test(c.style)){if(t.dragMode==="frozen-column-marker")continue;return c.dragContext=c.style,c.context="grab",c}if(/frozen-column-marker/.test(c.style)){if(t.dragMode==="frozen-row-marker")continue;return c.dragContext=c.style,c.context="grab",c}if(/selection-handle-/.test(c.style))return c.dragContext=c.style,c.context="crosshair",c;if(/vertical-scroll-(bar|box)/.test(c.style))return c.dragContext="vertical-scroll-box",c.context="vertical-scroll-box",c.isScrollBar=!0,c.isVerticalScrollBar=!0,e>t.scrollBox.box.v.y+t.scrollBox.scrollBoxHeight?(c.dragContext="vertical-scroll-bottom",c.context="vertical-scroll-bottom"):e<t.scrollBox.box.v.y&&(c.dragContext="vertical-scroll-top",c.context="vertical-scroll-top"),t.cursor="default",c;if(/horizontal-scroll-(bar|box)/.test(c.style))return c.dragContext="horizontal-scroll-box",c.context="horizontal-scroll-box",c.isScrollBar=!0,c.isHorizontalScrollBar=!0,r>t.scrollBox.box.h.x+t.scrollBox.scrollBoxWidth?(c.dragContext="horizontal-scroll-right",c.context="horizontal-scroll-right"):r<t.scrollBox.box.h.x&&(c.dragContext="horizontal-scroll-left",c.context="horizontal-scroll-left"),t.cursor="default",c;if(i=n(p),d=m&&c.selectionBorder&&c.selectionBorder.indexOf(i)!==-1,["l","r"].indexOf(i)!==-1&&(t.attributes.allowColumnResize||d)&&(t.attributes.allowColumnResizeFromCell&&c.isNormal||!c.isNormal||d)&&(t.attributes.allowRowHeaderResize&&(c.isRowHeader||c.isCorner)||!c.isRowHeader||!c.isCorner)){if((c.isColumnHeader||c.isCorner||t.attributes.allowColumnResizeFromCell&&c.isNormal)&&i==="r")return c.context="ew-resize",c.dragContext="ew-resize",c;if(!c.isColumnHeader&&!c.isCorner&&d)return c.context=g,c.dragContext=i+"-move",c}if(["t","b"].indexOf(i)!==-1&&c.rowIndex>-1&&(t.attributes.allowRowResize||d)&&(t.attributes.allowRowResizeFromCell&&c.isNormal||!c.isNormal||d)&&!c.isColumnHeader){if((c.isRowHeader||c.isCorner||t.attributes.allowRowResizeFromCell&&c.isNormal)&&i==="b")return c.context="ns-resize",c.dragContext="ns-resize",c;if(!c.isRowHeader&&!c.isCorner&&d)return c.context=w,c.dragContext=i+"-move",c}return c.style==="columnHeaderCell"?(!t.isColumnSelected(c.columnIndex)&&c.x+c.width-t.attributes.columnGrabZoneSize-t.style.cellBorderWidth>r||!t.attributes.allowRowReordering?(c.dragContext="cell",c.context="cell"):(c.context=t.cursorGrab,c.dragContext="column-reorder"),c):c.style==="rowHeaderCell"?(!t.isRowSelected(c.rowIndex)&&t.attributes.rowGrabZoneSize+(c.y-t.style.cellBorderWidth)<e||!t.attributes.allowRowReordering?(c.dragContext="cell",c.context="cell"):(c.context=t.cursorGrab,c.dragContext="row-reorder"),c):c.isGrid?(t.hasFocus=!1,c.dragContext="cell-grid",c.context="cell-grid",c):c.style==="tree-grid"?(t.hasFocus=!1,c.dragContext="tree",c.context="tree",c):(c.dragContext="cell",c.context="cell",c)}return t.hasFocus=!0,t.cursor="default",{dragContext:"background",context:"background",style:"background",isBackground:!0}}}},t.getSchemaFromData=function(r){return r=r||t.originalData,Object.keys(r[0]||{" ":""}).map(function(e,o){var n=t.getBestGuessDataType(e,r),i={name:e,title:isNaN(parseInt(e,10))?e:t.integerToAlpha(e).toUpperCase(),index:o,columnIndex:o,type:n,filter:t.filter(n)};return t.storedSettings&&t.storedSettings.visibility&&t.storedSettings.visibility[i.name]!==void 0&&(i.hidden=!t.storedSettings.visibility[i.name]),i})},t.clearChangeLog=function(){t.changes=[]},t.findColumnMaxTextLength=function(r){var e=-1/0;if(r==="cornerCell")return t.ctx.font=t.style.rowHeaderCellFont,t.ctx.measureText((t.viewData.length+(t.attributes.showNewRow?1:0)).toString()).width+t.style.autosizePadding+t.style.autosizeHeaderCellPadding+t.style.rowHeaderCellPaddingRight+t.style.rowHeaderCellPaddingLeft+(t.attributes.tree?t.style.treeArrowWidth+t.style.treeArrowMarginLeft+t.style.treeArrowMarginRight:0);var o=null;return t.getSchema().forEach(function(n){if(n.name===r){t.ctx.font=t.style.columnHeaderCellFont;var i=t.ctx.measureText(n.title||n.name).width+t.style.columnHeaderCellPaddingRight+t.style.columnHeaderCellPaddingLeft+t.style.cellAutoResizePadding;e=i>e?i:e,o=t.formatters[n.type]}}),t.viewData.forEach(function(n){var i=n[r];o&&(i=o({cell:{value:i}})),t.ctx.font=t.style.cellFont;var s=t.ctx.measureText(i).width+t.style.cellPaddingRight+t.style.cellPaddingLeft+t.style.cellAutoResizePadding;e=s>e?s:e}),e},t.getHeaderWidth=function(){return t.getVisibleSchema().reduce(function(r,e){return r+parseInt(e.width||t.style.cellWidth,10)},0)},t.getRowHeight=function(r){return(t.sizes.rows[r]||t.style.cellHeight)*t.scale},t.getColumnWidth=function(r){return(t.sizes.columns[r]||t.getSchema()[r].width||t.style.cellWidth)*t.scale},t.formatters.string=function(r){return r.cell.value!==void 0?r.cell.value:""},t.formatters.rowHeaderCell=t.formatters.string,t.formatters.headerCell=t.formatters.string,t.formatters.number=t.formatters.string,t.formatters.int=t.formatters.string,t.formatters.html=t.formatters.string,t.sorters.string=function(r,e){var o=e==="asc";return function(n,i){var s=n[r]||"",d=i[r]||"";return o?s.localeCompare?s.localeCompare(d):1:d.localeCompare?d.localeCompare(s):1}},t.sorters.number=function(r,e){var o=e==="asc";return function(n,i){return o?n[r]-i[r]:i[r]-n[r]}},t.sorters.date=function(r,e){var o=e==="asc";return function(n,i){return o?new Date(n[r]).getTime()-new Date(i[r]).getTime():new Date(i[r]).getTime()-new Date(n[r]).getTime()}}}var webComponent=component(),modules=[defaults,draw,events,touch,intf,selections,contextMenu,button,dom,publicMethods];function Grid(args){args=args||{};var self={};return self.isComponent=args.component===void 0,self.isChildGrid=args.parentNode&&/canvas-datagrid-(cell|tree)/.test(args.parentNode.nodeType),self.isChildGrid?self.intf={}:self.intf=self.isComponent?eval("Reflect.construct(HTMLElement, [], new.target)"):document.createElement("canvas"),self.args=args,self.intf.args=args,self.applyComponentStyle=webComponent.applyComponentStyle,self.hyphenateProperty=webComponent.hyphenateProperty,self.dehyphenateProperty=webComponent.dehyphenateProperty,self.createGrid=function(t){return t.component=!1,new Grid(t)},modules.forEach(function(t){t(self)}),self.isChildGrid?(self.shadowRoot=args.parentNode.shadowRoot,self.parentNode=args.parentNode):(self.shadowRoot=self.intf.attachShadow({mode:"open"}),self.parentNode=self.shadowRoot),self.init(),self.intf}function canvasDatagrid(t){t=t||{};var a,l=["style","formatters","sorters","filters","treeGridAttributes","cellGridAttributes","fillCellCallback","data","schema"];return window.customElements?(a=document.createElement("canvas-datagrid"),Object.keys(t).forEach(function(r){r!=="data"&&r!=="parentNode"&&(l.indexOf(r)===-1?a.attributes[r]=t[r]:l.forEach(function(e){t[e]!==void 0&&e===r&&(["formatters","sorters","filters"].indexOf(r)!==-1?_typeof(t[e])==="object"&&t[e]!==null&&Object.keys(t[e]).forEach(function(o){a[e][o]=t[e][o]}):a[e]=t[e])}))}),t.data&&(a.data=t.data),t.parentNode&&t.parentNode.appendChild(a),a):(t.component=!1,a=new Grid(t),t.parentNode&&t.parentNode.appendChild&&t.parentNode.appendChild(a),a)}window.HTMLElement&&(Grid.prototype=Object.create(window.HTMLElement.prototype)),window.customElements&&(Grid.observedAttributes=webComponent.getObservableAttributes(),Grid.prototype.disconnectedCallback=webComponent.disconnectedCallback,Grid.prototype.attributeChangedCallback=webComponent.attributeChangedCallback,Grid.prototype.connectedCallback=webComponent.connectedCallback,Grid.prototype.adoptedCallback=webComponent.adoptedCallback,window.customElements.define("canvas-datagrid",Grid));export{canvasDatagrid as default};
